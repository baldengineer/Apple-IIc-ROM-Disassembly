<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" href="SGStyle.css"/>

    <meta name="description" content="SourceGen-generated disassembly of Apple IIc bank2 of 03-342-0445 - A.bin"/>
    <title>Apple IIc bank2 of 03-342-0445 - A.bin Disassembly</title>
</head>

<body>

<p style="font-size:smaller;"><a href="./">(back to project page)</a></p>
<h1>Apple IIc bank2 of 03-342-0445 - A.bin Disassembly</h1>

<div id="code-lines">
    <!-- The CodeLines marker is not optional, and may only appear once -->
<pre>                   ********************************************************************************
                   * Apple IIc ROM3  - Bank 2                                                     *
                   * Re-created by James Lewis (@baldengineer)                                    *
                   * *****************************************************************            *
                   * ** Work In-Progress! ** Work In-Progress! ** Work In-Progress! **            *
                   * *****************************************************************            *
                   *                                                                              *
                   * For more information visit:                                                  *
                   * https://github.com/baldengineer/Apple-IIc-ROM-Disassembly                    *
                   *                                                                              *
                   * (Original attributions are in comments below, as shown in original ROM       *
                   * Listings.)                                                                   *
                   *                                                                              *
                   * Recreated work licensed as Attribution-NonCommercial-ShareAlike 4.0          *
                   * International.                                                               *
                   *                                                                              *
                   * Generated with 6502bench SourceGen v1.8.4                                    *
                   *                                                                              *
                   * *****                                                                        *
                   * pdf page 508 has the equates                                                 *
                   ********************************************************************************
                   <span id="Symucspace">ucspace</span>         EQU     $00    {const}    ;need an "upper case" space character
                   <span id="SymcharCR">charCR</span>          EQU     $0D    {const}
                   <span id="Symcmdcur">cmdcur</span>          EQU     191    {const}    ;'?' ;63_128 ;Cursor while in command mode
                   <span id="Symsermode">sermode</span>         EQU     $03B8  {const}    ;D7=1 if in command D6=1 if terminal
                   <span id="Symdevno2">devno2</span>          EQU     $C142  {const}
                   <span id="Symloc0">loc0</span>            EQU     $00               ;Boot parms
                   <span id="SymPowerReset">PowerReset</span>      EQU     $00
                   <span id="SymBadCmd">BadCmd</span>          EQU     $01
                   <span id="Symnoanswer">noanswer</span>        EQU     $01
                   <span id="Symnomark">nomark</span>          EQU     $02
                   <span id="SymWriteCmd">WriteCmd</span>        EQU     $02
                   <span id="SymFormatCmd">FormatCmd</span>       EQU     $03
                   <span id="SymBadPCnt">BadPCnt</span>         EQU     $04
                   <span id="SymControlCmd">ControlCmd</span>      EQU     $04
                   <span id="SymInitCmd">InitCmd</span>         EQU     $05
                   <span id="SymRC2">RC2</span>             EQU     $05               ;Data Packs get tried only 5 times
                   <span id="SymBusErr">BusErr</span>          EQU     $06
                   <span id="Symiwmmode">iwmmode</span>         EQU     $07               ;No timer, asynch, latch
                   <span id="Symcmdlength">cmdlength</span>       EQU     $09               ;Command packet length
                   <span id="Symbsyto2">bsyto2</span>          EQU     $0A               ;(.12 ms) T/O on /BSY after send
                   <span id="Symcsumerr">csumerr</span>         EQU     $10
                   <span id="SymBadUnit">BadUnit</span>         EQU     $11
                   <span id="SymZPSize">ZPSize</span>          EQU     $1C
                   <span id="Symstatmto">statmto</span>         EQU     $1E               ;30 bytes stat mark timeout
                   <span id="Symnopackend">nopackend</span>       EQU     $20
                   <span id="Symbadctl">badctl</span>          EQU     $21               ;bad control / status code
                   <span id="SymBadCtl">BadCtl</span>          EQU     $21
                   <span id="Symch">ch</span>              EQU     $24
                   <span id="SymIOError">IOError</span>         EQU     $27
                   <span id="SymNoDrive">NoDrive</span>         EQU     $28
                   <span id="SymWriteProt">WriteProt</span>       EQU     $2B
                   <span id="SymOffline">Offline</span>         EQU     $2F
                   <span id="Symbushog">bushog</span>          EQU     $40
                   <span id="Symchecksum">checksum</span>        EQU     $40
                   <span id="Symzeropage">zeropage</span>        EQU     $40
                   <span id="Symtopbits">topbits</span>         EQU     $41
                   <span id="SymCMDCode">CMDCode</span>         EQU     $42
                   <span id="SymCMDPcount">CMDPcount</span>       EQU     $43
                   <span id="SymCMDUnit">CMDUnit</span>         EQU     $43
                   <span id="SymCMDBuffer">CMDBuffer</span>       EQU     $44
                   <span id="SymCMDBufferl">CMDBufferl</span>      EQU     $44
                   <span id="SymCMDBufferh">CMDBufferh</span>      EQU     $45
                   <span id="SymCMDBlock">CMDBlock</span>        EQU     $46
                   <span id="SymCMDBlockl">CMDBlockl</span>       EQU     $46
                   <span id="SymCMDSCode">CMDSCode</span>        EQU     $46
                   <span id="SymCMDBlockh">CMDBlockh</span>       EQU     $47
                   <span id="SymCMDBlocks">CMDBlocks</span>       EQU     $48
                   <span id="SymCMDSpare1">CMDSpare1</span>       EQU     $49
                   <span id="SymCMDSpare2">CMDSpare2</span>       EQU     $4A
                   <span id="Symgrp7ctr">grp7ctr</span>         EQU     $4B
                   <span id="Symrcvbuf">rcvbuf</span>          EQU     $4B
                   <span id="Symoddbytes">oddbytes</span>        EQU     $4C
                   <span id="Symbytecount">bytecount</span>       EQU     $4D
                   <span id="Symbytecountl">bytecountl</span>      EQU     $4D
                   <span id="Symnext">next</span>            EQU     $4D
                   <span id="Symstatbyte">statbyte</span>        EQU     $4D
                   <span id="SymAuxType">AuxType</span>         EQU     $4E
                   <span id="Symbytecounth">bytecounth</span>      EQU     $4E
                   <span id="Symnext3">next3</span>           EQU     $4F
                   <span id="SymDeviceID">DeviceID</span>        EQU     $50
                   <span id="SymHostID">HostID</span>          EQU     $51
                   <span id="Symnext6">next6</span>           EQU     $52
                   <span id="Symnext7">next7</span>           EQU     $53
                   <span id="Symbuffer">buffer</span>          EQU     $54
                   <span id="Symauxptr">auxptr</span>          EQU     $56
                   <span id="Symbuffer2">buffer2</span>         EQU     $56
                   <span id="SymSlot">Slot</span>            EQU     $58
                   <span id="Symtbodd">tbodd</span>           EQU     $59
                   <span id="SymUnit">Unit</span>            EQU     $5A
                   <span id="SymWpacketType">WpacketType</span>     EQU     $5B
                   <span id="Symcmdmark">cmdmark</span>         EQU     $80               ;Command packet identifier
                   <span id="SymCommReset">CommReset</span>       EQU     $80
                   <span id="Symdatamark">datamark</span>        EQU     $82               ;Data packet identifier
                   <span id="Sympacketbeg">packetbeg</span>       EQU     $C3               ;Mark at beginning of packet
                   <span id="Sympacketend">packetend</span>       EQU     $C8               ;End of packet mark
                   <span id="SymPBCValue">PBCValue</span>        EQU     $FF               ;Powerup Byte Complement Value
                   <span id="Symastat">astat</span>           EQU     $0438             ;Acia status from int AF9 &amp; 4FA
                   <span id="SymProFLAG">ProFLAG</span>         EQU     $0473             ;scholes
                   <span id="Symnumbanks">numbanks</span>        EQU     $0478             ;-$C0  ;sl.scrn1 ;number of 64K banks on card
                   <span id="Sympwdth">pwdth</span>           EQU     $04B8             ;Printer width 579 &amp; 5FA
                   <span id="SymRetry">Retry</span>           EQU     $04F3             ;scholes+$80
                   <span id="Symerror">error</span>           EQU     $04F8             ;error flag
                   <span id="Symaciabuf">aciabuf</span>         EQU     $04FC             ;Owner of serial buffer
                   <span id="Symextint">extint</span>          EQU     $0538             ;extint &amp; typhed enable 5F9 &amp; 5FA
                   <span id="SymRetry2">Retry2</span>          EQU     $0573             ;SHTemp1
                   <span id="SymSHTemp1">SHTemp1</span>         EQU     $0573             ;scholes+$100
                   <span id="Symsl_scrn3">sl_scrn3</span>        EQU     $0578             ;-$C0
                   <span id="Symtwser">twser</span>           EQU     $057C             ;Storage pointer for serial buffer
                   <span id="SymSHTempX">SHTempX</span>         EQU     $05F3             ;scholes+$180
                   <span id="Symsl_scrn4">sl_scrn4</span>        EQU     $05F8             ;-$C0
                   <span id="Symextint2">extint2</span>         EQU     $05F9
                   <span id="Symtyphed">typhed</span>          EQU     $05FA
                   <span id="Symtwkey">twkey</span>           EQU     $05FC             ;Storage pointer for type ahead buffer
                   <span id="Symcharbuf">charbuf</span>         EQU     $05FE             ;5FE, 67E are one byte character buffers
                   <span id="Symeschar">eschar</span>          EQU     $0638             ;Current escape character 6F9 &amp; 6FA
                   <span id="SymSHTempY">SHTempY</span>         EQU     $0673             ;scholes+$200
                   <span id="Symsl_lcstate">sl_lcstate</span>      EQU     $0678             ;language card state
                   <span id="Symoldcur">oldcur</span>          EQU     $0679             ;Saves cursor while in command
                   <span id="Symoldcur2">oldcur2</span>         EQU     $067A             ;Saves cursor while in terminal mode
                   <span id="Symtrser">trser</span>           EQU     $067C             ;Retrieve pointer for serial buffer
                   <span id="Symflags">flags</span>           EQU     $06B8             ;D7 = Video echo D6 = CRLF 779 &amp; 77A
                   <span id="Symtemp">temp</span>            EQU     $06F8             ;Temp storage
                   <span id="SymNumDevices">NumDevices</span>      EQU     $06F9             ;Actually in slot 6
                   <span id="Symtrkey">trkey</span>           EQU     $06FF             ;Retrieve buffer for type ahead buffer
                   <span id="Symcol">col</span>             EQU     $0738             ;Current printer column 7F9 &amp; 7FA
                   <span id="SymSvBcH">SvBcH</span>           EQU     $0778
                   <span id="Symnumber">number</span>          EQU     $077E             ;Number accumulated in command
                   <span id="SymMSlot">MSlot</span>           EQU     $07F8
                   <span id="Symcursor">cursor</span>          EQU     $07FB
                   <span id="Symthbuf">thbuf</span>           EQU     $0800             ;Buffer in alt ram space
                   <span id="SymRC1">RC1</span>             EQU     $0BB8             ;Send a command pack 3000 times (3 sec)
                   <span id="Symdiagdest">diagdest</span>        EQU     $2000             ;location of diagnostics in ram
                   <span id="Symdosinit">dosinit</span>         EQU     $9D1E             ;DOS init vector use addr-1
                   <span id="Symrwts">rwts</span>            EQU     $BD00             ;RWTS entry point
                   <span id="Symproflag">proflag</span>         EQU     $BF00             ;0 = Pascal, $4C = ProDOS, other = DOS
                   <span id="Symsdata">sdata</span>           EQU     $BFF8             ;+$N0+$90 is output port
                   <span id="Symsstat">sstat</span>           EQU     $BFF9             ;ACIA status register
                   <span id="Symscomd">scomd</span>           EQU     $BFFA             ;ACIA command register
                   <span id="Symscntl">scntl</span>           EQU     $BFFB             ;ACIA control register
                   <span id="Symcmdcr">cmdcr</span>           EQU     $D12F             ;same as cmdn

                                   ORG     $C000
C000: 00 00 00 00+ <span id="SymLC000">LC000</span>           DS      25
C019: 00 00 00 00+ <span id="Symvblint">vblint</span>          DS      65
C05A: 00 00 00 00+ <span id="Symiou_p_2">iou_p_2</span>         DS      9
C063: 00 00 00 00+ <span id="Symmoubut">moubut</span>          DS      29
C080: 00           <span id="Symreqclr">reqclr</span>          DS      1
C081: 00           <span id="Symreqset">reqset</span>          DS      1
C082: 00           <span id="Symca1clr">ca1clr</span>          DS      1
C083: 00           <span id="Symcalset">calset</span>          DS      1
C084: 00           <span id="Symca2clr">ca2clr</span>          DS      1
C085: 00           <span id="Symca2set">ca2set</span>          DS      1
C086: 00           <span id="Symlstrbclr">lstrbclr</span>        DS      1
C087: 00           <span id="Symlstrbset">lstrbset</span>        DS      1
C088: 00           <span id="Symmonclr">monclr</span>          DS      1
C089: 00           <span id="Symmonset">monset</span>          DS      1
C08A: 00           <span id="Symenable1">enable1</span>         DS      1
C08B: 00           <span id="Symenable2">enable2</span>         DS      1
C08C: 00           <span id="Syml6clr">l6clr</span>           DS      1
C08D: 00           <span id="Syml6set">l6set</span>           DS      1
C08E: 00           <span id="Syml7clr">l7clr</span>           DS      1
C08F: 00 00 00 00+ <span id="Syml7set">l7set</span>           DS      113
                   ; Mouse &amp; acia interrupt handler
                   ; 
                   ; MOUSERINT - Montior's interrupt handler
                   ; 
                   ; Returns C = 0 if interrupt handled
                   ; If not mouse interrupt, goes to aciaint
                   ; New in this rom:
                   ; If D7 of moumode = 1, mouse X and Y interrupts are not processed
                   ; and are passed on to the user.
C100: A9 0E        <span id="Symmouseint">mouseint</span>        lda     #$0E              ;Entry point if X &amp; Y set up
C102: 1C 7F 07                     trb     $077F             ;Clear status bits
C105: 38                           sec                       ;Assume interrupt not handled
                   ; Check for vertical blanking interrupt
C106: AD 19 C0                     lda     <a href="#Symvblint">vblint</a>
C109: 10 2B                        bpl     <a href="#Symchkmou">chkmou</a>
C10B: 8D 79 C0                     sta     <a href="#Symmoubut">moubut</a>+22
C10E: A9 0C                        lda     #$0C
C110: 2C FF 07                     bit     <a href="#Symthbuf">thbuf</a>-1
C113: D0 03                        bne     <a href="#Symcvnovbl">cvnovbl</a>
C115: 8D 5A C0                     sta     <a href="#Symiou_p_2">iou_p_2</a>
C118: 09 02        <span id="Symcvnovbl">cvnovbl</span>         ora     #$02
C11A: 8D 78 C0                     sta     <a href="#Symmoubut">moubut</a>+21
C11D: 2C 7F 06                     bit     $067F
C120: D0 02                        bne     <a href="#Symcvmoved">cvmoved</a>
C122: A9 0C                        lda     #$0C
C124: 2C 63 C0     <span id="Symcvmoved">cvmoved</span>         bit     <a href="#Symmoubut">moubut</a>
C127: 10 02                        bpl     <a href="#Symcvbut">cvbut</a>
C129: 49 04                        eor     #$04
C12B: 2D FF 07     <span id="Symcvbut">cvbut</span>           and     <a href="#Symthbuf">thbuf</a>-1
C12E: 0C 7F 07                     tsb     $077F
C131: 1C 7F 06                     trb     $067F
C134: 69 FE                        adc     #$FE
C136: AD FF 07     <span id="Symchkmou">chkmou</span>          lda     <a href="#Symthbuf">thbuf</a>-1
C139: 30 72                        bmi     <a href="#Symxmdone">xmdone</a>
C13B: AD 15 C0                     lda     <a href="#SymLC000">LC000</a>+21
C13E: 0D 17 C0                     ora     <a href="#SymLC000">LC000</a>+23
C141: 10 6A        <span id="SymLC141">LC141</span>           bpl     <a href="#Symxmdone">xmdone</a>
C143: 8A                           txa
C144: A2 00                        ldx     #$00
C146: 2C 15 C0                     bit     <a href="#SymLC000">LC000</a>+21
C149: 30 0A                        bmi     <a href="#Symcmxmov">cmxmov</a>
C14B: 98           <span id="Symcmloop">cmloop</span>          tya
C14C: 49 80                        eor     #$80
C14E: A2 80                        ldx     #$80
C150: 2C 17 C0                     bit     <a href="#SymLC000">LC000</a>+23
C153: 10 39                        bpl     <a href="#Symcmnoy">cmnoy</a>
C155: 0A           <span id="Symcmxmov">cmxmov</span>          asl     A
C156: BD 7F 04                     lda     $047F,X
C159: B0 1A                        bcs     <a href="#Symcmrght">cmrght</a>
C15B: DD 7D 04                     cmp     $047D,X
C15E: D0 08                        bne     <a href="#Symcmlok">cmlok</a>
C160: BD 7F 05                     lda     $057F,X
C163: DD 7D 05                     cmp     $057D,X
C166: F0 22                        beq     <a href="#Symcmnoint">cmnoint</a>
C168: BD 7F 04     <span id="Symcmlok">cmlok</span>           lda     $047F,X
C16B: D0 03                        bne     <a href="#Symcmnt0">cmnt0</a>
C16D: DE 7F 05                     dec     $057F,X
C170: DE 7F 04     <span id="Symcmnt0">cmnt0</span>           dec     $047F,X
C173: 80 15                        bra     <a href="#Symcmnoint">cmnoint</a>

C175: DD 7D 06     <span id="Symcmrght">cmrght</span>          cmp     $067D,X
C178: D0 08                        bne     <a href="#Symcmrok">cmrok</a>
C17A: BD 7F 05                     lda     $057F,X
C17D: DD 7D 07                     cmp     <a href="#Symnumber">number</a>-1,X
C180: F0 08                        beq     <a href="#Symcmnoint">cmnoint</a>
C182: FE 7F 04     <span id="Symcmrok">cmrok</span>           inc     $047F,X
C185: D0 03                        bne     <a href="#Symcmnoint">cmnoint</a>
C187: FE 7F 05                     inc     $057F,X
C18A: E0 00        <span id="Symcmnoint">cmnoint</span>         cpx     #$00
C18C: F0 BD                        beq     <a href="#Symcmloop">cmloop</a>
C18E: 8D 48 C0     <span id="Symcmnoy">cmnoy</span>           sta     <a href="#Symvblint">vblint</a>+47
C191: A9 02                        lda     #$02
C193: 2D FF 07                     and     <a href="#Symthbuf">thbuf</a>-1
C196: F0 09                        beq     <a href="#Symcmnovbl">cmnovbl</a>
C198: 8D 79 C0                     sta     <a href="#Symmoubut">moubut</a>+22
C19B: 8D 5B C0                     sta     <a href="#Symiou_p_2">iou_p_2</a>+1
C19E: 8D 78 C0                     sta     <a href="#Symmoubut">moubut</a>+21
C1A1: 09 20        <span id="Symcmnovbl">cmnovbl</span>         ora     #$20
C1A3: 0C 7F 06                     tsb     $067F
C1A6: A9 0E                        lda     #$0E
C1A8: 2D 7F 07                     and     $077F
C1AB: 69 FE                        adc     #$FE
C1AD: B0 05        <span id="Symxmdone">xmdone</span>          bcs     <a href="#Symaciaint">aciaint</a>
C1AF: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

C1B2: 38           <span id="Symnotacia">notacia</span>         sec
C1B3: 60           <span id="Symacdone">acdone</span>          rts

C1B4: 20 BA C1     <span id="Symaciaint">aciaint</span>         jsr     <a href="#Symaciaint2">aciaint2</a>
C1B7: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

C1BA: A2 C2        <span id="Symaciaint2">aciaint2</span>        ldx     #$C2
C1BC: 20 C2 C1                     jsr     <a href="#Symaciatst">aciatst</a>
C1BF: 90 F2                        bcc     <a href="#Symacdone">acdone</a>
C1C1: CA                           dex
C1C2: BC 42 C1     <span id="Symaciatst">aciatst</span>         ldy     <a href="#SymLC141">LC141</a>+1,X
C1C5: A9 04                        lda     #$04
C1C7: 59 FA BF                     eor     <a href="#Symscomd">scomd</a>,Y
C1CA: 29 0C                        and     #$0C
C1CC: F0 E4                        beq     <a href="#Symnotacia">notacia</a>
C1CE: B9 F9 BF                     lda     <a href="#Symsstat">sstat</a>,Y
C1D1: 9D 38 04                     sta     <a href="#Symastat">astat</a>,X
C1D4: 10 DC                        bpl     <a href="#Symnotacia">notacia</a>
C1D6: E0 C2        <span id="Symaitst2">aitst2</span>          cpx     #$C2
C1D8: B0 02                        bcs     <a href="#Symaiport2">aiport2</a>
C1DA: 49 40                        eor     #$40
C1DC: 3C 38 05     <span id="Symaiport2">aiport2</span>         bit     <a href="#Symextint">extint</a>,X
C1DF: 70 29                        bvs     <a href="#Symaipass">aipass</a>
C1E1: 10 25                        bpl     <a href="#Symaieatit">aieatit</a>
C1E3: 90 23                        bcc     <a href="#Symaieatit">aieatit</a>
C1E5: 89 40                        bit     #$40
C1E7: F0 21                        beq     <a href="#Symaipass">aipass</a>
                   ; It's a keyboard interrupt
C1E9: AD 00 C0                     lda     <a href="#SymLC000">LC000</a>
C1EC: A0 80                        ldy     #$80
C1EE: 20 28 C2                     jsr     <a href="#Symputbuf">putbuf</a>
C1F1: C9 98                        cmp     #$98
C1F3: D0 0B                        bne     <a href="#Symainoflsh">ainoflsh</a>
C1F5: AD 62 C0                     lda     <a href="#Symmoubut">moubut</a>-1
C1F8: 10 06                        bpl     <a href="#Symainoflsh">ainoflsh</a>
C1FA: 8E FC 05                     stx     <a href="#Symtwkey">twkey</a>
C1FD: 8E FF 06                     stx     <a href="#Symtrkey">trkey</a>
C200: AD 10 C0     <span id="Symainoflsh">ainoflsh</span>        lda     <a href="#SymLC000">LC000</a>+16
C203: A0 B0                        ldy     #$B0
C205: B9 F9 BF                     lda     <a href="#Symsstat">sstat</a>,Y
C208: 29 BF        <span id="Symaieatit">aieatit</span>         and     #$BF
C20A: 0A           <span id="Symaipass">aipass</span>          asl     A
C20B: 0A                           asl     A
C20C: 29 20                        and     #$20
C20E: F0 3E                        beq     <a href="#Symaciadone">aciadone</a>
C210: B9 FA BF                     lda     <a href="#Symscomd">scomd</a>,Y
C213: 49 01                        eor     #$01
C215: 29 03                        and     #$03
C217: D0 35                        bne     <a href="#Symaciadone">aciadone</a>
C219: 8A                           txa
C21A: 4D FC 04                     eor     <a href="#Symaciabuf">aciabuf</a>
C21D: D0 93                        bne     <a href="#Symnotacia">notacia</a>
C21F: 08                           php
C220: 20 22 C3                     jsr     <a href="#Symgetdata">getdata</a>
C223: 90 28                        bcc     <a href="#Symaieat">aieat</a>
C225: A0 00                        ldy     #$00
C227: D0                           bne ▼   <a href="#SymLC230">LC230</a>+1
C228: 08           <span id="Symputbuf">putbuf</span>          php
C229: DA                           phx
C22A: 48                           pha
C22B: B9 7C 05                     lda     <a href="#Symtwser">twser</a>,Y
C22E: AA                           tax
C22F: 1A                           inc     A
C230: 89 7F        <span id="SymLC230">LC230</span>           bit     #$7F
C232: D0 01                        bne     <a href="#Sympbok">pbok</a>
C234: 98           <span id="SymLC234">LC234</span>           tya
C235: D9 7C 06     <span id="Sympbok">pbok</span>            cmp     <a href="#Symtrser">trser</a>,Y
C238: F0 03                        beq     <a href="#Sympbfull">pbfull</a>
C23A: 99 7C 05                     sta     <a href="#Symtwser">twser</a>,Y
C23D: 68           <span id="Sympbfull">pbfull</span>          pla
C23E: 2C 14 C0                     bit     <a href="#SymLC000">LC000</a>+20
C241: 8D 05 C0                     sta     <a href="#SymLC000">LC000</a>+5
C244: 9D 00 08                     sta     <a href="#Symthbuf">thbuf</a>,X
C247: 30 03                        bmi     <a href="#Symaiaux">aiaux</a>
C249: 8D 04 C0                     sta     <a href="#SymLC000">LC000</a>+4
C24C: FA           <span id="Symaiaux">aiaux</span>           plx
C24D: 28           <span id="Symaieat">aieat</span>           plp
C24E: 60           <span id="Symaciadone">aciadone</span>        rts

                   ********************************************************************************
                   * SEROUT3 - Outputs a character to a acia                                      *
                   * Inputs: A = char, X = Cn                                                     *
                   ********************************************************************************
C24F: 20 55 C2     <span id="Symserout3">serout3</span>         jsr     <a href="#Symserout4">serout4</a>
C252: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

C255: 48           <span id="Symserout4">serout4</span>         pha
C256: 2C AB C2                     bit     <a href="#Symsorts">sorts</a>
C259: F0 03                        beq     <a href="#Symsordy">sordy</a>
C25B: FE 38 07                     inc     <a href="#Symcol">col</a>,X
C25E: 20 B2 C2     <span id="Symsordy">sordy</span>           jsr     <a href="#Symgetstat2">getstat2</a>
C261: 29 30                        and     #$30
C263: C9 10                        cmp     #$10
C265: D0 F7                        bne     <a href="#Symsordy">sordy</a>
C267: BD B8 06                     lda     <a href="#Symflags">flags</a>,X
C26A: 89 20                        bit     #$20
C26C: F0 1F                        beq     <a href="#Symsook">sook</a>
C26E: EC FC 04                     cpx     <a href="#Symaciabuf">aciabuf</a>
C271: F0 13                        beq     <a href="#Symsotst">sotst</a>
C273: 20 E9 C2                     jsr     <a href="#Symxrdnobuf">xrdnobuf</a>
C276: 90 0E                        bcc     <a href="#Symsotst">sotst</a>
C278: BC 34 C2                     ldy     <a href="#SymLC234">LC234</a>,X
C27B: 99 FE 05                     sta     <a href="#Symcharbuf">charbuf</a>,Y
C27E: BD B8 06                     lda     <a href="#Symflags">flags</a>,X
C281: 09 04                        ora     #$04
C283: 9D B8 06                     sta     <a href="#Symflags">flags</a>,X
C286: BD B8 06     <span id="Symsotst">sotst</span>           lda     <a href="#Symflags">flags</a>,X
C289: 29 02                        and     #$02
C28B: D0 D1                        bne     <a href="#Symsordy">sordy</a>
C28D: BC 42 C1     <span id="Symsook">sook</span>            ldy     <a href="#SymLC141">LC141</a>+1,X
C290: 68                           pla
C291: 48                           pha
C292: 99 F8 BF                     sta     <a href="#Symsdata">sdata</a>,Y
C295: 3C B8 06                     bit     <a href="#Symflags">flags</a>,X
C298: 49 0D                        eor     #$0D
C29A: 0A                           asl     A
C29B: D0 0D                        bne     <a href="#Symsodone">sodone</a>
C29D: 50 06                        bvc     <a href="#Symclrcol">clrcol</a>
C29F: A9 14                        lda     #$14
C2A1: 6A                           ror     A
C2A2: 20 55 C2                     jsr     <a href="#Symserout4">serout4</a>
C2A5: 64 24        <span id="Symclrcol">clrcol</span>          stz     <a href="#Symch">ch</a>
C2A7: 9E 38 07                     stz     <a href="#Symcol">col</a>,X
C2AA: 68           <span id="Symsodone">sodone</span>          pla
C2AB: 60           <span id="Symsorts">sorts</span>           rts

                   ; GETSTAT - Gets the status from a acia
                   ; GETSTAT2 - Call from this side
                   ; If interrupt, aciatst is called
                   ; note: external interrupts are lost
                   ; inputs: X = Cn
                   ; outputs: A = status, X = Cn, Y = devno
C2AC: 20 B2 C2     <span id="Symgetstat">getstat</span>         jsr     <a href="#Symgetstat2">getstat2</a>
C2AF: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

C2B2: 08           <span id="Symgetstat2">getstat2</span>        php
C2B3: 78                           sei
C2B4: BC 42 C1     <span id="Symgsttst">gsttst</span>          ldy     <a href="#SymLC141">LC141</a>+1,X
C2B7: B9 F9 BF                     lda     <a href="#Symsstat">sstat</a>,Y
C2BA: 10 05                        bpl     <a href="#Symgstnoint">gstnoint</a>
C2BC: 20 D6 C1                     jsr     <a href="#Symaitst2">aitst2</a>
C2BF: 80 F3                        bra     <a href="#Symgsttst">gsttst</a>

C2C1: 28           <span id="Symgstnoint">gstnoint</span>        plp
C2C2: 60                           rts

                   ********************************************************************************
                   * This is the serial input routine. Carry                                      *
                   * flag set indicates that returned data is                                     *
                   * valid.                                                                       *
                   ********************************************************************************
C2C3: 20 C9 C2     <span id="Symxrdser">xrdser</span>          jsr     <a href="#Symxrdser2">xrdser2</a>
C2C6: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

C2C9: EC FC 04     <span id="Symxrdser2">xrdser2</span>         cpx     <a href="#Symaciabuf">aciabuf</a>
C2CC: D0 07                        bne     <a href="#Symxnosbuf">xnosbuf</a>
C2CE: A0 00                        ldy     #$00
C2D0: 20 FD C2                     jsr     <a href="#Symgetbuf2">getbuf2</a>
C2D3: B0 1F                        bcs     <a href="#Symxrddone">xrddone</a>
C2D5: BD B8 06     <span id="Symxnosbuf">xnosbuf</span>         lda     <a href="#Symflags">flags</a>,X
C2D8: 89 04                        bit     #$04
C2DA: F0 0D                        beq     <a href="#Symxrdnobuf">xrdnobuf</a>
C2DC: 29 FB                        and     #$FB
C2DE: 9D B8 06                     sta     <a href="#Symflags">flags</a>,X
C2E1: BC 34 C2                     ldy     <a href="#SymLC234">LC234</a>,X
C2E4: B9 FE 05                     lda     <a href="#Symcharbuf">charbuf</a>,Y
C2E7: 38                           sec
C2E8: 60                           rts

C2E9: 20 B2 C2     <span id="Symxrdnobuf">xrdnobuf</span>        jsr     <a href="#Symgetstat2">getstat2</a>
C2EC: 29 08                        and     #$08
C2EE: 18                           clc
C2EF: F0 03                        beq     <a href="#Symxrddone">xrddone</a>
C2F1: 20 22 C3                     jsr     <a href="#Symgetdata">getdata</a>           ;Get data and check xon, etc.
C2F4: 60           <span id="Symxrddone">xrddone</span>         rts

C2F5: 00                           DFB     $00
C2F6: 80                           DFB     $80

                   ********************************************************************************
                   *                                                                              *
                   * GETBUF - Gets a byte from the input buffer                                   *
                   * Inputs: Y=0 for Serial buffer 80 for Keyboard buffer                         *
                   * C = 0 if no data C = 1 if data valid A = Data                                *
                   *                                                                              *
                   ********************************************************************************
C2F7: 20 FD C2     <span id="Symgetbuf">getbuf</span>          jsr     <a href="#Symgetbuf2">getbuf2</a>
C2FA: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

C2FD: B9 7C 06     <span id="Symgetbuf2">getbuf2</span>         lda     <a href="#Symtrser">trser</a>,Y
C300: D9 7C 05                     cmp     <a href="#Symtwser">twser</a>,Y
C303: 18                           clc
C304: F0 1B                        beq     <a href="#Symgbdone">gbdone</a>
C306: 48                           pha
C307: 1A                           inc     A
C308: 89 7F                        bit     #$7F
C30A: D0 01                        bne     <a href="#Symgbnoovr">gbnoovr</a>
C30C: 98                           tya
C30D: 99 7C 06     <span id="Symgbnoovr">gbnoovr</span>         sta     <a href="#Symtrser">trser</a>,Y
C310: 7A                           ply
C311: AD 13 C0                     lda     <a href="#SymLC000">LC000</a>+19
C314: 0A                           asl     A
C315: 8D 03 C0                     sta     <a href="#SymLC000">LC000</a>+3
C318: B9 00 08                     lda     <a href="#Symthbuf">thbuf</a>,Y
C31B: B0 04                        bcs     <a href="#Symgbdone">gbdone</a>
C31D: 8D 02 C0                     sta     <a href="#SymLC000">LC000</a>+2
C320: 38                           sec
C321: 60           <span id="Symgbdone">gbdone</span>          rts

                   ********************************************************************************
                   *                                                                              *
                   * GETDATA - Gets data from serial port                                         *
                   * and checks for LF, XON, XOFF                                                 *
                   * inputs: Y = index to acia                                                    *
                   * outputs: A = data, Y dest, C = 1 if data ok = 0 if eaten                     *
                   *                                                                              *
                   ********************************************************************************
C322: B9 F8 BF     <span id="Symgetdata">getdata</span>         lda     <a href="#Symsdata">sdata</a>,Y
C325: 48                           pha
C326: 09 80                        ora     #$80
C328: A8                           tay
C329: BD B8 06                     lda     <a href="#Symflags">flags</a>,X
C32C: 89 08                        bit     #$08
C32E: D0 04                        bne     <a href="#Symgdnolf">gdnolf</a>
C330: C0 8A                        cpy     #$8A
C332: F0 12                        beq     <a href="#Symgdeat">gdeat</a>
C334: 89 20        <span id="Symgdnolf">gdnolf</span>          bit     #$20
C336: F0 10                        beq     <a href="#Symgdok">gdok</a>
C338: C0 91                        cpy     #$91
C33A: D0 04                        bne     <a href="#Symgdnxon">gdnxon</a>
C33C: 29 FD                        and     #$FD
C33E: 80 06                        bra     <a href="#Symgdeat">gdeat</a>

C340: C0 93        <span id="Symgdnxon">gdnxon</span>          cpy     #$93
C342: D0 04                        bne     <a href="#Symgdok">gdok</a>
C344: 09 02                        ora     #$02
C346: 18           <span id="Symgdeat">gdeat</span>           clc
C347: B0                           bcs ▼   <a href="#SymLC381">LC381</a>
C348: 38           <span id="Symgdok">gdok</span>            sec
C349: 9D B8 06                     sta     <a href="#Symflags">flags</a>,X
C34C: 68                           pla
C34D: 60                           rts

                   ********************************************************************************
                   * Name    : MOVEAUX                                                            *
                   * Function: Perform crossbank memory move                                      *
                   * Input   : A1 = Source Address                                                *
                   *         : A2 = Source End                                                    *
                   *         : A4 = Destination Start                                             *
                   *         : Carry SET = Main --&gt; Card                                          *
                   *                 CLR = Card --&gt; Main                                          *
                   *                                                                              *
                   * Output  : None                                                               *
                   * Volatile: Nothing                                                            *
                   * Calls   : Nothing                                                            *
                   ********************************************************************************
C34E: 48           <span id="Symmoveaux">moveaux</span>         pha
C34F: AD 13 C0                     lda     <a href="#SymLC000">LC000</a>+19
C352: 48                           pha
C353: AD 14 C0                     lda     <a href="#SymLC000">LC000</a>+20
C356: 48                           pha
                   ; 
                   ; Set Flags for Crossbank Move:
                   ; 
C357: 90 08                        bcc     <a href="#Symmovec2m">movec2m</a>
C359: 8D 02 C0                     sta     <a href="#SymLC000">LC000</a>+2
C35C: 8D 05 C0                     sta     <a href="#SymLC000">LC000</a>+5
C35F: B0 06                        bcs     <a href="#Symmoveloop">moveloop</a>

C361: 8D 04 C0     <span id="Symmovec2m">movec2m</span>         sta     <a href="#SymLC000">LC000</a>+4
C364: 8D 03 C0                     sta     <a href="#SymLC000">LC000</a>+3
                   ; MOVESTRT
C367: B2 3C        <span id="Symmoveloop">moveloop</span>        lda     ($3C)
C369: 92 42                        sta     (<a href="#SymCMDCode">CMDCode</a>)
C36B: E6 42                        inc     <a href="#SymCMDCode">CMDCode</a>
C36D: D0 02                        bne     <a href="#Symnexta1">nexta1</a>
C36F: E6 43                        inc     <a href="#SymCMDPcount">CMDPcount</a>
C371: A5 3C        <span id="Symnexta1">nexta1</span>          lda     $3C
C373: C5 3E                        cmp     $3E
C375: A5 3D                        lda     $3D
C377: E5 3F                        sbc     $3F
C379: E6 3C                        inc     $3C
C37B: D0 02                        bne     <a href="#Symco1">co1</a>
C37D: E6 3D                        inc     $3D
C37F: 90 E6        <span id="Symco1">co1</span>             bcc     <a href="#Symmoveloop">moveloop</a>
                   ; 
C381: 8D 04 C0     <span id="SymLC381">LC381</span>           sta     <a href="#SymLC000">LC000</a>+4
C384: 68                           pla
C385: 10 03                        bpl     <a href="#Symco3">co3</a>
C387: 8D 05 C0                     sta     <a href="#SymLC000">LC000</a>+5
C38A: 8D 02 C0     <span id="Symco3">co3</span>             sta     <a href="#SymLC000">LC000</a>+2
C38D: 68                           pla
C38E: 10 03                        bpl     <a href="#Symmoveret">moveret</a>
C390: 8D 03 C0                     sta     <a href="#SymLC000">LC000</a>+3
C393: 68           <span id="Symmoveret">moveret</span>         pla
C394: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

C397: 48                           DFB     $48
C398: AD                           DFB     $AD
C399: ED                           DFB     $ED
C39A: 03                           DFB     $03
C39B: 48                           DFB     $48
C39C: AD                           DFB     $AD
C39D: EE                           DFB     $EE
C39E: 03                           DFB     $03
C39F: 48                           DFB     $48
C3A0: 90                           DFB     $90
C3A1: 08                           DFB     $08
C3A2: 8D                           DFB     $8D
C3A3: 03                           DFB     $03
C3A4: C0                           DFB     $C0
C3A5: 8D                           DFB     $8D
C3A6: 05                           DFB     $05
C3A7: C0                           DFB     $C0
C3A8: B0                           DFB     $B0
C3A9: 06                           DFB     $06
C3AA: 8D                           DFB     $8D
C3AB: 02                           DFB     $02
C3AC: C0                           DFB     $C0
C3AD: 8D                           DFB     $8D
C3AE: 04                           DFB     $04
C3AF: C0                           DFB     $C0
C3B0: 68                           DFB     $68
C3B1: 8D                           DFB     $8D
C3B2: EE                           DFB     $EE
C3B3: 03                           DFB     $03
C3B4: 68                           DFB     $68
C3B5: 8D                           DFB     $8D
C3B6: ED                           DFB     $ED
C3B7: 03                           DFB     $03
C3B8: 68                           DFB     $68
C3B9: 70                           DFB     $70
C3BA: 05                           DFB     $05
C3BB: 8D                           DFB     $8D
C3BC: 08                           DFB     $08
C3BD: C0                           DFB     $C0
C3BE: 50                           DFB     $50
C3BF: 03                           DFB     $03
C3C0: 8D                           DFB     $8D
C3C1: 09                           DFB     $09
C3C2: C0                           DFB     $C0
C3C3: 4C                           DFB     $4C
C3C4: EB                           DFB     $EB
C3C5: C7                           DFB     $C7

                   ********************************************************************************
                   * banger                                                                       *
                   *                                                                              *
                   * Here is the rest of the diagnostic stuff                                     *
                   * the first part has been moved into the $D000 space                           *
                   * to make desperately needed room                                              *
                   *                                                                              *
                   ********************************************************************************
C3C6: 86 01        <span id="SymTSTMEM">TSTMEM</span>          stx     <a href="#SymBadCmd">BadCmd</a>
C3C8: 86 02                        stx     <a href="#Symnomark">nomark</a>
C3CA: 86 03                        stx     <a href="#SymFormatCmd">FormatCmd</a>
C3CC: A2 04                        ldx     #$04
C3CE: 86 04                        stx     <a href="#SymBadPCnt">BadPCnt</a>
C3D0: 85 05        <span id="SymMEM1">MEM1</span>            sta     <a href="#SymInitCmd">InitCmd</a>
C3D2: A2 04                        ldx     #$04
C3D4: 64 01                        stz     <a href="#SymBadCmd">BadCmd</a>
C3D6: E6 01                        inc     <a href="#SymBadCmd">BadCmd</a>
C3D8: A8           <span id="Symmem2">mem2</span>            tay
C3D9: 8D 83 C0                     sta     <a href="#Symcalset">calset</a>
C3DC: 8D 83 C0                     sta     <a href="#Symcalset">calset</a>
C3DF: A5 01                        lda     <a href="#SymBadCmd">BadCmd</a>
C3E1: 29 F0                        and     #$F0
C3E3: C9 C0                        cmp     #$C0
C3E5: D0 0C                        bne     <a href="#Symmem3">mem3</a>
C3E7: AD 8B C0                     lda     <a href="#Symenable2">enable2</a>
C3EA: AD 8B C0                     lda     <a href="#Symenable2">enable2</a>
C3ED: A5 01                        lda     <a href="#SymBadCmd">BadCmd</a>
C3EF: 69 0F                        adc     #$0F
C3F1: D0 02                        bne     <a href="#Symmem4">mem4</a>
C3F3: A5 01        <span id="Symmem3">mem3</span>            lda     <a href="#SymBadCmd">BadCmd</a>
C3F5: 85 03        <span id="Symmem4">mem4</span>            sta     <a href="#SymFormatCmd">FormatCmd</a>
C3F7: 98                           tya
C3F8: A0 00                        ldy     #$00
C3FA: 18           <span id="Symmem5">mem5</span>            clc
C3FB: 7D 2A C8                     adc     <a href="#Symglcdone">glcdone</a>+1,X
C3FE: 91 02                        sta     (<a href="#Symnomark">nomark</a>),Y
C400: CA                           dex
C401: 10 02                        bpl     <a href="#SymLC405">LC405</a>
C403: A2 04                        ldx     #$04
C405: C8           <span id="SymLC405">LC405</span>           iny
C406: D0 F2                        bne     <a href="#Symmem5">mem5</a>
C408: E6 01                        inc     <a href="#SymBadCmd">BadCmd</a>
C40A: D0 CC                        bne     <a href="#Symmem2">mem2</a>
C40C: E6 01                        inc     <a href="#SymBadCmd">BadCmd</a>
C40E: A2 04                        ldx     #$04
C410: A5 05                        lda     <a href="#SymInitCmd">InitCmd</a>
C412: A8           <span id="SymLC412">LC412</span>           tay
C413: AD 83 C0                     lda     <a href="#Symcalset">calset</a>
C416: AD 83 C0                     lda     <a href="#Symcalset">calset</a>
C419: A5 01                        lda     <a href="#SymBadCmd">BadCmd</a>
C41B: 29 F0                        and     #$F0
C41D: C9 C0                        cmp     #$C0
C41F: D0 09                        bne     <a href="#SymLC42A">LC42A</a>
C421: AD 8B C0                     lda     <a href="#Symenable2">enable2</a>
C424: A5 01                        lda     <a href="#SymBadCmd">BadCmd</a>
C426: 69 0F                        adc     #$0F
C428: D0 02                        bne     <a href="#SymLC42C">LC42C</a>
C42A: A5 01        <span id="SymLC42A">LC42A</span>           lda     <a href="#SymBadCmd">BadCmd</a>
C42C: 85 03        <span id="SymLC42C">LC42C</span>           sta     <a href="#SymFormatCmd">FormatCmd</a>
C42E: 98                           tya
C42F: A0 00                        ldy     #$00
C431: 18           <span id="SymLC431">LC431</span>           clc
C432: 7D 2A C8                     adc     <a href="#Symglcdone">glcdone</a>+1,X
C435: 51 02                        eor     (<a href="#Symnomark">nomark</a>),Y
C437: D0 39                        bne     <a href="#SymLC472">LC472</a>
C439: B1 02                        lda     (<a href="#Symnomark">nomark</a>),Y
C43B: CA                           dex
C43C: 10 02                        bpl     <a href="#SymLC440">LC440</a>
C43E: A2 04                        ldx     #$04
C440: C8           <span id="SymLC440">LC440</span>           iny
C441: D0 EE                        bne     <a href="#SymLC431">LC431</a>
C443: E6 01                        inc     <a href="#SymBadCmd">BadCmd</a>
C445: D0 CB                        bne     <a href="#SymLC412">LC412</a>
C447: 6A                           ror     A
C448: 2C 19 C0                     bit     <a href="#Symvblint">vblint</a>
C44B: 10 02                        bpl     <a href="#SymLC44F">LC44F</a>
C44D: 49 A5                        eor     #$A5
C44F: C6 04        <span id="SymLC44F">LC44F</span>           dec     <a href="#SymBadPCnt">BadPCnt</a>
C451: 30 03                        bmi     <a href="#SymLC456">LC456</a>
C453: 4C D0 C3                     jmp     <a href="#SymMEM1">MEM1</a>

C456: AA           <span id="SymLC456">LC456</span>           tax
C457: 2C 13 C0                     bit     <a href="#SymLC000">LC000</a>+19
C45A: 30 10                        bmi     <a href="#SymLC46C">LC46C</a>
C45C: 8A                           txa
C45D: 8D 05 C0                     sta     <a href="#SymLC000">LC000</a>+5
C460: 8D 03 C0                     sta     <a href="#SymLC000">LC000</a>+3
C463: 8D 09 C0                     sta     <a href="#SymLC000">LC000</a>+9
C466: 8D 81 C0                     sta     <a href="#Symreqset">reqset</a>
C469: 4C 97 D4                     jmp     <a href="#SymLD497">LD497</a>

C46C: 8D 08 C0     <span id="SymLC46C">LC46C</span>           sta     <a href="#SymLC000">LC000</a>+8
C46F: 4C EF C4                     jmp     <a href="#SymSWCHTST">SWCHTST</a>

C472: 38           <span id="SymLC472">LC472</span>           sec
C473: AA           <span id="SymLC473">LC473</span>           tax
C474: AD 13 C0                     lda     <a href="#SymLC000">LC000</a>+19
C477: B8                           clv
C478: 10 03                        bpl     <a href="#SymLC47D">LC47D</a>
C47A: 2C 2A C8                     bit     <a href="#Symglcdone">glcdone</a>+1
C47D: A9 A0        <span id="SymLC47D">LC47D</span>           lda     #$A0
C47F: A0 06                        ldy     #$06
C481: 99 FE BF     <span id="SymLC481">LC481</span>           sta     $BFFE,Y
C484: 99 06 C0                     sta     <a href="#SymLC000">LC000</a>+6,Y
C487: 88                           dey
C488: 88                           dey
C489: D0 F6                        bne     <a href="#SymLC481">LC481</a>
C48B: 8D 51 C0                     sta     <a href="#Symvblint">vblint</a>+56
C48E: 8D 54 C0                     sta     <a href="#Symvblint">vblint</a>+59
C491: 99 00 04     <span id="SymLC491">LC491</span>           sta     $0400,Y
C494: 99 00 05                     sta     $0500,Y
C497: 99 00 06                     sta     $0600,Y
C49A: 99 00 07                     sta     $0700,Y
C49D: C8                           iny
C49E: D0 F1                        bne     <a href="#SymLC491">LC491</a>
C4A0: 8A                           txa
C4A1: F0 27                        beq     <a href="#SymLC4CA">LC4CA</a>
C4A3: A0 03                        ldy     #$03
C4A5: B0 02                        bcs     <a href="#SymLC4A9">LC4A9</a>
C4A7: A0 05                        ldy     #$05
C4A9: A9 AA        <span id="SymLC4A9">LC4A9</span>           lda     #$AA
C4AB: 50 03                        bvc     <a href="#SymLC4B0">LC4B0</a>
C4AD: 8D B0 05                     sta     $05B0
C4B0: B9 66 C8     <span id="SymLC4B0">LC4B0</span>           lda     <a href="#SymLC866">LC866</a>,Y
C4B3: 99 B1 05                     sta     $05B1,Y
C4B6: 88                           dey
C4B7: 10 F7                        bpl     <a href="#SymLC4B0">LC4B0</a>
C4B9: A0 10                        ldy     #$10
C4BB: 8A           <span id="SymLC4BB">LC4BB</span>           txa
C4BC: 4A                           lsr     A
C4BD: AA                           tax
C4BE: A9 58                        lda     #$58
C4C0: 2A                           rol     A
C4C1: 99 B6 05                     sta     $05B6,Y
C4C4: 88                           dey
C4C5: 88                           dey
C4C6: D0 F3                        bne     <a href="#SymLC4BB">LC4BB</a>
C4C8: F0 FE        <span id="SymLC4C8">LC4C8</span>           beq     <a href="#SymLC4C8">LC4C8</a>

C4CA: A2 02        <span id="SymLC4CA">LC4CA</span>           ldx     #$02
C4CC: 7A                           ply
C4CD: 08                           php
C4CE: BD 6C C8     <span id="SymLC4CE">LC4CE</span>           lda     <a href="#SymLC86C">LC86C</a>,X
C4D1: 28                           plp
C4D2: 08                           php
C4D3: 90 03                        bcc     <a href="#SymLC4D8">LC4D8</a>
C4D5: BD 6F C8                     lda     <a href="#SymLC86F">LC86F</a>,X
C4D8: C0 06        <span id="SymLC4D8">LC4D8</span>           cpy     #$06
C4DA: 90 0B                        bcc     <a href="#SymLC4E7">LC4E7</a>
C4DC: C0 08                        cpy     #$08
C4DE: 90 04                        bcc     <a href="#SymLC4E4">LC4E4</a>
C4E0: C0 11                        cpy     #$11
C4E2: 90 03                        bcc     <a href="#SymLC4E7">LC4E7</a>
C4E4: BD 72 C8     <span id="SymLC4E4">LC4E4</span>           lda     <a href="#SymLC872">LC872</a>,X
C4E7: 9D B8 05     <span id="SymLC4E7">LC4E7</span>           sta     $05B8,X
C4EA: CA                           dex
C4EB: 10 E1                        bpl     <a href="#SymLC4CE">LC4CE</a>
C4ED: 30 FE        <span id="Symhangy">hangy</span>           bmi     <a href="#Symhangy">hangy</a>             ;branch forever

                   NOTE: pdf pg 480 (diags listing)
C4EF: A0 01        <span id="SymSWCHTST">SWCHTST</span>         ldy     #$01              ;MMUIDX
C4F1: A9 7F        <span id="Symswtst1">swtst1</span>          lda     #$7F
C4F3: 6A           <span id="Symswtst2">swtst2</span>          ror     A
C4F4: BE 2F C8                     ldx     <a href="#SymSWTBL0">SWTBL0</a>,Y
C4F7: F0 0F                        beq     <a href="#Symswtst4">swtst4</a>
C4F9: 90 03                        bcc     <a href="#Symswtst3">swtst3</a>
C4FB: BE 41 C8                     ldx     <a href="#SymSWTBL1">SWTBL1</a>,Y
C4FE: 9D FF BF     <span id="Symswtst3">swtst3</span>          sta     <a href="#SymLC000">LC000</a>-1,X
C501: C8                           iny
C502: D0 EF                        bne     <a href="#Symswtst2">swtst2</a>
                   ; 
C504: AE 30 C0     <span id="Symclick">click</span>           ldx     <a href="#Symvblint">vblint</a>+23
C507: 2A                           rol     A
C508: 88           <span id="Symswtst4">swtst4</span>          dey
C509: BE 53 C8                     ldx     <a href="#SymRSWTBL">RSWTBL</a>,Y
C50C: F0 13                        beq     <a href="#Symswtst6">swtst6</a>
C50E: 30 F4                        bmi     <a href="#Symclick">click</a>
C510: 2A                           rol     A
C511: 90 07                        bcc     <a href="#SymLC51A">LC51A</a>
C513: 1E 00 C0                     asl     <a href="#SymLC000">LC000</a>,X
C516: 90 1F                        bcc     <a href="#Symswerr">swerr</a>
C518: B0 EE                        bcs     <a href="#Symswtst4">swtst4</a>

C51A: 1E 00 C0     <span id="SymLC51A">LC51A</span>           asl     <a href="#SymLC000">LC000</a>,X
C51D: B0 18                        bcs     <a href="#Symswerr">swerr</a>
C51F: 90 E7                        bcc     <a href="#Symswtst4">swtst4</a>

C521: 2A           <span id="Symswtst6">swtst6</span>          rol     A
C522: C8                           iny
                   <span style="background-color: #89acb7">NOTE: jumps from c880 if not a boot</span>
                   <span style="background-color: #89acb7">THIS IS NOT THE BOOTCODE WE ARE LOOKING FOR!</span>
C523: 38           <span id="SymLC523">LC523</span>           sec
C524: E9 01                        sbc     #$01
C526: B0 CB                        bcs     <a href="#Symswtst2">swtst2</a>
C528: 88                           dey
C529: F0 08                        beq     <a href="#Symswtst7">swtst7</a>
C52B: C0 08                        cpy     #$08
C52D: D0 10                        bne     <a href="#SymBIGLOOP">BIGLOOP</a>
C52F: A0 11                        ldy     #$11
C531: D0 BE                        bne     <a href="#Symswtst1">swtst1</a>

C533: A0 09        <span id="Symswtst7">swtst7</span>          ldy     #$09
C535: D0 BA                        bne     <a href="#Symswtst1">swtst1</a>

C537: 5A           <span id="Symswerr">swerr</span>           phy
C538: A2 00                        ldx     #$00
C53A: C0 0A                        cpy     #$0A
C53C: 4C 7D C4                     jmp     <a href="#SymLC47D">LC47D</a>

C53F: 46 80        <span id="SymBIGLOOP">BIGLOOP</span>         lsr     <a href="#Symcmdmark">cmdmark</a>
C541: D0 AC                        bne     <a href="#SymSWCHTST">SWCHTST</a>
C543: A9 A0                        lda     #$A0
C545: A0 00                        ldy     #$00
C547: 99 00 04     <span id="SymLC547">LC547</span>           sta     $0400,Y
C54A: 99 00 05                     sta     $0500,Y
C54D: 99 00 06                     sta     $0600,Y
C550: 99 00 07                     sta     $0700,Y
C553: C8                           iny
C554: D0 F1                        bne     <a href="#SymLC547">LC547</a>
C556: AD 61 C0     <span id="SymLC556">LC556</span>           lda     <a href="#Symiou_p_2">iou_p_2</a>+7
C559: 2D 62 C0                     and     <a href="#Symmoubut">moubut</a>-1
C55C: 0A                           asl     A
C55D: E6 FF                        inc     <a href="#SymPBCValue">PBCValue</a>
C55F: A5 FF                        lda     <a href="#SymPBCValue">PBCValue</a>
C561: 90 03                        bcc     <a href="#SymLC566">LC566</a>
C563: 4C 8E D4                     jmp     <a href="#Symdiags">diags</a>

C566: AD 51 C0     <span id="SymLC566">LC566</span>           lda     <a href="#Symvblint">vblint</a>+56
C569: A0 08                        ldy     #$08
C56B: B9 75 C8     <span id="SymLC56B">LC56B</span>           lda     <a href="#SymLC875">LC875</a>,Y
C56E: 99 B8 05                     sta     $05B8,Y
C571: 88                           dey
C572: 10 F7                        bpl     <a href="#SymLC56B">LC56B</a>
C574: 30 E0                        bmi     <a href="#SymLC556">LC556</a>

C576: 00 00 00 00+                 DS      10,$00

C580: DA           <span id="SymLC580">LC580</span>           phx
C581: AE 78 06                     ldx     <a href="#Symsl_lcstate">sl_lcstate</a>
C584: FE 00 C0                     inc     <a href="#SymLC000">LC000</a>,X
C587: FA                           plx
C588: A5 49                        lda     <a href="#SymCMDSpare1">CMDSpare1</a>
C58A: 9D F8 BF                     sta     <a href="#Symsdata">sdata</a>,X
C58D: A5 4A                        lda     <a href="#SymCMDSpare2">CMDSpare2</a>
C58F: 9D F9 BF                     sta     <a href="#Symsstat">sstat</a>,X
C592: A5 4B                        lda     <a href="#Symgrp7ctr">grp7ctr</a>
C594: 29 7F                        and     #$7F
C596: D9 B8 03                     cmp     $03B8,Y
C599: B0 53                        bcs     <a href="#SymLC5EE">LC5EE</a>
C59B: 9D FA BF                     sta     <a href="#Symscomd">scomd</a>,X
C59E: 2C 14 C0                     bit     <a href="#SymLC000">LC000</a>+20
C5A1: 08                           php
C5A2: 8D 04 C0                     sta     <a href="#SymLC000">LC000</a>+4
C5A5: 24 4B                        bit     <a href="#Symgrp7ctr">grp7ctr</a>
C5A7: 10 03                        bpl     <a href="#SymLC5AC">LC5AC</a>
C5A9: 8D 05 C0                     sta     <a href="#SymLC000">LC000</a>+5
C5AC: A0 00        <span id="SymLC5AC">LC5AC</span>           ldy     #$00
C5AE: A5 48                        lda     <a href="#SymCMDBlocks">CMDBlocks</a>
C5B0: 8D F8 05                     sta     <a href="#Symsl_scrn4">sl_scrn4</a>
C5B3: F0 14                        beq     <a href="#SymLC5C9">LC5C9</a>
C5B5: BD FB BF     <span id="SymLC5B5">LC5B5</span>           lda     <a href="#Symscntl">scntl</a>,X
C5B8: 91 45                        sta     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
C5BA: C8                           iny
C5BB: BD FB BF                     lda     <a href="#Symscntl">scntl</a>,X
C5BE: 91 45                        sta     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
C5C0: C8                           iny
C5C1: D0 F2                        bne     <a href="#SymLC5B5">LC5B5</a>
C5C3: E6 46                        inc     <a href="#SymCMDBlock">CMDBlock</a>
C5C5: C6 48                        dec     <a href="#SymCMDBlocks">CMDBlocks</a>
C5C7: D0 EC                        bne     <a href="#SymLC5B5">LC5B5</a>
C5C9: A5 47        <span id="SymLC5C9">LC5C9</span>           lda     <a href="#SymCMDBlockh">CMDBlockh</a>
C5CB: F0 16                        beq     <a href="#SymLC5E3">LC5E3</a>
C5CD: 8D 78 05                     sta     <a href="#Symsl_scrn3">sl_scrn3</a>
C5D0: 4A                           lsr     A
C5D1: B0 06                        bcs     <a href="#SymLC5D9">LC5D9</a>
C5D3: BD FB BF     <span id="SymLC5D3">LC5D3</span>           lda     <a href="#Symscntl">scntl</a>,X
C5D6: 91 45                        sta     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
C5D8: C8                           iny
C5D9: BD FB BF     <span id="SymLC5D9">LC5D9</span>           lda     <a href="#Symscntl">scntl</a>,X
C5DC: 91 45                        sta     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
C5DE: C8                           iny
C5DF: C4 47                        cpy     <a href="#SymCMDBlockh">CMDBlockh</a>
C5E1: D0 F0                        bne     <a href="#SymLC5D3">LC5D3</a>
C5E3: 8D 04 C0     <span id="SymLC5E3">LC5E3</span>           sta     <a href="#SymLC000">LC000</a>+4
C5E6: 28                           plp
C5E7: 10 03                        bpl     <a href="#SymLC5EC">LC5EC</a>
C5E9: 8D 05 C0                     sta     <a href="#SymLC000">LC000</a>+5
C5EC: 80 05        <span id="SymLC5EC">LC5EC</span>           bra     <a href="#SymLC5F3">LC5F3</a>

C5EE: A9 2D        <span id="SymLC5EE">LC5EE</span>           lda     #$2D
C5F0: 8D F8 04                     sta     <a href="#Symerror">error</a>
C5F3: 8D 81 C0     <span id="SymLC5F3">LC5F3</span>           sta     <a href="#Symreqset">reqset</a>
C5F6: 60                           rts

C5F7: DA           <span id="SymLC5F7">LC5F7</span>           phx
C5F8: AE 78 06                     ldx     <a href="#Symsl_lcstate">sl_lcstate</a>
C5FB: FE 00 C0                     inc     <a href="#SymLC000">LC000</a>,X
C5FE: FA                           plx
C5FF: A5 49                        lda     <a href="#SymCMDSpare1">CMDSpare1</a>
C601: 9D F8 BF                     sta     <a href="#Symsdata">sdata</a>,X
C604: A5 4A                        lda     <a href="#SymCMDSpare2">CMDSpare2</a>
C606: 9D F9 BF                     sta     <a href="#Symsstat">sstat</a>,X
C609: A5 4B                        lda     <a href="#Symgrp7ctr">grp7ctr</a>
C60B: 29 7F                        and     #$7F
C60D: D9 B8 03                     cmp     $03B8,Y
C610: B0 DC                        bcs     <a href="#SymLC5EE">LC5EE</a>
C612: 9D FA BF                     sta     <a href="#Symscomd">scomd</a>,X
C615: 2C 13 C0                     bit     <a href="#SymLC000">LC000</a>+19
C618: 08                           php
C619: 8D 02 C0                     sta     <a href="#SymLC000">LC000</a>+2
C61C: 24 4B                        bit     <a href="#Symgrp7ctr">grp7ctr</a>
C61E: 10 03                        bpl     <a href="#SymLC623">LC623</a>
C620: 8D 03 C0                     sta     <a href="#SymLC000">LC000</a>+3
C623: A0 00        <span id="SymLC623">LC623</span>           ldy     #$00
C625: A5 48                        lda     <a href="#SymCMDBlocks">CMDBlocks</a>
C627: 8D F8 05                     sta     <a href="#Symsl_scrn4">sl_scrn4</a>
C62A: F0 14                        beq     <a href="#SymLC640">LC640</a>
C62C: B1 45        <span id="SymLC62C">LC62C</span>           lda     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
C62E: 9D FB BF                     sta     <a href="#Symscntl">scntl</a>,X
C631: C8                           iny
C632: B1 45                        lda     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
C634: 9D FB BF                     sta     <a href="#Symscntl">scntl</a>,X
C637: C8                           iny
C638: D0 F2                        bne     <a href="#SymLC62C">LC62C</a>
C63A: E6 46                        inc     <a href="#SymCMDBlock">CMDBlock</a>
C63C: C6 48                        dec     <a href="#SymCMDBlocks">CMDBlocks</a>
C63E: D0 EC                        bne     <a href="#SymLC62C">LC62C</a>
C640: A5 47        <span id="SymLC640">LC640</span>           lda     <a href="#SymCMDBlockh">CMDBlockh</a>
C642: 8D 78 05                     sta     <a href="#Symsl_scrn3">sl_scrn3</a>
C645: F0 13                        beq     <a href="#SymLC65A">LC65A</a>
C647: 4A                           lsr     A
C648: B0 06                        bcs     <a href="#SymLC650">LC650</a>
C64A: B1 45        <span id="SymLC64A">LC64A</span>           lda     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
C64C: 9D FB BF                     sta     <a href="#Symscntl">scntl</a>,X
C64F: C8                           iny
C650: B1 45        <span id="SymLC650">LC650</span>           lda     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
C652: 9D FB BF                     sta     <a href="#Symscntl">scntl</a>,X
C655: C8                           iny
C656: C4 47                        cpy     <a href="#SymCMDBlockh">CMDBlockh</a>
C658: D0 F0                        bne     <a href="#SymLC64A">LC64A</a>
C65A: 8D 02 C0     <span id="SymLC65A">LC65A</span>           sta     <a href="#SymLC000">LC000</a>+2
C65D: 28                           plp
C65E: 10 03                        bpl     <a href="#SymLC663">LC663</a>
C660: 8D 03 C0                     sta     <a href="#SymLC000">LC000</a>+3
C663: 8D 81 C0     <span id="SymLC663">LC663</span>           sta     <a href="#Symreqset">reqset</a>
C666: 60                           rts

C667: F8           <span id="SymLC667">LC667</span>           DFB     $F8
C668: 00                           DFB     $00
C669: 00                           DFB     $00
C66A: 00                           DFB     $00
C66B: 07 52 41 4D+                 ASC     $07,‘RAMCARD         ’
C67C: 00                           DFB     $00
C67D: 00                           DFB     $00
C67E: 01                           DFB     $01
C67F: 01                           DFB     $01
C680: 03 03 03 03+ <span id="SymLC680">LC680</span>           DS      6,$03
C686: 01                           DFB     $01
C687: 01                           DFB     $01
C688: 03                           DFB     $03
C689: 03                           DFB     $03
C68A: 01 01 01 01+                 DS      6,$01
C690: 04                           DFB     $04
C691: 04                           DFB     $04
C692: 04                           DFB     $04
C693: 04                           DFB     $04
C694: FF FF FF FF+                 DS      6,$FF
C69A: 52           <span id="SymLC69A">LC69A</span>           DFB     $52
C69B: 73                           DFB     $73
C69C: 2F                           DFB     $2F
C69D: B8                           DFB     $B8
C69E: 2F                           DFB     $2F
C69F: BC                           DFB     $BC
C6A0: 2F 38 69 69+                 ASC     ‘/8ii88/////9/&lt;E’
C6AF: 9D                           DFB     $9D
C6B0: A1                           DFB     $A1
C6B1: 38                           DFB     $38
C6B2: 3F                           DFB     $3F
C6B3: 42                           DFB     $42

                   ********************************************************************************
                   *                                                                              *
                   * Start of //c diagnostics                                                     *
                   *                                                                              *
                   ********************************************************************************
C6B4: DA                           phx
C6B5: 20 16 C8                     jsr     <a href="#Symgetlc">getlc</a>
C6B8: 5A                           phy
C6B9: 8C 78 06                     sty     <a href="#Symsl_lcstate">sl_lcstate</a>
C6BC: 20 EF D8                     jsr     <a href="#Symbool_sl">bool_sl</a>
C6BF: 4C 0E C8                     jmp     <a href="#SymLC80E">LC80E</a>

C6C2: DA           <span id="SymLC6C2">LC6C2</span>           phx
C6C3: 20 16 C8                     jsr     <a href="#Symgetlc">getlc</a>
C6C6: 5A                           phy
C6C7: 20 21 D6                     jsr     <a href="#Symx_setmou">x_setmou</a>
C6CA: 4C 0E C8                     jmp     <a href="#SymLC80E">LC80E</a>

C6CD: DA                           DFB     $DA
C6CE: 20                           DFB     $20
C6CF: 16                           DFB     $16
C6D0: C8                           DFB     $C8
C6D1: 5A                           DFB     $5A
C6D2: 20                           DFB     $20
C6D3: C2                           DFB     $C2
C6D4: D6                           DFB     $D6
C6D5: 4C                           DFB     $4C
C6D6: 0E                           DFB     $0E
C6D7: C8                           DFB     $C8
C6D8: DA                           DFB     $DA
C6D9: 20                           DFB     $20
C6DA: 16                           DFB     $16
C6DB: C8                           DFB     $C8
C6DC: 5A                           DFB     $5A
C6DD: 20                           DFB     $20
C6DE: 79                           DFB     $79
C6DF: D6                           DFB     $D6
C6E0: 4C                           DFB     $4C
C6E1: 0E                           DFB     $0E
C6E2: C8                           DFB     $C8
C6E3: DA                           DFB     $DA
C6E4: 20                           DFB     $20
C6E5: 16                           DFB     $16
C6E6: C8                           DFB     $C8
C6E7: 5A                           DFB     $5A
C6E8: 20                           DFB     $20
C6E9: 68                           DFB     $68
C6EA: D6                           DFB     $D6
C6EB: 4C                           DFB     $4C
C6EC: 0E                           DFB     $0E
C6ED: C8                           DFB     $C8
C6EE: DA                           DFB     $DA
C6EF: 20                           DFB     $20
C6F0: 16                           DFB     $16
C6F1: C8                           DFB     $C8
C6F2: 5A                           DFB     $5A
C6F3: 20                           DFB     $20
C6F4: A3                           DFB     $A3
C6F5: D6                           DFB     $D6
C6F6: 4C                           DFB     $4C
C6F7: 0E                           DFB     $0E
C6F8: C8                           DFB     $C8
C6F9: DA                           DFB     $DA
C6FA: 20                           DFB     $20
C6FB: 16                           DFB     $16
C6FC: C8                           DFB     $C8
C6FD: 5A                           DFB     $5A
C6FE: 20                           DFB     $20
C6FF: 51                           DFB     $51
C700: D6                           DFB     $D6
C701: 4C                           DFB     $4C
C702: 0E                           DFB     $0E
C703: C8                           DFB     $C8
C704: DA                           DFB     $DA
C705: 20                           DFB     $20
C706: 16                           DFB     $16
C707: C8                           DFB     $C8
C708: 5A                           DFB     $5A
C709: 20                           DFB     $20
C70A: 00                           DFB     $00
C70B: D6                           DFB     $D6
C70C: 4C                           DFB     $4C
C70D: 0E                           DFB     $0E
C70E: C8                           DFB     $C8
C70F: 00 00 00 00+                 DS      13,$00
C71C: 8D                           DFB     $8D
C71D: 28                           DFB     $28
C71E: C0                           DFB     $C0

C71F: 4C C2 C6                     jmp     <a href="#SymLC6C2">LC6C2</a>

C722: 8D                           DFB     $8D
C723: 28                           DFB     $28
C724: C0                           DFB     $C0
C725: 4C                           DFB     $4C
C726: CD                           DFB     $CD
C727: C6                           DFB     $C6
C728: 8D                           DFB     $8D
C729: 28                           DFB     $28
C72A: C0                           DFB     $C0
C72B: 4C                           DFB     $4C
C72C: D8                           DFB     $D8
C72D: C6                           DFB     $C6
C72E: 8D                           DFB     $8D
C72F: 28                           DFB     $28
C730: C0                           DFB     $C0
C731: 4C                           DFB     $4C
C732: E3                           DFB     $E3
C733: C6                           DFB     $C6
C734: 8D                           DFB     $8D
C735: 28                           DFB     $28
C736: C0                           DFB     $C0
C737: 4C                           DFB     $4C
C738: EE                           DFB     $EE
C739: C6                           DFB     $C6
C73A: 8D                           DFB     $8D
C73B: 28                           DFB     $28
C73C: C0                           DFB     $C0
C73D: 4C                           DFB     $4C
C73E: F9                           DFB     $F9
C73F: C6                           DFB     $C6
C740: 8D                           DFB     $8D
C741: 28                           DFB     $28
C742: C0                           DFB     $C0
C743: 4C                           DFB     $4C
C744: 04                           DFB     $04
C745: C7                           DFB     $C7
C746: 8D           <span id="SymLC746">LC746</span>           DFB     $8D
C747: 28                           DFB     $28
C748: C0                           DFB     $C0
C749: 4C                           DFB     $4C
C74A: 9A                           DFB     $9A
C74B: CF                           DFB     $CF
C74C: 8D                           DFB     $8D
C74D: 28                           DFB     $28
C74E: C0                           DFB     $C0
C74F: 4C                           DFB     $4C
C750: B4                           DFB     $B4
C751: C6                           DFB     $C6
C752: 8D                           DFB     $8D
C753: 28                           DFB     $28
C754: C0                           DFB     $C0
C755: DA                           DFB     $DA
C756: 20                           DFB     $20
C757: 16                           DFB     $16
C758: C8                           DFB     $C8
C759: 5A                           DFB     $5A
C75A: 8C                           DFB     $8C
C75B: 78                           DFB     $78
C75C: 06                           DFB     $06
C75D: 20                           DFB     $20
C75E: 00                           DFB     $00
C75F: D8                           DFB     $D8
C760: 4C                           DFB     $4C
C761: 0E                           DFB     $0E
C762: C8                           DFB     $C8
C763: 00 00 00 00+                 DS      29,$00

                   ********************************************************************************
                   *                                                                              *
                   * Switching Routines                                                           *
                   *                                                                              *
                   ********************************************************************************
C780: 8D 28 C0                     sta     <a href="#Symvblint">vblint</a>+15
C783: 40                           rti

C784: 8D 28 C0     <span id="Symswrts2">swrts2</span>          sta     <a href="#Symvblint">vblint</a>+15
C787: 60                           rts

C788: 8D                           DFB     $8D
C789: 28                           DFB     $28
C78A: C0                           DFB     $C0
C78B: 4C                           DFB     $4C
C78C: 62                           DFB     $62
C78D: FA                           DFB     $FA
C78E: 8D                           DFB     $8D
C78F: 28                           DFB     $28
C790: C0                           DFB     $C0
C791: 2C                           DFB     $2C
C792: 87                           DFB     $87
C793: C7                           DFB     $C7
C794: 4C                           DFB     $4C
C795: 04                           DFB     $04
C796: C8                           DFB     $C8

C797: 8D 28 C0     <span id="SymLC797">LC797</span>           sta     <a href="#Symvblint">vblint</a>+15
C79A: 4C 80 C8                     jmp     <a href="#Sympcnv">pcnv</a>

C79D: 8D 28 C0     <span id="SymLC79D">LC79D</span>           sta     <a href="#Symvblint">vblint</a>+15
C7A0: 4C 00 D4                     jmp     <a href="#Symbasicin">basicin</a>

C7A3: 8D                           DFB     $8D
C7A4: 28                           DFB     $28
C7A5: C0                           DFB     $C0
C7A6: 4C                           DFB     $4C
C7A7: F1                           DFB     $F1
C7A8: C7                           DFB     $C7
C7A9: 8D                           DFB     $8D
C7AA: 28                           DFB     $28
C7AB: C0                           DFB     $C0
C7AC: 4C                           DFB     $4C
C7AD: 06                           DFB     $06
C7AE: C8                           DFB     $C8
C7AF: 8D                           DFB     $8D
C7B0: 28                           DFB     $28
C7B1: C0                           DFB     $C0
C7B2: 4C                           DFB     $4C
C7B3: 4E                           DFB     $4E
C7B4: C3                           DFB     $C3
C7B5: 8D                           DFB     $8D
C7B6: 28                           DFB     $28
C7B7: C0                           DFB     $C0
C7B8: 4C                           DFB     $4C
C7B9: 97                           DFB     $97
C7BA: C3                           DFB     $C3
C7BB: 8D                           DFB     $8D
C7BC: 28                           DFB     $28
C7BD: C0                           DFB     $C0
C7BE: 4C                           DFB     $4C
C7BF: 00                           DFB     $00
C7C0: C1                           DFB     $C1
C7C1: 8D                           DFB     $8D
C7C2: 28                           DFB     $28
C7C3: C0                           DFB     $C0
C7C4: 4C                           DFB     $4C
C7C5: 8E                           DFB     $8E
C7C6: D4                           DFB     $D4
C7C7: 8D                           DFB     $8D
C7C8: 28                           DFB     $28
C7C9: C0                           DFB     $C0
C7CA: 4C                           DFB     $4C
C7CB: 80                           DFB     $80
C7CC: C5                           DFB     $C5
C7CD: 8D                           DFB     $8D
C7CE: 28                           DFB     $28
C7CF: C0                           DFB     $C0
C7D0: 4C                           DFB     $4C
C7D1: 4F                           DFB     $4F
C7D2: C2                           DFB     $C2
C7D3: 8D                           DFB     $8D
C7D4: 28                           DFB     $28
C7D5: C0                           DFB     $C0
C7D6: 4C                           DFB     $4C
C7D7: AC                           DFB     $AC
C7D8: C2                           DFB     $C2
C7D9: 8D                           DFB     $8D
C7DA: 28                           DFB     $28
C7DB: C0                           DFB     $C0
C7DC: 4C                           DFB     $4C
C7DD: C3                           DFB     $C3
C7DE: C2                           DFB     $C2
C7DF: 8D                           DFB     $8D
C7E0: 28                           DFB     $28
C7E1: C0                           DFB     $C0
C7E2: 4C                           DFB     $4C
C7E3: F7                           DFB     $F7
C7E4: C2                           DFB     $C2
C7E5: 8D                           DFB     $8D
C7E6: 28                           DFB     $28
C7E7: C0                           DFB     $C0
C7E8: 4C                           DFB     $4C
C7E9: C5                           DFB     $C5
C7EA: D4                           DFB     $D4
C7EB: 8D                           DFB     $8D
C7EC: 28                           DFB     $28
C7ED: C0                           DFB     $C0
C7EE: 6C                           DFB     $6C
C7EF: ED                           DFB     $ED
C7F0: 03                           DFB     $03

C7F1: DA                           phx
C7F2: 20 16 C8                     jsr     <a href="#Symgetlc">getlc</a>
C7F5: 5A                           phy
C7F6: 20 A0 D1                     jsr     <a href="#Symsetterm">setterm</a>
C7F9: 80 13                        bra     <a href="#SymLC80E">LC80E</a>

C7FB: 00 00 00 00+                 DS      8,$00
C803: 4C                           DFB     $4C
C804: 8E                           DFB     $8E
C805: C7                           DFB     $C7
C806: DA                           DFB     $DA
C807: 20                           DFB     $20
C808: 16                           DFB     $16
C809: C8                           DFB     $C8
C80A: 5A                           DFB     $5A
C80B: 20                           DFB     $20
C80C: 00                           DFB     $00
C80D: D0                           DFB     $D0

C80E: FA           <span id="SymLC80E">LC80E</span>           plx
C80F: FE 00 C0                     inc     <a href="#SymLC000">LC000</a>,X
C812: FA                           plx
C813: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

                   ********************************************************************************
                   * GETLC - Gets language card state in Y                                        *
                   ********************************************************************************
C816: A0 81        <span id="Symgetlc">getlc</span>           ldy     #$81
C818: 2C 12 C0                     bit     <a href="#SymLC000">LC000</a>+18
C81B: 10 0C                        bpl     <a href="#Symglcdone">glcdone</a>
C81D: A0 8B                        ldy     #$8B
C81F: 2C 11 C0                     bit     <a href="#SymLC000">LC000</a>+17
C822: 10 02                        bpl     <a href="#Symglcbnk1">glcbnk1</a>
C824: A0 83                        ldy     #$83
C826: 8D 81 C0     <span id="Symglcbnk1">glcbnk1</span>         sta     <a href="#Symreqset">reqset</a>
C829: 60           <span id="Symglcdone">glcdone</span>         rts

C82A: 53 43 2B 29+                 ASC     ‘SC+)’,$07
C82F: 00           <span id="SymSWTBL0">SWTBL0</span>          DFB     $00
C830: 89                           DFB     $89
C831: 03                           DFB     $03
C832: 05                           DFB     $05
C833: 09                           DFB     $09
C834: 01                           DFB     $01
C835: 7F                           DFB     $7F
C836: 5F                           DFB     $5F
C837: 00                           DFB     $00
C838: 83                           DFB     $83
C839: 51 53 55 57                  ASC     ‘QSUW’
C83D: 0F                           DFB     $0F
C83E: 0D                           DFB     $0D
C83F: 00                           DFB     $00
C840: 80                           DFB     $80
C841: 00           <span id="SymSWTBL1">SWTBL1</span>          DFB     $00
C842: 81                           DFB     $81
C843: 04                           DFB     $04
C844: 06                           DFB     $06
C845: 0A                           DFB     $0A
C846: 02                           DFB     $02
C847: 7F                           DFB     $7F
C848: 60                           DFB     $60
C849: 00                           DFB     $00
C84A: 84                           DFB     $84
C84B: 52 54 56 58                  ASC     ‘RTVX’
C84F: 10                           DFB     $10
C850: 0E                           DFB     $0E
C851: 00                           DFB     $00
C852: 7F                           DFB     $7F
C853: 00           <span id="SymRSWTBL">RSWTBL</span>          DFB     $00
C854: 11                           DFB     $11
C855: 13                           DFB     $13
C856: 14                           DFB     $14
C857: 16                           DFB     $16
C858: 18                           DFB     $18
C859: FF                           DFB     $FF
C85A: 7F                           DFB     $7F
C85B: 00                           DFB     $00
C85C: 12                           DFB     $12
C85D: 1A                           DFB     $1A
C85E: 1B                           DFB     $1B
C85F: 1C                           DFB     $1C
C860: 1D                           DFB     $1D
C861: 1E                           DFB     $1E
C862: 1F                           DFB     $1F
C863: 00                           DFB     $00
C864: 7E                           DFB     $7E
C865: 00                           DFB     $00
C866: D2 C1 CD A0+ <span id="SymLC866">LC866</span>           ASC     “RAM ZP”
C86C: CD           <span id="SymLC86C">LC86C</span>           DFB     $CD
C86D: CD                           DFB     $CD
C86E: D5                           DFB     $D5
C86F: C9           <span id="SymLC86F">LC86F</span>           DFB     $C9
C870: CF                           DFB     $CF
C871: D5                           DFB     $D5
C872: C7           <span id="SymLC872">LC872</span>           DFB     $C7
C873: CC                           DFB     $CC
C874: D5                           DFB     $D5
C875: D3 F9 F3 F4+ <span id="SymLC875">LC875</span>           ASC     “System OK”
C87E: 00                           DFB     $00
C87F: 00                           DFB     $00

                   NOTE: pdf page 510
                   ********************************************************************************
                   * The //c bank switch jumps here for pcnv (protocol converter)                 *
                   ********************************************************************************
C880: 4C 4C CD     <span id="Sympcnv">pcnv</span>            jmp     <a href="#SymEntry">Entry</a>

                   ****************************************************************
                   *                                                              *
                   * SendOnePack                   Send a CBUS Packet             *
                   *                                                              *
                   *   This routine sends a packet of data across the             *
                   * bus.  The protocol is as follows:                            *
                   *              ___________________________                     *
                   *  REQ _______|2                         5|___________         *
                   *         _______________________________                      *
                   * /BSY___|1              3              4|____________         *
                   *                                                              *
                   *    1)  Device signals ready for data                         *
                   *    2)  Host signals data iminent                             *
                   *    3)  Packet is transmitted (sync, command mark,            *
                   *         ids, contents, checksum [msb=1])                     *
                   *    4)  Device signals packet received                        *
                   *    5)  Host finishes send data cycle                         *
                   *                                                              *
                   *    The bytes are sent in slow mode (32 cycles/byte)          *
                   *  and the timing is critical.  Branches which should          *
                   *  not cross page boundaries are marked.                       *
                   *                                                              *
                   *                                                              *
                   *   Input:  buffer (2 bytes) &lt;- ptr to data to send            *
                   *           bytecount (2)    &lt;- length (bytes) of data         *
                   *           packettype (1)   &lt;- command or data packet         *
                   *           CMDUnit (1)      &lt;- # of device to receive         *
                   *                                                              *
                   *  Output: carry set- handshake error                          *
                   *                clr- bytes sent                               *
                   *                                                              *
                   ****************************************************************
C883: 20 61 CB     <span id="SymSendOnePack">SendOnePack</span>     jsr     <a href="#SymWritePrep">WritePrep</a>         ;Does a bunch of stuff
                   ; 
                   ; Enable PC chain.
                   ; 
C886: 20 7D CA                     jsr     <a href="#Symenablechain">enablechain</a>       ;This set X reg
C889: A0 07                        ldy     #<a href="#Symiwmmode">iwmmode</a>          ;This is the mode value
C88B: 20 20 CC                     jsr     <a href="#SymSetIWMode">SetIWMode</a>         ;Don't mess unless we gotta
                   ; 
                   ; Turn on the IWM
                   ; 
C88E: BD 8B C0                     lda     <a href="#Symenable2">enable2</a>,X         ;Don't disturb //c internal drive
C891: BD 89 C0                     lda     <a href="#Symmonset">monset</a>,X
                   ; 
                   ; Loop until the chain becomes unbusy
                   ; 
C894: A0 32                        ldy     #$32              ;Each loop is 11 microseconds
C896: BD 8E C0     <span id="Symubsy1">ubsy1</span>           lda     <a href="#Syml7clr">l7clr</a>,X           ;Test if /BSY is hi or low
C899: 30 07                        bmi     <a href="#Symchainunbsy">chainunbsy</a>        ;If hi, busy is not busy
C89B: 88                           dey
C89C: D0 F8                        bne     <a href="#Symubsy1">ubsy1</a>             ;Keep trying
C89E: 38                           sec
C89F: 4C CC C9                     jmp     <a href="#Symsd10">sd10</a>

                   ; 
                   ; Tell the bus that data is coming and send the sync bytes
                   ;   Sync is groups of eight 2's separated by a 6 (micS cell)
                   ;   (111111110011111111001111111100 ...)
                   ; 
C8A2: BD 81 C0     <span id="Symchainunbsy">chainunbsy</span>      lda     <a href="#Symreqset">reqset</a>,X          ;Raise REQ
                   ; 
C8A5: A0 05                        ldy     #$05              ;Sync plus packet begin
                   ; 
C8A7: A9 FF                        lda     #$FF              ;Send out the 1st byte sync
C8A9: 9D 8F C0                     sta     <a href="#Syml7set">l7set</a>,X
                   ; 
C8AC: B9 D3 C9     <span id="Symssb">ssb</span>             lda     <a href="#Sympreamble">preamble</a>,Y
                   ; 
                   ; 
C8AF: 1E 8C C0     <span id="Symssd">ssd</span>             asl     <a href="#Syml6clr">l6clr</a>,X           ;Wait 'til buffer empty
C8B2: 90 FB                        bcc     <a href="#Symssd">ssd</a>
                   ; 
C8B4: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X
C8B7: 88                           dey
C8B8: 10 F2                        bpl     <a href="#Symssb">ssb</a>               ;Back for more bytes
                   ; 
                   ; Send over the desination ID
                   ; 
C8BA: A5 5A                        lda     <a href="#SymUnit">Unit</a>
C8BC: 09 80                        ora     #$80              ;Make the device ID
C8BE: 20 50 CA                     jsr     <a href="#Symsendbyte">sendbyte</a>
                   ; 
                   ; Send the source ID (that's us... we're an $80)
                   ; 
C8C1: 20 4E CA                     jsr     <a href="#Symsend80">send80</a>
                   ; 
                   ; Send over the packet type (command or data)
                   ; 
C8C4: A5 5B                        lda     <a href="#SymWpacketType">WpacketType</a>
C8C6: 20 50 CA                     jsr     <a href="#Symsendbyte">sendbyte</a>
                   ; 
                   ; Send the Auxilliary Type byte (an $80 from this rev PC)
                   ; 
C8C9: 20 4E CA                     jsr     <a href="#Symsend80">send80</a>
                   ; 
                   ; Send the status byte (null for us), and length bytes
                   ; 
C8CC: 20 4E CA                     jsr     <a href="#Symsend80">send80</a>
C8CF: A5 4C                        lda     <a href="#Symoddbytes">oddbytes</a>
C8D1: 09 80                        ora     #$80
C8D3: 20 50 CA                     jsr     <a href="#Symsendbyte">sendbyte</a>
C8D6: A5 4B                        lda     <a href="#Symgrp7ctr">grp7ctr</a>
C8D8: 09 80                        ora     #$80
C8DA: 20 50 CA                     jsr     <a href="#Symsendbyte">sendbyte</a>
                   ; 
                   ; Now send the "oddbytes" part of the packet contents
                   ; 
C8DD: A5 4C                        lda     <a href="#Symoddbytes">oddbytes</a>          ;Get # of "odd" bytes
C8DF: F0 15                        beq     <a href="#Symsob2">sob2</a>              ;Skip if no odd bytes
                   ; 
C8E1: A0 FF                        ldy     #$FF
C8E3: A5 59                        lda     <a href="#Symtbodd">tbodd</a>             ;Get the odd bytes msb's (A[7]=1)
                   ; 
C8E5: 1E 8C C0     <span id="Symsob1">sob1</span>            asl     <a href="#Syml6clr">l6clr</a>,X           ;Do a write handshake
C8E8: 90 FB                        bcc     <a href="#Symsob1">sob1</a>
C8EA: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X
C8ED: C8                           iny
C8EE: B1 54                        lda     (<a href="#Symbuffer">buffer</a>),Y        ;Get the data byte
C8F0: 09 80                        ora     #$80              ;Flip on the hi bit
C8F2: C4 4C                        cpy     <a href="#Symoddbytes">oddbytes</a>          ;Are we done?
C8F4: 90 EF                        bcc     <a href="#Symsob1">sob1</a>
                   ; 
                   ; Now send over the groups of seven contents
                   ; Currently assume there must be at least one group of 'em
                   ; 
C8F6: A5 4B        <span id="Symsob2">sob2</span>            lda     <a href="#Symgrp7ctr">grp7ctr</a>           ;Check if there are groups to send
C8F8: D0 03                        bne     <a href="#Symsob3">sob3</a>              ;=&gt; At least one group
C8FA: 4C 96 C9                     jmp     <a href="#Symdatdone">datdone</a>           ;Skip to send checksum

C8FD: EA           <span id="Symsob3">sob3</span>            nop                       ;Waste 2 cycles
C8FE: A0 00                        ldy     #$00
C900: A5 41        <span id="Symstart">start</span>           lda     <a href="#Symtopbits">topbits</a>
C902: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X
                   ; 
                   ; Send first byte
                   ; 
C905: A5 4D                        lda     <a href="#Symbytecount">bytecount</a>
C907: 09 80                        ora     #$80
C909: 84 59                        sty     &lt;<a href="#Symtemp">temp</a>+97          ;Swap Y for short handshake
C90B: BC 8C C0     <span id="Symachel">achel</span>           ldy     <a href="#Syml6clr">l6clr</a>,X           ;Wait 'til buffer ready
C90E: 10 FB                        bpl     <a href="#Symachel">achel</a>
C910: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X           ;Send the byte
C913: A4 59                        ldy     &lt;<a href="#Symtemp">temp</a>+97          ;Get back Y
                   ; 
                   ; Prep the next "1st" byte for next time
                   ; 
C915: B1 56                        lda     (<a href="#Symauxptr">auxptr</a>),Y
C917: 85 4D                        sta     <a href="#Symbytecount">bytecount</a>
C919: 0A                           asl     A
C91A: 26 41                        rol     <a href="#Symtopbits">topbits</a>           ;Store the top bit
C91C: C8                           iny                       ;Next Byte
                   ; 
                   ; It's possible that we're at a page boundary now. If so, bump the
                   ;  hi order part of the pointer.
                   ; 
C91D: D0 05                        bne     <a href="#Symskip1">skip1</a>
C91F: E6 57                        inc     <a href="#Symbuffer2">buffer2</a>+1
C921: 4C 26 C9                     jmp     <a href="#Symskip2">skip2</a>

C924: 48           <span id="Symskip1">skip1</span>           pha                       ;Equalize the cases
C925: 68                           pla
                   ; 
                   ; Push us ahead by an additional 8 cycles for margin reasons
                   ;  Plus I gotta get the topbits MSB set somehow...
                   ; 
C926: A9 02        <span id="Symskip2">skip2</span>           lda     #%00000010        ;Flip what will be MSB
C928: 05 41                        ora     <a href="#Symtopbits">topbits</a>
C92A: 85 41                        sta     <a href="#Symtopbits">topbits</a>
                   ; 
                   ; Send the second byte
                   ; 
C92C: A5 4E                        lda     <a href="#SymAuxType">AuxType</a>
C92E: 09 80                        ora     #$80
C930: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X           ;Send the byte
C933: B1 56                        lda     (<a href="#Symauxptr">auxptr</a>),Y
C935: 85 4E                        sta     <a href="#SymAuxType">AuxType</a>
C937: 0A                           asl     A
C938: 26 41                        rol     <a href="#Symtopbits">topbits</a>           ;Store the top bit
C93A: C8                           iny                       ;Next byte
                   ; 
                   ; Send the third byte
                   ; 
C93B: A5 4F                        lda     <a href="#Symnext3">next3</a>
C93D: 09 80                        ora     #$80
C93F: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X           ;Send the byte
C942: B1 56                        lda     (<a href="#Symauxptr">auxptr</a>),Y
C944: 85 4F                        sta     <a href="#Symnext3">next3</a>
C946: 0A                           asl     A
C947: 26 41                        rol     <a href="#Symtopbits">topbits</a>           ;Store the top bit
C949: C8                           iny                       ;Next byte
                   ; 
                   ; Send the fourth byte
                   ; 
C94A: A5 50                        lda     <a href="#SymDeviceID">DeviceID</a>
C94C: 09 80                        ora     #$80
C94E: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X           ;Send the byte
C951: B1 56                        lda     (<a href="#Symauxptr">auxptr</a>),Y
C953: 85 50                        sta     <a href="#SymDeviceID">DeviceID</a>
C955: 0A                           asl     A
C956: 26 41                        rol     <a href="#Symtopbits">topbits</a>           ;Store the top bit
C958: C8                           iny                       ;next byte
                   ; 
                   ; After the first 256 bytes, we will cross pages here.  If we did
                   ;  cross, bump the buffer pointer. If not, equalize the cases with
                   ;  seven cycles of time wasting.
                   ; 
C959: D0 05                        bne     <a href="#Symskip3">skip3</a>
C95B: E6 57                        inc     <a href="#Symbuffer2">buffer2</a>+1
C95D: 4C 62 C9                     jmp     <a href="#Symskip4">skip4</a>

C960: 48           <span id="Symskip3">skip3</span>           pha
C961: 68                           pla
                   ; 
                   ; Send the fifth byte
                   ; 
C962: A5 51        <span id="Symskip4">skip4</span>           lda     <a href="#SymHostID">HostID</a>
C964: 09 80                        ora     #$80
C966: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X           ;Send the byte
C969: B1 56                        lda     (<a href="#Symauxptr">auxptr</a>),Y
C96B: 85 51                        sta     <a href="#SymHostID">HostID</a>
C96D: 0A                           asl     A
C96E: 26 41                        rol     <a href="#Symtopbits">topbits</a>           ;Store the top bit
C970: C8                           iny                       ;Next byte
                   ; 
                   ; Send the sixth byte
                   ; 
C971: A5 52                        lda     <a href="#Symnext6">next6</a>
C973: 09 80                        ora     #$80
C975: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X           ;Send the byte
C978: B1 56                        lda     (<a href="#Symauxptr">auxptr</a>),Y
C97A: 85 52                        sta     <a href="#Symnext6">next6</a>
C97C: 0A                           asl     A
C97D: 26 41                        rol     <a href="#Symtopbits">topbits</a>           ;Store the top bit
C97F: C8                           iny                       ;Next byte
                   ; 
                   ; Send the last byte of the group
                   ; 
C980: A5 53                        lda     <a href="#Symnext7">next7</a>
C982: 09 80                        ora     #$80
C984: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X           ;Send the byte
C987: B1 56                        lda     (<a href="#Symauxptr">auxptr</a>),Y
C989: 85 53                        sta     <a href="#Symnext7">next7</a>
C98B: 0A                           asl     A
C98C: 26 41                        rol     <a href="#Symtopbits">topbits</a>           ;Store the top bit
C98E: C8                           iny                       ;Next byte
                   ; 
                   ; Now see if we have sent enough groups of seven
                   ; 
C98F: C6 4B                        dec     <a href="#Symgrp7ctr">grp7ctr</a>
C991: F0 03                        beq     <a href="#Symdatdone">datdone</a>
                   ; 
                   ; Otherwise, back to do more.  Note it's too far for a branch.
                   ; 
C993: 4C 00 C9                     jmp     <a href="#Symstart">start</a>

                   ; 
                   ; Whew! Now send the dman checksum as two FM bytes
                   ; 
C996: A5 40        <span id="Symdatdone">datdone</span>         lda     <a href="#Symchecksum">checksum</a>          ;c7 c6 c5 c4 c3 c2 c1 c0
C998: 09 AA                        ora     #$AA              ; 1 c6  1 c4  1 c2  1 c0
C99A: BC 8C C0     <span id="Symscm1">scm1</span>            ldy     <a href="#Syml6clr">l6clr</a>,X
C99D: 10 FB                        bpl     <a href="#Symscm1">scm1</a>              ;Handshake this byte
C99F: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X           ;These are even bits
C9A2: A5 40                        lda     <a href="#Symbushog">bushog</a>            ;c7 c6 c5 c4 c3 c2 c1 c0
C9A4: 4A                           lsr     A                 ; 0 c7 c6 c5 c4 c3 c2 c1
C9A5: 09 AA                        ora     #$AA              ; 1 c7  1 c5  1 c3  1 c1
C9A7: 20 50 CA                     jsr     <a href="#Symsendbyte">sendbyte</a>
                   ; 
                   ; Send the end of packet mark
                   ; 
C9AA: A9 C8                        lda     #<a href="#Sympacketend">packetend</a>
C9AC: 20 50 CA                     jsr     <a href="#Symsendbyte">sendbyte</a>
                   ; 
                   ; Wait until write underflow
                   ; 
C9AF: BD 8C C0     <span id="Symsd7">sd7</span>             lda     <a href="#Syml6clr">l6clr</a>,X
C9B2: 29 40                        and     #$40
C9B4: D0 F9                        bne     <a href="#Symsd7">sd7</a>               ;Still writing data
                   ; 
C9B6: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X           ;Back to sense mode (dummy write)
                   ; 
                   ; Now wait until the drive acknowledges reciept of the
                   ;  string or until timeout
                   ; 
                   ; 
C9B9: A0 0A                        ldy     #<a href="#Symbsyto2">bsyto2</a>           ;Load timeout to see bsy low
C9BB: 88           <span id="Sympatch1">patch1</span>          dey                       ;A little closer to an error
C9BC: D0 08                        bne     <a href="#Symsd9">sd9</a>               ;There's still time
                   ; 
                   ; Too much time has elapsed.  Drive didn't get string.
                   ; 
C9BE: A9 01                        lda     #<a href="#Symnoanswer">noanswer</a>         ;Report error in comm error byte
C9C0: 20 97 CA     <span id="Symdberror">dberror</span>         jsr     <a href="#SymSetXN0">SetXN0</a>            ;For dberror entry
C9C3: 38                           sec                       ;Signal a problem
C9C4: B0 06                        bcs     <a href="#Symsd10">sd10</a>

                   ; 
                   ; See if drive has acknowledged the bytes yet
                   ; 
C9C6: BD 8E C0     <span id="Symsd9">sd9</span>             lda     <a href="#Syml7clr">l7clr</a>,X           ;Wait 'til /BSY lo
C9C9: 30 F0                        bmi     <a href="#Sympatch1">patch1</a>
                   ; 
                   ; Finish the sequence
                   ; 
C9CB: 18                           clc                       ;This is a normal exit
C9CC: BD 80 C0     <span id="Symsd10">sd10</span>            lda     <a href="#Symreqclr">reqclr</a>,X          ;Set REQ lo
C9CF: BD 8C C0                     lda     <a href="#Syml6clr">l6clr</a>,X           ;Back into read me
                   ; 
                   ; Pull back the bytecount in all cases
                   ; 
C9D2: 60                           rts

                   ; 
                   ; 
                   ; This table, when went in reverse order, provides a
                   ;   sync pattern used to synchronize the drive IWM with
                   ;   the data stream.  The firstr byte (last sent) is the 
                   ;   packet begin mark.
                   ; 
C9D3: C3           <span id="Sympreamble">preamble</span>        DFB     $C3
C9D4: FF           <span id="Symsynctab">synctab</span>         DFB     $FF
C9D5: FC                           DFB     $FC
C9D6: F3                           DFB     $F3
C9D7: CF                           DFB     $CF
C9D8: 3F                           DFB     $3F

                   ; 
                   ; 
                   ; 
                   ; These routines are for wasting specific amounts of time
                   ;  This code segment should not cross page boundaries.
                   ; 
C9D9: 20 DE C9     <span id="Symwaste32">waste32</span>         jsr     <a href="#Symwaste14">waste14</a>
C9DC: EA           <span id="Symwaste18">waste18</span>         nop
C9DD: EA           <span id="Symwaste16">waste16</span>         nop
C9DE: EA           <span id="Symwaste14">waste14</span>         nop
C9DF: 60           <span id="Symwaste12">waste12</span>         rts

C9E0: 4C C0 C9     <span id="Symmarkerr">markerr</span>         jmp     <a href="#Symdberror">dberror</a>

                   ********************************************************************************
                   *                                                                              *
                   * ReceivePack          Get a packet from bus resident                          *
                   *                                                                              *
                   *              ___________________________                                     *
                   *  REQ _______|2                         5|___________                         *
                   *         _______________________________                                      *
                   * /BSY___|1              3              4|____________                         *
                   *                                                                              *
                   *    1)  Drive signals ready to send packet                                    *
                   *    2)  Host signals ready to receive data                                    *
                   *    3)  Packet is transmitted (sync, mark, IDs, data,                         *
                   *         checksum [msb=1])                                                    *
                   *    4)  Drive signals packet dispatched                                       *
                   *    5)  Host acknowledges reciept of packet                                   *
                   *                                                                              *
                   *     The bytes are sent in slow mode (32 cycles/byte)                         *
                   *   and the timing is critical.  Branches which should                         *
                   *   not cross page boundaries are marked.                                      *
                   *                                                                              *
                   *   Input:  buffer &lt;- address where packet guts left                           *
                   *                                                                              *
                   *  Output: carry set- handshake error                                          *
                   *                clr- bytes sent                                               *
                   *          A &lt;- error0 if carry set                                            *
                   *                                                                              *
                   ********************************************************************************
C9E3: A9 00        <span id="SymReceivePack">ReceivePack</span>     lda     #$00              ;Init the checksum
C9E5: 85 40                        sta     <a href="#Symbushog">bushog</a>
                   ; 
                   ; Copy over buffer -&gt; buffer2
                   ; 
C9E7: A5 54                        lda     <a href="#Symbuffer">buffer</a>
C9E9: 85 56                        sta     <a href="#Symauxptr">auxptr</a>
C9EB: A5 55                        lda     <a href="#Symbuffer">buffer</a>+1
C9ED: 85 57                        sta     <a href="#Symbuffer2">buffer2</a>+1
                   ; 
                   ; Set up the indirect pointer for jump to 2nd part of code
                   ; 
C9EF: 20 7D CA                     jsr     <a href="#Symenablechain">enablechain</a>       ;SetX register to $N0
                   ; 
C9F2: BD 8D C0                     lda     <a href="#Syml6set">l6set</a>,X           ;Prep for sense mode
                   ; 
                   ; Now wait for BSY to go hi, signalling 'ready w/ status'
                   ; 
C9F5: BD 8E C0     <span id="Symrdh1">rdh1</span>            lda     <a href="#Syml7clr">l7clr</a>,X           ;Read sense
C9F8: 10 FB                        bpl     <a href="#Symrdh1">rdh1</a>              ;Wait til a high
                   ; 
                   ; Signal Liron we're ready to receive
                   ; 
C9FA: BD 81 C0                     lda     <a href="#Symreqset">reqset</a>,X          ;Raise /REQ
                   ; 
                   ; Wait for a byte from Liorn or timeout
                   ; 
C9FD: A0 1E                        ldy     #<a href="#Symstatmto">statmto</a>          ;Max bytes 'til stat mark
C9FF: BD 8C C0     <span id="Symrdh2">rdh2</span>            lda     <a href="#Syml6clr">l6clr</a>,X
CA02: 10 FB                        bpl     <a href="#Symrdh2">rdh2</a>              ;*** No Page Cros ***
CA04: 88                           dey
CA05: 30 D9                        bmi     <a href="#Symmarkerr">markerr</a>           ;Didn't find a packet in time
                   ; 
                   ; Is it the beginning of the packeT?
                   ; 
CA07: C9 C3                        cmp     #<a href="#Sympacketbeg">packetbeg</a>        ;Find the packet begin mark
CA09: D0 F4                        bne     <a href="#Symrdh2">rdh2</a>              ;Back again - no timeout for now
                   ; 
                   ; Okay load up the table with this stuff
                   ; 
CA0B: A0 06        <span id="Symrdh5">rdh5</span>            ldy     #6                ;Seven bytes of overhead
CA0D: BD 8C C0     <span id="Symrdh3">rdh3</span>            lda     <a href="#Syml6clr">l6clr</a>,X           ;If byte ready, grab it
CA10: 10 FB                        bpl     <a href="#Symrdh3">rdh3</a>              ;*** No Page Cross ***
CA12: 29 7F                        and     #%01111111        ;Strip start bit
CA14: 99 4B 00                     sta     <a href="#Symrcvbuf">rcvbuf</a>,Y
CA17: 49 80                        eor     #$80              ;Pop MSB back on for checksum
CA19: 45 40                        eor     <a href="#Symbushog">bushog</a>
CA1B: 85 40                        sta     <a href="#Symbushog">bushog</a>
CA1D: 88                           dey
CA1E: 10 ED                        bpl     <a href="#Symrdh3">rdh3</a>
                   ; 
                   ; Set groups of seven buffer pointer buffer2
                   ; 
CA20: A5 4C                        lda     <a href="#Symoddbytes">oddbytes</a>
CA22: F0 27                        beq     <a href="#Symstart2">start2</a>            ;Skip alteration if no oddbytes
CA24: 18                           clc
CA25: 65 54                        adc     <a href="#Symbuffer">buffer</a>
CA27: 85 56                        sta     <a href="#Symbuffer2">buffer2</a>
CA29: A5 55                        lda     <a href="#Symbuffer">buffer</a>+1
CA2B: 69 00                        adc     #0
CA2D: 85 57                        sta     <a href="#Symbuffer2">buffer2</a>+1
                   ; 
CA2F: A0 00                        ldy     #0
                   ; 
                   ; Now receive the odd bytes
                   ; 
CA31: BD 8C C0     <span id="Symstart0">start0</span>          lda     <a href="#Syml6clr">l6clr</a>,X           ;Read in the odd bytes topbits
CA34: 10 FB                        bpl     <a href="#Symstart0">start0</a>
CA36: 0A                           asl     A                 ;Pop off the start bit
CA37: 85 41                        sta     <a href="#Symtopbits">topbits</a>
                   ; 
CA39: BD 8C C0     <span id="Symstart1">start1</span>          lda     <a href="#Syml6clr">l6clr</a>,X           ;Get an odd byte
CA3C: 10 FB                        bpl     <a href="#Symstart1">start1</a>
CA3E: 06 41                        asl     <a href="#Symtopbits">topbits</a>           ;Get an MSB
CA40: B0 02                        bcs     <a href="#Symgob1">gob1</a>              ;If MSB set, leave start bit
CA42: 49 80                        eor     #$80              ;MSB Clear- flip start bit
CA44: 91 54        <span id="Symgob1">gob1</span>            sta     (<a href="#Symbuffer">buffer</a>),Y        ;Squirrel it away
CA46: C8                           iny                       ;Next spot
CA47: C4 4C                        cpy     <a href="#Symoddbytes">oddbytes</a>          ;Are we done?
CA49: 90 EE                        bcc     <a href="#Symstart1">start1</a>            ;If more, branch
CA4B: 4C 73 CC     <span id="Symstart2">start2</span>          jmp     <a href="#SymSlotDepRd">SlotDepRd</a>

CA4E: A9 80        <span id="Symsend80">send80</span>          lda     #$80
CA50: BC 8C C0     <span id="Symsendbyte">sendbyte</span>        ldy     <a href="#Syml6clr">l6clr</a>,X
CA53: 10 FB                        bpl     <a href="#Symsendbyte">sendbyte</a>
CA55: 9D 8D C0                     sta     <a href="#Syml6set">l6set</a>,X
CA58: 45 40                        eor     <a href="#Symbushog">bushog</a>
CA5A: 85 40                        sta     <a href="#Symbushog">bushog</a>
CA5C: 60                           rts

                   ; 
                   ; 
                   ; 
                   ; 
CA5D: 20 87 CA     <span id="Symresetchain">resetchain</span>      jsr     <a href="#SymClrPhases">ClrPhases</a>
CA60: BD 81 C0                     lda     <a href="#Symreqset">reqset</a>,X
CA63: BD 85 C0                     lda     <a href="#Symca2set">ca2set</a>,X
CA66: A0 50                        ldy     #80               ;Hard reset for 80 ms
CA68: 20 70 CA                     jsr     <a href="#SymYMSWait">YMSWait</a>
                   ; 
CA6B: 20 87 CA                     jsr     <a href="#SymClrPhases">ClrPhases</a>
                   ; 
CA6E: A0 0A                        ldy     #10               ;About 10 mS reset time!
                   ; 
CA70: 20 77 CA     <span id="SymYMSWait">YMSWait</span>         jsr     <a href="#SymOneMS">OneMS</a>
CA73: 88                           dey
CA74: D0 FA                        bne     <a href="#SymYMSWait">YMSWait</a>
CA76: 60                           rts

CA77: A2 C8        <span id="SymOneMS">OneMS</span>           ldx     #200
CA79: CA           <span id="Symonems1">onems1</span>          dex
CA7A: D0 FD                        bne     <a href="#Symonems1">onems1</a>
CA7C: 60                           rts

                   ; 
CA7D: 20 97 CA     <span id="Symenablechain">enablechain</span>     jsr     <a href="#SymSetXN0">SetXN0</a>
CA80: BD 83 C0                     lda     <a href="#Symcalset">calset</a>,X
CA83: BD 87 C0                     lda     <a href="#Symlstrbset">lstrbset</a>,X
CA86: 60                           rts

                   ; 
CA87: 20 97 CA     <span id="SymClrPhases">ClrPhases</span>       jsr     <a href="#SymSetXN0">SetXN0</a>
CA8A: BD 80 C0                     lda     <a href="#Symreqclr">reqclr</a>,X
CA8D: BD 82 C0                     lda     <a href="#Symca1clr">ca1clr</a>,X
CA90: BD 84 C0                     lda     <a href="#Symca2clr">ca2clr</a>,X
CA93: BD 86 C0                     lda     <a href="#Symlstrbclr">lstrbclr</a>,X
CA96: 60                           rts

                   ; 
CA97: A2 60        <span id="SymSetXN0">SetXN0</span>          ldx     #$60
CA99: 60                           rts

                   ; 
                   ; Shgift tables for use when reading.  Each table should not
                   ;  straddle pages.
                   ; 
CA9A: 80 80 80 80+ <span id="Symshift1">shift1</span>          HEX     $80,$80,$80,$80,$80,$80,$80,$80
CAA2: 00 00 00 00+                 HEX     $00,$00,$00,$00,$00,$00,$00,$00
CAAA: 80 80 80 80+ <span id="Symshift2">shift2</span>          HEX     $80,$80,$80,$80,$00,$00,$00,$00
CAB2: 80 80 80 80+                 HEX     $80,$80,$80,$80,$00,$00,$00,$00
CABA: 80 80 00 00+ <span id="Symshift3">shift3</span>          HEX     $80,$80,$00,$00,$80,$80,$00,$00
CAC2: 80 80 00 00+                 HEX     $80,$80,$00,$00,$80,$80,$00,$00
CACA: 80 00 80 00+ <span id="Symshift4">shift4</span>          HEX     $80,$00,$80,$00,$80,$00,$80,$00
CAD2: 80 00 80 00+                 HEX     $80,$00,$80,$00,$80,$00,$80,$00

                   ; 
CADA: A9 05        <span id="SymSendData">SendData</span>        lda     #&gt;<a href="#SymRC2">RC2</a>+$500
CADC: A0 00                        ldy     #<a href="#SymRC2">RC2</a>-5
CADE: 20 FD CA                     jsr     <a href="#SymSendPile">SendPile</a>
CAE1: 90 05                        bcc     <a href="#Symsdoubt">sdoubt</a>
CAE3: A9 80                        lda     #<a href="#SymCommReset">CommReset</a>
CAE5: 20 98 CF                     jsr     <a href="#SymAssignID">AssignID</a>
CAE8: 60           <span id="Symsdoubt">sdoubt</span>          rts

                   ; 
CAE9: 20 FD CA     <span id="SymSendPack">SendPack</span>        jsr     <a href="#SymSendPile">SendPile</a>          ;Try to send a pack
CAEC: 90 FA                        bcc     <a href="#Symsdoubt">sdoubt</a>
CAEE: A9 80                        lda     #<a href="#SymCommReset">CommReset</a>        ;This is a communications failure
CAF0: 20 98 CF                     jsr     <a href="#SymAssignID">AssignID</a>
                   ; 
CAF3: AD F8 06                     lda     <a href="#Symtemp">temp</a>              ;Get back the packetlength
CAF6: 85 4D                        sta     <a href="#Symbytecountl">bytecountl</a>
CAF8: AD 78 07                     lda     <a href="#SymSvBcH">SvBcH</a>
CAFB: 85 4E                        sta     <a href="#Symbytecounth">bytecounth</a>
                   ; 
CAFD: A9 B8        <span id="SymSendPile">SendPile</span>        lda     #&gt;<a href="#SymRC1">RC1</a>-$5300       ;Return count (big!)
CAFF: A0 0B                        ldy     #&lt;<a href="#SymRC1">RC1</a>+83
                   ; 
CB01: A6 58        <span id="SymAltSendPile">AltSendPile</span>     ldx     <a href="#SymSlot">Slot</a>
CB03: 9D F3 04                     sta     <a href="#SymRetry">Retry</a>,X
CB06: 98                           tya
CB07: 9D 73 05                     sta     <a href="#SymRetry2">Retry2</a>,X
                   ; 
                   ; SendPack destroys the bytecount
                   ; 
CB0A: A5 4D        <span id="Symspile1">spile1</span>          lda     <a href="#Symbytecountl">bytecountl</a>
CB0C: 8D F8 06                     sta     <a href="#Symtemp">temp</a>
CB0F: A5 4E                        lda     <a href="#Symbytecounth">bytecounth</a>
CB11: 8D 78 07                     sta     <a href="#SymSvBcH">SvBcH</a>
                   ; 
CB14: 20 83 C8                     jsr     <a href="#SymSendOnePack">SendOnePack</a>       ;Send the packet
                   ; 
CB17: AD F8 06                     lda     <a href="#Symtemp">temp</a>
CB1A: 85 4D                        sta     <a href="#Symbytecountl">bytecountl</a>
CB1C: AD 78 07                     lda     <a href="#SymSvBcH">SvBcH</a>
CB1F: 85 4E                        sta     <a href="#Symbytecounth">bytecounth</a>
                   ; 
CB21: 90 0C                        bcc     <a href="#Symspilout">spilout</a>
CB23: A6 58                        ldx     <a href="#SymSlot">Slot</a>
CB25: DE F3 04                     dec     <a href="#SymRetry">Retry</a>,X
CB28: D0 E0                        bne     <a href="#Symspile1">spile1</a>
CB2A: DE 73 05                     dec     <a href="#SymRetry2">Retry2</a>,X
CB2D: 10 DB                        bpl     <a href="#Symspile1">spile1</a>            ;If all fails, carry is set
CB2F: 60           <span id="Symspilout">spilout</span>         rts

CB30: A4 58        <span id="SymRecPack">RecPack</span>         ldy     <a href="#SymSlot">Slot</a>
CB32: A9 05                        lda     #&gt;<a href="#SymRC2">RC2</a>+$500
CB34: 99 F3 04                     sta     <a href="#SymRetry">Retry</a>,Y
                   ; 
CB37: 20 E3 C9     <span id="Symrpk1">rpk1</span>            jsr     <a href="#SymReceivePack">ReceivePack</a>
CB3A: 90 0F                        bcc     <a href="#Symrpout">rpout</a>
CB3C: A0 01                        ldy     #1
CB3E: 20 70 CA                     jsr     <a href="#SymYMSWait">YMSWait</a>
CB41: 20 C0 C9                     jsr     <a href="#Symdberror">dberror</a>           ;Recycle handshake and set carry
CB44: A6 58                        ldx     <a href="#SymSlot">Slot</a>
CB46: DE F3 04                     dec     <a href="#SymRetry">Retry</a>,X
CB49: D0 EC                        bne     <a href="#Symrpk1">rpk1</a>              ;Carry set still
CB4B: 60           <span id="Symrpout">rpout</span>           rts

                   ********************************************************************************
                   *                                                                              *
                   * Divide7               Do DIV and MOD 7 and set auxptr                        *
                   *  This routine divides the bytecount by seven.  The                           *
                   *   quotient gives the number of groups of seven bytes to                      *
                   *   be sent, and the remainder gives the number of "odd"                       *
                   *   bytes.                                                                     *
                   *                                                                              *
                   *   Input:  bytecountl,h &lt;- # of bytes to write                                *
                   *           buffer       &lt;- pointer to data                                    *
                   *   Output: auxptr       &lt;- pointer to speed up csumming                       *
                   *           oddbytes     &lt;- bytecount MOD 7                                    *
                   *           grp7ctr      &lt;- bytecount DIV 7                                    *
                   *                                                                              *
                   ********************************************************************************
CB4C: 00 24 49     <span id="Sympdiv7tab">pdiv7tab</span>        HEX     $00,$24,$49
CB4F: 00 04 01     <span id="Sympmod7tab">pmod7tab</span>        HEX     $00,$04,$01
CB52: 00 01 02 04+ <span id="Symdiv7tab">div7tab</span>         HEX     $00,$01,$02,$04,$09,$12
CB58: 00 01 02 04+ <span id="Symmod7tab">mod7tab</span>         HEX     $00,$01,$02,$04,$01,$02
                   ; 
CB5E: 00 7F FF     <span id="Symauxptrinc">auxptrinc</span>       HEX     $00,$7F,$FF

                   ; 
                   ; Set up auxptr &lt;- buffer+$80   if $0FF &lt; bytecount &lt; $200
                   ;     or auxptr &lt;- buffer+$100  if $1FF &lt; bytecount
                   ; 
                   ; aka Divide7
CB61: A6 4E        <span id="SymWritePrep">WritePrep</span>       ldx     <a href="#Symbytecounth">bytecounth</a>        ;0, 1 or 2
CB63: F0 17                        beq     <a href="#Symnoauxptr">noauxptr</a>          ;Auxptr used only for full pages
                   ; 
CB65: A5 55                        lda     <a href="#Symbuffer">buffer</a>+1
CB67: 85 57                        sta     <a href="#Symauxptr">auxptr</a>+1          ;Copy over hi order part
                   ; 
CB69: A9 80                        lda     #$80              ;Anticipate smaller bytecount
CB6B: E0 01                        cpx     #1                ;Check bytecount
CB6D: F0 04                        beq     <a href="#Symsap1">sap1</a>              ;=&gt; $0FF &lt; bytecount &lt; $200
                   ; 
CB6F: E6 57                        inc     <a href="#Symauxptr">auxptr</a>+1          ;Add $100 to bytecount instead
CB71: A9 00                        lda     #0                ;Make sure lo order unaltered
CB73: 18           <span id="Symsap1">sap1</span>            clc
CB74: 65 54                        adc     <a href="#Symbuffer">buffer</a>
CB76: 85 56                        sta     <a href="#Symauxptr">auxptr</a>
CB78: 90 02                        bcc     <a href="#Symnoauxptr">noauxptr</a>          ;skip if no carry
CB7A: E6 57                        inc     <a href="#Symauxptr">auxptr</a>+1          ;don't forget me
                   ; 
                   ; Now look up the first order guess for DIV and MOD.  X still has
                   ;  bytecount DIV 256.
                   ; 
CB7C: BD 4C CB     <span id="Symnoauxptr">noauxptr</span>        lda     <a href="#Sympdiv7tab">pdiv7tab</a>,X
CB7F: 85 4B                        sta     <a href="#Symgrp7ctr">grp7ctr</a>
CB81: BD 4F CB                     lda     <a href="#Sympmod7tab">pmod7tab</a>,X
CB84: 85 4C                        sta     <a href="#Symoddbytes">oddbytes</a>
                   ; 
                   ; Now add in the mods and divs for each of the five hi order
                   ;  bits in the lo order bytecount, correcting each time MOD becomes
                   ;  bigger than 6.
                   ; 
CB86: A2 05                        ldx     #5                ;Do for five bits
CB88: A5 4D                        lda     <a href="#Symbytecountl">bytecountl</a>
CB8A: 85 59                        sta     &lt;<a href="#Symtemp">temp</a>+97          ;Store lo order for shifting
CB8C: 29 07                        and     #%00000111        ;Save lo three for later
CB8E: A8                           tay
                   ; 
CB8F: 06 59        <span id="Symdivide3">divide3</span>         asl     &lt;<a href="#Symtemp">temp</a>+97          ;C &lt;- next from bytecountl
CB91: 90 15                        bcc     <a href="#Symdivide2">divide2</a>           ;If clear, no effect on DIV,MOD
CB93: BD 58 CB                     lda     <a href="#Symmod7tab">mod7tab</a>,X         ;Get MOD7 for 2^n
                   ; 
CB96: 18           <span id="Symdivide4">divide4</span>         clc
CB97: 65 4C                        adc     <a href="#Symoddbytes">oddbytes</a>          ;Got new MOD value
CB99: C9 07                        cmp     #7                ;Is it too big?
CB9B: 90 02                        bcc     <a href="#Symdivide1">divide1</a>
CB9D: E9 07                        sbc     #7                ;Bring MOD under 7 - C still set
                   ; 
CB9F: 85 4C        <span id="Symdivide1">divide1</span>         sta     <a href="#Symoddbytes">oddbytes</a>
CBA1: BD 52 CB                     lda     <a href="#Symdiv7tab">div7tab</a>,X         ;Get DIV for this 2^n
CBA4: 65 4B                        adc     <a href="#Symgrp7ctr">grp7ctr</a>           ;Add to DIV along with correction (C)
CBA6: 85 4B                        sta     <a href="#Symgrp7ctr">grp7ctr</a>           ;Update the DIV
                   ; 
CBA8: CA           <span id="Symdivide2">divide2</span>         dex                       ;One less bit to deal with
CBA9: 30 06                        bmi     <a href="#Symdivide5">divide5</a>           ;Escape after 6 times through loop
CBAB: D0 E2                        bne     <a href="#Symdivide3">divide3</a>           ;Take brnch 1st 5 loops
                   ; 
CBAD: 98                           tya                       ;Get back the last three bits
CBAE: 4C 96 CB                     jmp     <a href="#Symdivide4">divide4</a>           ;Sixth pass add in remains

                   ********************************************************************************
                   *                                                                              *
                   *  PreCheck                    Does the checksumming prepass                   *
                   *                                                                              *
                   *    Input:  bytecount   &lt;- bytes in buffer                                    *
                   *            buffer      &lt;- pointer to data to send                            *
                   *            auxptr      &lt;- extra pointer to speed process                     *
                   *   Output:  checksum    &lt;- 8 bit XOR of data to be sent                       *
                   *                                                                              *
                   ********************************************************************************
CBB1: A5 55        <span id="Symdivide5">divide5</span>         lda     <a href="#Symbuffer">buffer</a>+1          ;Checksum any full pages
CBB3: 48                           pha                       ;Preserve buffer pointer
CBB4: A9 00                        lda     #0
CBB6: A6 4E                        ldx     <a href="#Symbytecounth">bytecounth</a>
CBB8: F0 16                        beq     <a href="#Symlastpass">lastpass</a>          ;If no complete pages, skip this
                   ; 
CBBA: BC 5E CB     <span id="Symxor2">xor2</span>            ldy     <a href="#Symauxptrinc">auxptrinc</a>,X       ;Get number of bytes each ptr
                   ; 
CBBD: 51 54        <span id="Symxor1">xor1</span>            eor     (<a href="#Symbuffer">buffer</a>),Y
CBBF: 51 56                        eor     (<a href="#Symauxptr">auxptr</a>),Y
CBC1: 88                           dey                       ;One less
CBC2: D0 F9                        bne     <a href="#Symxor1">xor1</a>
CBC4: 51 54                        eor     (<a href="#Symbuffer">buffer</a>),Y
CBC6: 51 56                        eor     (<a href="#Symauxptr">auxptr</a>),Y        ;Have to deal with 0 case
                   ; 
                   ; Now move the buffer up for next section
                   ; 
CBC8: E0 01                        cpx     #1
CBCA: F0 02                        beq     <a href="#Symxor5">xor5</a>              ;If 256 and up bytes, bump x1
CBCC: E6 55                        inc     <a href="#Symbuffer">buffer</a>+1          ; otherwise x2
CBCE: E6 55        <span id="Symxor5">xor5</span>            inc     <a href="#Symbuffer">buffer</a>+1
                   ; 
                   ; Do the remaining less than a page with a single pointer
                   ; 
CBD0: A4 4D        <span id="Symlastpass">lastpass</span>        ldy     <a href="#Symbytecount">bytecount</a>
CBD2: F0 09                        beq     <a href="#Symxor4">xor4</a>
CBD4: 51 54                        eor     (<a href="#Symbuffer">buffer</a>),Y        ;Compensate for nth byte
CBD6: 51 54        <span id="Symxor3">xor3</span>            eor     (<a href="#Symbuffer">buffer</a>),Y
CBD8: 88                           dey
CBD9: D0 FB                        bne     <a href="#Symxor3">xor3</a>
CBDB: 51 54                        eor     (<a href="#Symbuffer">buffer</a>),Y        ;Last damn (0th) byte
                   ; 
                   ; Store result away.  Retrieve old buffer value.
                   ; 
CBDD: 85 40        <span id="Symxor4">xor4</span>            sta     <a href="#Symbushog">bushog</a>
CBDF: 68                           pla
CBE0: 85 55                        sta     <a href="#Symbuffer">buffer</a>+1
                   ********************************************************************************
                   *                                                                              *
                   *  DetTopBits                    Get topbits for odd bytes                     *
                   *                                                                              *
                   *    Also sets buffer2 pointer to pointer at groups of                         *
                   * seven bytes.                                                                 *
                   *                                                                              *
                   *    Input:  oddbytes &lt;- # of "odd" bytes                                      *
                   *            buffer   &lt;- pointer to data                                       *
                   *   Output:  tbodd    &lt;- topbits for odd bytes                                 *
                   *            buffer2  &lt;- buffer+oddbytes                                       *
                   *                                                                              *
                   ********************************************************************************
CBE2: A4 4C        <span id="SymDecTopBits">DecTopBits</span>      ldy     <a href="#Symoddbytes">oddbytes</a>
CBE4: 88                           dey
CBE5: A9 00                        lda     #0
                   ; 
CBE7: 85 59                        sta     <a href="#Symtbodd">tbodd</a>
CBE9: B1 54        <span id="Symgtbob">gtbob</span>           lda     (<a href="#Symbuffer">buffer</a>),Y
CBEB: 0A                           asl     A
CBEC: 66 59                        ror     <a href="#Symtbodd">tbodd</a>
CBEE: 88                           dey
CBEF: 10 F8                        bpl     <a href="#Symgtbob">gtbob</a>
CBF1: 38                           sec
CBF2: 66 59                        ror     <a href="#Symtbodd">tbodd</a>
                   ; 
CBF4: A5 4C                        lda     <a href="#Symoddbytes">oddbytes</a>
CBF6: 18                           clc
CBF7: 65 54                        adc     <a href="#Symbuffer">buffer</a>
CBF9: 85 56                        sta     <a href="#Symbuffer2">buffer2</a>
CBFB: A5 55                        lda     <a href="#Symbuffer">buffer</a>+1
CBFD: 69 00                        adc     #0
CBFF: 85 57                        sta     <a href="#Symbuffer2">buffer2</a>+1
                   ********************************************************************************
                   *                                                                              *
                   *  Sun                    Set up next buffer and topbits                       *
                   *                                                                              *
                   *    Primes the pip for the group of seven bytes routine                       *
                   *  setting the topbits byte and the "next" buffer.                             *
                   *  The routine also advances the buffer pointer by 7 to                        *
                   *  prepare for the groups of seven transfer.                                   *
                   *                                                                              *
                   *    Input:  buffer2   &lt;- points to groups of 7 data                           *
                   *   Output:  next1,7   &lt;- first 7 bytes in buffer                              *
                   *            topbits   &lt;- MSBs of first 7 bytes                                *
                   *                                                                              *
                   ********************************************************************************
CC01: A0 06        <span id="SymSun">Sun</span>             ldy     #6
CC03: 38           <span id="Symsun2">sun2</span>            sec
CC04: B1 56                        lda     (<a href="#Symbuffer2">buffer2</a>),Y
CC06: 99 4D 00                     sta     <a href="#Symnext">next</a>,Y
CC09: 30 01                        bmi     <a href="#Symsun1">sun1</a>
CC0B: 18                           clc
CC0C: 66 41        <span id="Symsun1">sun1</span>            ror     <a href="#Symtopbits">topbits</a>
CC0E: 88                           dey
CC0F: 10 F2                        bpl     <a href="#Symsun2">sun2</a>
CC11: 38                           sec
CC12: 66 41                        ror     <a href="#Symtopbits">topbits</a>
                   ; 
                   ; Advance the pointer
                   ; 
CC14: A5 56                        lda     <a href="#Symbuffer2">buffer2</a>
CC16: 18                           clc
CC17: 69 07                        adc     #7
CC19: 85 56                        sta     <a href="#Symbuffer2">buffer2</a>
CC1B: 90 02                        bcc     <a href="#Symsun3">sun3</a>
CC1D: E6 57                        inc     <a href="#Symbuffer2">buffer2</a>+1
CC1F: 60           <span id="Symsun3">sun3</span>            rts

                   ; 
                   ; 
                   ;  X is slot &amp; 16, Y is the desired mode
                   ; 
                   ;  Set up the IWM mode register.  Extreme care should be taken
                   ;   here. Setting the mode byte with indexed stores causes a 
                   ;   false byte to be written a cycle before the real value is
                   ;   written.  This false value, if it enables the timer, causes
                   ;   the IWM Rev A to pop the motor on, inhibiting the setting
                   ;   of the mode until the motor times out! We avoid this by
                   ;   setting the mode byte only when it is not what we want, and if
                   ;   it's not we stay here until we see that it is what we want.
                   ; 
CC20: BD 88 C0     <span id="SymSetIWMode">SetIWMode</span>       lda     <a href="#Symmonclr">monclr</a>,X          ;Motor must be off
CC23: BD 8D C0                     lda     <a href="#Syml6set">l6set</a>,X           ;Set up to access mode register
CC26: 4C 2D CC                     jmp     <a href="#Symcareful">careful</a>           ;Don't mess unless we gotta

CC29: 98           <span id="Symbiz">biz</span>             tya
CC2A: 9D 8F C0                     sta     <a href="#Syml7set">l7set</a>,X           ;Try storing the mode value
                   ; 
CC2D: 98           <span id="Symcareful">careful</span>         tya                       ;Get back the target value
CC2E: 5D 8E C0                     eor     <a href="#Syml7clr">l7clr</a>,X           ;Compare with observed value
CC31: 29 1F                        and     #$1F              ;Can only read low 5 bits
CC33: D0 F4                        bne     <a href="#Symbiz">biz</a>               ;If not right, back to try again
CC35: 60                           rts

                   ; 
                   ; Make sure you're in read mode and wait 'til Disk // motor is off
                   ; 
CC36: 20 97 CA     <span id="SymWaitIWMOff">WaitIWMOff</span>      jsr     <a href="#SymSetXN0">SetXN0</a>            ;Set X
CC39: BD 8E C0                     lda     <a href="#Syml7clr">l7clr</a>,X
CC3C: BD 8D C0                     lda     <a href="#Syml6set">l6set</a>,X
                   ; 
CC3F: BD 8E C0     <span id="Symwiwm1">wiwm1</span>           lda     <a href="#Syml7clr">l7clr</a>,X
CC42: 29 20                        and     #%00100000
CC44: D0 F9                        bne     <a href="#Symwiwm1">wiwm1</a>
CC46: BD 8C C0                     lda     <a href="#Syml6clr">l6clr</a>,X
                   ; 
                   ; Wait an additional 700 usec to allow 12V on Disk // to decay
                   ; 
CC49: 5A                           phy
CC4A: A0 8C                        ldy     #140
CC4C: 88           <span id="Symwiwm2">wiwm2</span>           dey
CC4D: D0 FD                        bne     <a href="#Symwiwm2">wiwm2</a>
CC4F: 7A                           ply
                   ; 
CC50: 60                           rts

                   ; 
                   ; This takes grp7ctr and oddbytes and calculates 7*grp7ctr+oddbytes.
                   ;   The results are in Y(hi) and A(low).  This is the number of bytes
                   ;   that were received in the last ReceivePack.
                   ; 
CC51: A5 4B        <span id="SymRcvcount">Rcvcount</span>        lda     <a href="#Symgrp7ctr">grp7ctr</a>
CC53: A8                           tay
CC54: A2 00                        ldx     #0
CC56: 86 4B                        stx     <a href="#Symgrp7ctr">grp7ctr</a>
CC58: A2 03                        ldx     #3
CC5A: 0A           <span id="Symtimes7">times7</span>          asl     A
CC5B: 26 4B                        rol     <a href="#Symgrp7ctr">grp7ctr</a>
CC5D: CA                           dex
CC5E: D0 FA                        bne     <a href="#Symtimes7">times7</a>
CC60: 18                           clc
CC61: 65 4C                        adc     <a href="#Symoddbytes">oddbytes</a>
CC63: 90 02                        bcc     <a href="#Symt71">t71</a>
CC65: E6 4B                        inc     <a href="#Symgrp7ctr">grp7ctr</a>
CC67: 84 4C        <span id="Symt71">t71</span>             sty     <a href="#Symoddbytes">oddbytes</a>
CC69: 38                           sec
CC6A: E5 4C                        sbc     <a href="#Symoddbytes">oddbytes</a>
CC6C: B0 02                        bcs     <a href="#Symt72">t72</a>
CC6E: C6 4B                        dec     <a href="#Symgrp7ctr">grp7ctr</a>
CC70: A4 4B        <span id="Symt72">t72</span>             ldy     <a href="#Symgrp7ctr">grp7ctr</a>
CC72: 60                           rts

                   NOTE: aka start25
                   ; 
CC73: A0 00        <span id="SymSlotDepRd">SlotDepRd</span>       ldy     #0
CC75: A5 4B                        lda     <a href="#Symgrp7ctr">grp7ctr</a>
CC77: 48                           pha                       ;Save groups of seven counter
CC78: D0 03                        bne     <a href="#Symstart35">start35</a>
CC7A: 4C 0A CD                     jmp     <a href="#Symdone5">done5</a>             ;Go get the checksum

                   ; Okay, get the groups of seven
                   ;   Start by getting the topbits for this group of seven
                   ; 
CC7D: AD EC C0     <span id="Symstart35">start35</span>         lda     <a href="#Syml6clr">l6clr</a>+96          ;l6clr+TheOff ;Get topbits
CC80: 10 FB                        bpl     <a href="#Symstart35">start35</a>
CC82: 85 59                        sta     &lt;<a href="#Symtemp">temp</a>+97          ;Just a second
                   ; Split up the seven bits into two indices for topbit tables
                   ; 
CC84: 4A                           lsr     A                 ;0   1  d1  d2  d3  d4  d5  d6
CC85: 4A                           lsr     A                 ;0   0   1  d1  d2  d3  d4  d5
CC86: 4A                           lsr     A                 ;0   0   0   1  d1  d2  d3  d4
CC87: 29 0F                        and     #%00001111        ;0   0   0   0  d1  d2  d3  d4
CC89: AA                           tax                       ;First index into the tables
CC8A: A5 59                        lda     &lt;<a href="#Symtemp">temp</a>+97          ;1  d1  d2  d3  d4  d5  d6  d7
CC8C: 29 07                        and     #%00000111        ;0   0   0   0   0  d5  d6  d7
CC8E: 85 59                        sta     &lt;<a href="#Symtemp">temp</a>+97          ;Keep for last three bytes
                   ; 
                   ; Read the 1st byte, reunite its msb, store and checksum it
                   ; 
CC90: AD EC C0     <span id="SymLCC90">LCC90</span>           lda     <a href="#Syml6clr">l6clr</a>+96          ;l6clr+TheOff
CC93: 10 FB                        bpl     <a href="#SymLCC90">LCC90</a>             ;Back 1 instruction
CC95: 5D 9A CA                     eor     <a href="#Symshift1">shift1</a>,X          ;Recombine the MSB with data
CC98: 91 56                        sta     (<a href="#Symbuffer2">buffer2</a>),Y       ;Store it away
CC9A: 45 40                        eor     <a href="#Symbushog">bushog</a>            ;Add it to the checksum
CC9C: 85 40                        sta     <a href="#Symbushog">bushog</a>
CC9E: C8                           iny
                   ; 
                   ;  Now, the second Y turn over occurs at this point in the
                   ;   loop.  Update teh buffer pointer if it occured.
                   ; 
CC9F: D0 02                        bne     <a href="#SymLCCA3">LCCA3</a>             ;*+4
CCA1: E6 57                        inc     <a href="#Symbuffer2">buffer2</a>+1
                   ; 
                   ; Now the second byte
                   ; 
CCA3: AD EC C0     <span id="SymLCCA3">LCCA3</span>           lda     <a href="#Syml6clr">l6clr</a>+96          ;l6clr+TheOff
CCA6: 10 FB                        bpl     <a href="#SymLCCA3">LCCA3</a>             ;Back 1 instruction
CCA8: 5D AA CA                     eor     <a href="#Symshift2">shift2</a>,X          ;Recombine the MSB with data
CCAB: 91 56                        sta     (<a href="#Symbuffer2">buffer2</a>),Y       ;Store it away
CCAD: 45 40                        eor     <a href="#Symbushog">bushog</a>            ;Add it to the checksum
CCAF: 85 40                        sta     <a href="#Symbushog">bushog</a>
CCB1: C8                           iny
                   ; 
                   ; Now the third byte
                   ; 
CCB2: AD EC C0     <span id="SymLCCB2">LCCB2</span>           lda     <a href="#Syml6clr">l6clr</a>+96          ;l6clr+TheOff
CCB5: 10 FB                        bpl     <a href="#SymLCCB2">LCCB2</a>             ;Back 1 Instruction
CCB7: 5D BA CA                     eor     <a href="#Symshift3">shift3</a>,X          ;Recombine the MSB with data
CCBA: 91 56                        sta     (<a href="#Symbuffer2">buffer2</a>),Y       ;Store it away
CCBC: 45 40                        eor     <a href="#Symbushog">bushog</a>            ;Add it to the checksum
CCBE: 85 40                        sta     <a href="#Symbushog">bushog</a>
CCC0: C8                           iny
                   ; 
                   ;  Now the fourth byte
                   ; 
CCC1: AD EC C0     <span id="SymLCCC1">LCCC1</span>           lda     <a href="#Syml6clr">l6clr</a>+96          ;l6clr+TheOff
CCC4: 10 FB                        bpl     <a href="#SymLCCC1">LCCC1</a>             ;Back 1 instruction
CCC6: 5D CA CA                     eor     <a href="#Symshift4">shift4</a>,X          ;Recombine the MSB with data
CCC9: 91 56                        sta     (<a href="#Symbuffer2">buffer2</a>),Y       ;Store it away
CCCB: 45 40                        eor     <a href="#Symbushog">bushog</a>            ;Add it to the checksum
CCCD: 85 40                        sta     <a href="#Symbushog">bushog</a>
CCCF: C8                           iny
                   ; 
                   ;  The first Y turn over occurs at this point in the loop.  Update
                   ;   the buffer poitner if it occured.
                   ; 
CCD0: D0 02                        bne     <a href="#SymLCCD4">LCCD4</a>             ;*+4
CCD2: E6 57                        inc     <a href="#Symbuffer2">buffer2</a>+1
                   ; 
CCD4: A6 59        <span id="SymLCCD4">LCCD4</span>           ldx     &lt;<a href="#Symtemp">temp</a>+97          ;Now we need the other index
                   ; 
                   ;  Now the fifth byte
                   ; 
CCD6: AD EC C0     <span id="SymLCCD6">LCCD6</span>           lda     <a href="#Syml6clr">l6clr</a>+96          ;l6clr+TheOff
CCD9: 10 FB                        bpl     <a href="#SymLCCD6">LCCD6</a>             ;Back 1 instruction
CCDB: 5D AA CA                     eor     <a href="#Symshift2">shift2</a>,X          ;Recombine the MSB with data
CCDE: 91 56                        sta     (<a href="#Symbuffer2">buffer2</a>),Y       ;Store it away
CCE0: 45 40                        eor     <a href="#Symbushog">bushog</a>            ;Add it to the checksum
CCE2: 85 40                        sta     <a href="#Symbushog">bushog</a>
CCE4: C8                           iny
                   ; 
                   ;  Now the sixth byte
                   ; 
CCE5: AD EC C0     <span id="SymLCCE5">LCCE5</span>           lda     <a href="#Syml6clr">l6clr</a>+96          ;l6clr+TheOff
CCE8: 10 FB                        bpl     <a href="#SymLCCE5">LCCE5</a>             ;Back 1 instruction
CCEA: 5D BA CA                     eor     <a href="#Symshift3">shift3</a>,X          ;Recombine the MSB with data
CCED: 91 56                        sta     (<a href="#Symbuffer2">buffer2</a>),Y       ;Store it away
CCEF: 45 40                        eor     <a href="#Symbushog">bushog</a>            ;Add it to the checksum
CCF1: 85 40                        sta     <a href="#Symbushog">bushog</a>
CCF3: C8                           iny
                   ; 
                   ;  And, finallly, the seventh byte
                   ; 
CCF4: AD EC C0     <span id="SymLCCF4">LCCF4</span>           lda     <a href="#Syml6clr">l6clr</a>+96          ;l6clr+TheOff
CCF7: 10 FB                        bpl     <a href="#SymLCCF4">LCCF4</a>             ;Back 1 instruction
CCF9: 5D CA CA                     eor     <a href="#Symshift4">shift4</a>,X          ;Recombine the MSB with data
CCFC: 91 56                        sta     (<a href="#Symbuffer2">buffer2</a>),Y       ;Store it away
CCFE: 45 40                        eor     <a href="#Symbushog">bushog</a>            ;Add it to the checksum
CD00: 85 40                        sta     <a href="#Symbushog">bushog</a>
CD02: C8                           iny
                   ; 
                   ;  Now see if this is the last group of seven to receive
                   ; 
CD03: C6 4B                        dec     <a href="#Symgrp7ctr">grp7ctr</a>
CD05: F0 03                        beq     <a href="#Symdone5">done5</a>             ;Go to get the checksum etc
CD07: 4C 7D CC                     jmp     <a href="#Symstart35">start35</a>           ;Another topbits ...

                   ; 
                   ;  Get and reconstruct the checksum
                   ; 
CD0A: AD EC C0     <span id="Symdone5">done5</span>           lda     <a href="#Syml6clr">l6clr</a>+96          ;l6clr+TheOff
CD0D: 10 FB                        bpl     <a href="#Symdone5">done5</a>             ;*-3
CD0F: 85 59                        sta     &lt;<a href="#Symtemp">temp</a>+97          ;1 c6 1 c4 1 c2 1 c0
                   ; 
CD11: 68                           pla                       ;Restore groups of 7 counter
CD12: 85 4B                        sta     <a href="#Symgrp7ctr">grp7ctr</a>
                   ; l6clr+TheOff
CD14: AD EC C0     <span id="SymLCD14">LCD14</span>           lda     <a href="#Syml6clr">l6clr</a>+96          ;1 c7 1 c5 1 c3 1 c1
CD17: 10 FB                        bpl     <a href="#SymLCD14">LCD14</a>             ;*-3
CD19: 38                           sec
CD1A: 2A                           rol     A                 ;c7 1 c5 1 c3 1 c1 1
CD1B: 25 59                        and     &lt;<a href="#Symtemp">temp</a>+97          ;c7 c6 c5 c4 c3 c2 c1 c0
CD1D: 45 40                        eor     <a href="#Symbushog">bushog</a>            ;When we're done, should be zero
                   ; 
                   ;  Get the packet end mark. Is it correct?
                   ; 
                   ; l6clr+TheOff
CD1F: AC EC C0     <span id="Symrdha5">rdha5</span>           ldy     <a href="#Syml6clr">l6clr</a>+96          ;Preserve A
CD22: 10 FB                        bpl     <a href="#Symrdha5">rdha5</a>
                   ; 
CD24: C0 C8                        cpy     #<a href="#Sympacketend">packetend</a>
CD26: D0 1C                        bne     <a href="#Symnpenderr5">npenderr5</a>
                   ; 
                   ;  Didn't have time before to checksum oddbytes.  Do it now
                   ;   A still has the partial checksum
                   ; 
CD28: A6 4C                        ldx     <a href="#Symoddbytes">oddbytes</a>
CD2A: F0 08                        beq     <a href="#Symicbt15">icbt15</a>
CD2C: A0 00                        ldy     #0
CD2E: 51 54        <span id="Symicbt5">icbt5</span>           eor     (<a href="#Symbuffer">buffer</a>),Y
CD30: C8                           iny
CD31: CA                           dex
CD32: D0 FA                        bne     <a href="#Symicbt5">icbt5</a>
                   ; 
                   ; Okay, checksum oughta be zero.  If not, checksum error.
                   ; 
CD34: AA           <span id="Symicbt15">icbt15</span>          tax
CD35: D0 11                        bne     <a href="#Symcserror5">cserror5</a>
                   ; 
                   ; Wait for /BSY to go low
                   ; 
CD37: AD ED C0     <span id="Symlstbsywait5">lstbsywait5</span>     lda     <a href="#Syml6clr">l6clr</a>+97          ;l6set+TheOff
CD3A: AD EE C0     <span id="Symrdh45">rdh45</span>           lda     <a href="#Syml7clr">l7clr</a>+96          ;l7clr+TheOff
CD3D: 30 FB                        bmi     <a href="#Symrdh45">rdh45</a>
                   ; 
                   ; Got the bytes, now acknowledge their receipt
                   ; 
                   ; reqclr+TheOff
CD3F: AD E0 C0                     lda     <a href="#Syml6clr">l6clr</a>+84          ;Lower REQ
                   ; 
CD42: 18                           clc
CD43: 60                           rts

CD44: A9 20        <span id="Symnpenderr5">npenderr5</span>       lda     #<a href="#Symnopackend">nopackend</a>
CD46: D0 02                        bne     <a href="#Symgserror5">gserror5</a>

CD48: A9 10        <span id="Symcserror5">cserror5</span>        lda     #<a href="#Symcsumerr">csumerr</a>
CD4A: 38           <span id="Symgserror5">gserror5</span>        sec
CD4B: 60                           rts

                   <span style="background-color: #89acb7">NOTE: C880 jumps to here</span>
                   <span style="background-color: #89acb7">This is the smart port / protocol converter code I care most about --James</span>
                   ; include pc.main
                   ; 
                   ; 
CD4C: 90 03        <span id="SymEntry">Entry</span>           bcc     <a href="#Symbentry">bentry</a>            ;If non-boot, skip jump to boot
CD4E: 4C 23 C5                     jmp     <a href="#SymLC523">LC523</a>

                   ; 
                   ; X is still set to slot number
                   ; 
CD51: A9 40        <span id="Symbentry">bentry</span>          lda     #%01000000
CD53: 1C 78 04                     trb     <a href="#SymProFLAG">ProFLAG</a>+5         ;ProFlag is fixed in //c
                   ; 
CD56: D8           <span id="Symatentry">atentry</span>         cld                       ;Don't want decimal mode!!
CD57: 8A                           txa
CD58: A8                           tay                       ;Really want it in Y... no ROR ABS,Y!
                   ; 
                   ; If this is a PC call, then get the address of the parm table
                   ; 
CD59: B9 73 04                     lda     <a href="#SymProFLAG">ProFLAG</a>,Y
CD5C: 30 11                        bmi     <a href="#Symnoplay">noplay</a>
                   ; 
CD5E: 68                           pla                       ;Get lo order
CD5F: 99 F3 05                     sta     <a href="#SymSHTempX">SHTempX</a>,Y         ;Keep lo parm address-1
CD62: 18                           clc
CD63: 69 03                        adc     #3
CD65: AA                           tax                       ;Lo order new return address
CD66: 68                           pla                       ;Get hi order address
CD67: 99 73 06                     sta     <a href="#SymSHTempY">SHTempY</a>,Y         ;Keep hi parm addr-1
CD6A: 69 00                        adc     #0
CD6C: 48                           pha                       ;Push back new return address hi
CD6D: 8A                           txa
CD6E: 48                           pha                       ;Push new return address lo
                   ; 
                   ; On the //c, it is important to have the Disk // enable lines
                   ;  off for as long as possible before using the IWM (phases,
                   ;  /WRREQ lines). Wait here 'til the Disk // motors are off.
                   ; 
CD6F: 20 36 CC     <span id="Symnoplay">noplay</span>          jsr     <a href="#SymWaitIWMOff">WaitIWMOff</a>        ;Must Preserve Y!!
                   ; 
                   ; We can't tolerate ints in most of the code, so disable
                   ; 
CD72: 08                           php                       ;Save interrupt status
CD73: 78                           sei                       ;No interrupts please
                   ; 
                   ; Preserve the zero page work area
                   ; 
CD74: A2 1B                        ldx     #<a href="#SymZPSize">ZPSize</a>-1
CD76: B5 40        <span id="Sympzp">pzp</span>             lda     <a href="#Symzeropage">zeropage</a>,X
CD78: 48                           pha
CD79: CA                           dex
CD7A: 10 FA                        bpl     <a href="#Sympzp">pzp</a>
                   ; 
                   ; Okay, we're safe... now it's all right to store in zero page
                   ; 
CD7C: 84 58                        sty     <a href="#SymSlot">Slot</a>
                   ; 
                   ; 
                   ; Now map any ProDOS unit references to our sequential ones.
                   ;  This method is bizzare and magicians never reveal their secrets.
                   ; 
CD7E: A5 43        <span id="Symallset">allset</span>          lda     <a href="#SymCMDUnit">CMDUnit</a>           ;76543210 7&amp;6 specify unit
CD80: 2A                           rol     A                 ;6543210X C&lt;-7
CD81: 08                           php                       ;Save drive num
CD82: 2A                           rol     A                 ;543210X7 C&lt;-6
CD83: 2A                           rol     A                 ;463210X76 (6 is grp of 2)
CD84: 28                           plp                       ;C&lt;-7
CD85: 2A                           rol     A                 ;3210X767
CD86: 29 03                        and     #%00000011        ;ProDOS only installs up to 4
CD88: 49 02                        eor     #%00000010        ;000000/67; 6 was /grpoftwo
CD8A: C0 04                        cpy     #4                ;If in slot 1,2,or3 reverse grps of two
CD8C: B0 02                        bcs     <a href="#Symallset1">allset1</a>
CD8E: 49 02                        eor     #%00000010
CD90: AA           <span id="Symallset1">allset1</span>         tax
CD91: E8                           inx
CD92: 86 43                        stx     <a href="#SymCMDUnit">CMDUnit</a>           ;You got it
                   ; 
                   ;  Now if this is through the MLI xface, gotta copy stuff into the
                   ;   send buffer from the parameter list.
                   ; 
CD94: B9 73 04                     lda     <a href="#SymProFLAG">ProFLAG</a>,Y
CD97: 10 03                        bpl     <a href="#Symdarnit">darnit</a>
CD99: 4C 40 CE                     jmp     <a href="#Symskipcopy">skipcopy</a>

                   ; 
                   ; Get the address of the in-line parameter table
                   ; 
CD9C: B9 F3 05     <span id="Symdarnit">darnit</span>          lda     <a href="#SymSHTempX">SHTempX</a>,Y         ;Get back the low part buff adr
                   NOTE: pg 522
CD9F: 85 54                        sta     <a href="#Symbuffer">buffer</a>
CDA1: B9 73 06                     lda     <a href="#SymSHTempY">SHTempY</a>,Y         ; and the hi part
CDA4: 85 55                        sta     <a href="#Symbuffer">buffer</a>+1
                   ; 
                   ; Now pull out the command code, and the address of the parameters.
                   ; 
CDA6: A0 01                        ldy     #1                ;Stacked address is EA-1
CDA8: B1 54                        lda     (<a href="#Symbuffer">buffer</a>),Y
CDAA: 85 42                        sta     <a href="#SymCMDCode">CMDCode</a>           ;Nice
CDAC: C8                           iny
CDAD: B1 54                        lda     (<a href="#Symbuffer">buffer</a>),Y        ;Get lo part of parmlist address
CDAF: AA                           tax                       ;Save it
CDB0: C8                           iny
CDB1: B1 54                        lda     (<a href="#Symbuffer">buffer</a>),Y        ;Get hi part
CDB3: 85 55                        sta     <a href="#Symbuffer">buffer</a>+1
CDB5: 86 54                        stx     <a href="#Symbuffer">buffer</a>
                   ; 
                   ; Now buffer points to parmlist
                   ;  Check command type, and pidgeonhole the parmlist length
                   ; 
CDB7: A9 01                        lda     #<a href="#SymBadCmd">BadCmd</a>
CDB9: A6 42                        ldx     <a href="#SymCMDCode">CMDCode</a>
CDBB: E0 0A                        cpx     #$0A              ;Only valid codes are 0-9
                   <span style="background-color: #cbcb00">NOTE: disassembly says blt not bcc</span>
CDBD: 90 03                        bcc     <a href="#Symnoeh">noeh</a>              ;=&gt; at least he got that right
CDBF: 4C 17 CF     <span id="SymErrorHitch">ErrorHitch</span>      jmp     <a href="#SymError">Error</a>             ;Gee, maybe we should promote this guy...

CDC2: A0 00        <span id="Symnoeh">noeh</span>            ldy     #0                ;Set for indct compare
CDC4: B1 54                        lda     (<a href="#Symbuffer">buffer</a>),Y        ;Get # of parms?
CDC6: 85 5A                        sta     <a href="#SymUnit">Unit</a>
                   ; 
                   ; Now copy the bytes
                   ; 
CDC8: A0 08        <span id="Symokaycnt">okaycnt</span>         ldy     #<a href="#Symcmdlength">cmdlength</a>-1      ;Always copy the maximum
CDCA: B1 54        <span id="Symcopyloop">copyloop</span>        lda     (<a href="#Symbuffer">buffer</a>),Y        ;Pull it out of their hat
CDCC: 99 42 00                     sta     <a href="#SymCMDCode">CMDCode</a>,Y         ;Stuff it into mine
CDCF: 88                           dey
CDD0: D0 F8                        bne     <a href="#Symcopyloop">copyloop</a>          ;Copy 'em all
                   ; 
                   ; Okay.  The caller of the PC could be making one of three calls
                   ;  with a unit number of $00, Control, Init or Status.  Check for
                   ;  these and do what is appropriate.
                   ; 
CDD2: A5 43                        lda     <a href="#SymCMDUnit">CMDUnit</a>
CDD4: D0 6A                        bne     <a href="#Symskipcopy">skipcopy</a>          ;Never mind
                   ; 
                   ; Check the parameter count for this call to unit#0
                   ; 
CDD6: A6 42                        ldx     <a href="#SymCMDCode">CMDCode</a>
CDD8: BD 8E CF                     lda     <a href="#Symparmctab">parmctab</a>,X        ;Get the length this command
CDDB: 29 7F                        and     #$7F              ;Force 0 -&gt; MSB
CDDD: A8                           tay                       ;Hang on
CDDE: A9 04                        lda     #<a href="#SymBadPCnt">BadPCnt</a>          ;Antic bad count
CDE0: C4 5A                        cpy     <a href="#SymUnit">Unit</a>              ;User's pcount is currently here
CDE2: D0 DB                        bne     <a href="#SymErrorHitch">ErrorHitch</a>        ;What a baby!
                   ; 
                   ; Now service one of the three commands
                   ; 
CDE4: E0 05                        cpx     #<a href="#SymInitCmd">InitCmd</a>
CDE6: D0 0A                        bne     <a href="#Symnotinit">notinit</a>           ;Not an Init call
CDE8: A9 00                        lda     #<a href="#SymPowerReset">PowerReset</a>       ;Just like powerup or reset key (//c)
CDEA: 20 98 CF                     jsr     <a href="#SymAssignID">AssignID</a>          ;Do a reset cycle
CDED: A9 00        <span id="SymAokay">Aokay</span>           lda     #0                ;No error allowed
CDEF: 4C 39 CF                     jmp     <a href="#Symsa2">sa2</a>

CDF2: 8A           <span id="Symnotinit">notinit</span>         txa                       ;Eqiv to 'cmp #StatusCMD'
CDF3: D0 24                        bne     <a href="#Symmaybectrl">maybectrl</a>
                   ; 
CDF5: A9 21                        lda     #<a href="#SymBadCtl">BadCtl</a>           ;Antic a non zero stat code
CDF7: A6 46                        ldx     <a href="#SymCMDSCode">CMDSCode</a>          ;Stat unit#0 can only be code=0
CDF9: D0 C4                        bne     <a href="#SymErrorHitch">ErrorHitch</a>
                   ; 
CDFB: 8A                           txa                       ;Equiv to `lda #0`
CDFC: A6 58                        ldx     <a href="#SymSlot">Slot</a>
CDFE: A0 07                        ldy     #7
CE00: 91 44        <span id="Symnin1">nin1</span>            sta     (<a href="#SymCMDBufferl">CMDBufferl</a>),Y    ;Clear some space
CE02: 88                           dey
CE03: D0 FB                        bne     <a href="#Symnin1">nin1</a>
CE05: BD F9 06                     lda     <a href="#SymNumDevices">NumDevices</a>,X
CE08: 91 44                        sta     (<a href="#SymCMDBufferl">CMDBufferl</a>),Y    ;Stick it where they want it
CE0A: C8                           iny
                   ; 
CE0B: AD F9 04                     lda     $04F9             ;//C Port 1 interrupt status
                   ; 
CE0E: 91 44                        sta     (<a href="#SymCMDBuffer">CMDBuffer</a>),Y
                   ; 
CE10: A9 08                        lda     #8
CE12: 88                           dey                       ;A,Y has 0008; # bytes status
CE13: 20 F0 CF                     jsr     <a href="#Symsquirrel">squirrel</a>
                   ; 
CE16: 4C ED CD                     jmp     <a href="#SymAokay">Aokay</a>             ;Skip down (up) with no error)

CE19: C9 04        <span id="Symmaybectrl">maybectrl</span>       cmp     #<a href="#SymControlCmd">ControlCmd</a>
CE1B: D0 0B                        bne     <a href="#SymBUnit">BUnit</a>             ;Unit #0 was a bad one
                   ; 
CE1D: A6 46                        ldx     <a href="#SymCMDSCode">CMDSCode</a>          ;We allow two control calls for Unit#0
CE1F: F0 0B                        beq     <a href="#Symenabint">enabint</a>           ;0 means enable interrupts
CE21: CA                           dex
CE22: F0 14                        beq     <a href="#Symdisabint">disabint</a>          ;1 means disable interrupts
CE24: A9 21                        lda     #<a href="#Symbadctl">badctl</a>
                   ; 
CE26: D0 97        <span id="SymErrorHitch2">ErrorHitch2</span>     bne     <a href="#SymErrorHitch">ErrorHitch</a>        ;No other codes allowed
CE28: A9 11        <span id="SymBUnit">BUnit</span>           lda     #<a href="#SymBadUnit">BadUnit</a>          ;Only certain calls can have Unit#0
CE2A: D0 93                        bne     <a href="#SymErrorHitch">ErrorHitch</a>        ;Branch always

                   ; 
CE2C: A9 C0        <span id="Symenabint">enabint</span>         lda     #$C0
CE2E: 8D F9 05                     sta     <a href="#Symextint2">extint2</a>
CE31: A9 0F                        lda     #$0F
CE33: 0C 9A C0                     tsb     $C09A
CE36: D0 05                        bne     <a href="#Symaokayhitch">aokayhitch</a>
                   ; 
CE38: A9 01        <span id="Symdisabint">disabint</span>        lda     #$01
CE3A: 1C 9A C0                     trb     $C09A
CE3D: 4C ED CD     <span id="Symaokayhitch">aokayhitch</span>      jmp     <a href="#SymAokay">Aokay</a>

                   ; 
                   ; Okay, everything's all groovy.  ProDOS re-enters here.
                   ;  Check Unit number to be sure there is a corresponding device
                   ; 
CE40: A9 28        <span id="Symskipcopy">skipcopy</span>        lda     #<a href="#SymNoDrive">NoDrive</a>          ;Anticpate bad unit number
CE42: A4 58                        ldy     <a href="#SymSlot">Slot</a>
CE44: BE F9 06                     ldx     <a href="#SymNumDevices">NumDevices</a>,Y
CE47: E4 43                        cpx     <a href="#SymCMDPcount">CMDPcount</a>
CE49: 90 DB                        bcc     <a href="#SymErrorHitch2">ErrorHitch2</a>       ;Safe- If C clr then Z is clr
                   ; 
                   ; Set buffer and bytecount in anticpation of the inevitable SendPack
                   ; 
CE4B: A9 09                        lda     #<a href="#Symcmdlength">cmdlength</a>
CE4D: 85 4D                        sta     <a href="#Symbytecountl">bytecountl</a>
CE4F: A9 00                        lda     #&gt;<a href="#Symcmdlength">cmdlength</a>
CE51: 85 4E                        sta     <a href="#Symbytecounth">bytecounth</a>
CE53: 85 55                        sta     <a href="#Symbuffer">buffer</a>+1
CE55: A9 42                        lda     #<a href="#SymCMDCode">CMDCode</a>
CE57: 85 54                        sta     <a href="#Symbuffer">buffer</a>
                   ; 
                   ; If it's a PC call, omit the next two steps
                   ; 
CE59: A6 58                        ldx     <a href="#SymSlot">Slot</a>
CE5B: BD 73 04                     lda     <a href="#SymProFLAG">ProFLAG</a>,X         ;Is it a call from ProDOS?
CE5E: 10 13                        bpl     <a href="#Symnotstat">notstat</a>           ;=&gt; Statcode already set...
                   ; 
                   ; Need to generate a paramter count for a ProDOS call
                   ; 
CE60: A6 42                        ldx     <a href="#SymCMDCode">CMDCode</a>
CE62: BD 8E CF                     lda     <a href="#Symparmctab">parmctab</a>,X
CE65: 29 7F                        and     #$7F
CE67: 85 5A                        sta     <a href="#SymUnit">Unit</a>
                   ; 
                   ; ProDOS always needs the highest blockno byte zeroed
                   ; 
CE69: A9 00                        lda     #0
CE6B: 85 48                        sta     <a href="#SymCMDBlocks">CMDBlocks</a>
                   ; 
                   ;  IF this is a ProDOS status call, set stat code to zero
                   ; 
CE6D: A5 42                        lda     <a href="#SymCMDCode">CMDCode</a>
CE6F: D0 02                        bne     <a href="#Symnotstat">notstat</a>           ;=&gt; Not status so forget it
                   ; lda #SCDeviceStat  ;A is already zero
CE71: 85 46                        sta     <a href="#SymCMDSCode">CMDSCode</a>          ;Store in command table
                   ; 
                   ; Okay, finally send over the damn command
                   ; 
CE73: A5 5A        <span id="Symnotstat">notstat</span>         lda     <a href="#SymUnit">Unit</a>
CE75: A6 43                        ldx     <a href="#SymCMDPcount">CMDPcount</a>         ;Swap the Parmcount &amp; unit#
CE77: 86 5A                        stx     <a href="#SymUnit">Unit</a>
CE79: 85 43                        sta     <a href="#SymCMDPcount">CMDPcount</a>         ;Now they're correct
                   ; 
CE7B: A9 80                        lda     #<a href="#Symcmdmark">cmdmark</a>
CE7D: 85 5B                        sta     <a href="#SymWpacketType">WpacketType</a>       ;WPacketType
                   ; 
CE7F: 20 87 CA                     jsr     <a href="#SymClrPhases">ClrPhases</a>         ;Bring all phases off for Quark
                   ; 
CE82: 20 E9 CA                     jsr     <a href="#SymSendPack">SendPack</a>
CE85: B0 46                        bcs     <a href="#Symbehitch">behitch</a>           ;If not okay, skip to bus error
                   ; 
                   ; Now copy over the buffer address for any data xfer
                   ; 
CE87: A5 44                        lda     <a href="#SymCMDBuffer">CMDBuffer</a>
CE89: 85 54                        sta     <a href="#Symbuffer">buffer</a>
CE8B: A5 45                        lda     <a href="#SymCMDBuffer">CMDBuffer</a>+1
CE8D: 85 55                        sta     <a href="#Symbuffer">buffer</a>+1
                   ; 
                   ; Now for some commands, we have to send over a packet of data, too.
                   ;  See if this command is one of THOSE.
                   ; 
CE8F: A6 42                        ldx     <a href="#SymCMDCode">CMDCode</a>
CE91: BD 8E CF                     lda     <a href="#Symparmctab">parmctab</a>,X
CE94: 10 3B                        bpl     <a href="#Symnoxtrasend">noxtrasend</a>        ;Encoded in top bit
                   ; 
                   ; The buffer address and bytecount depend on the call type.
                   ; 
CE96: E0 04                        cpx     #<a href="#SymControlCmd">ControlCmd</a>
CE98: D0 18                        bne     <a href="#SymNOControl">NOControl</a>
                   ; 
                   ; In the case of control, bytecount:=(buffer)
                   ; and buffer :=buffer+2
                   ; 
CE9A: A0 01                        ldy     #1
CE9C: B1 54                        lda     (<a href="#Symbuffer">buffer</a>),Y        ;Get Hi order bytecount
CE9E: AA                           tax
CE9F: 88                           dey
CEA0: B1 54                        lda     (<a href="#Symbuffer">buffer</a>),Y
CEA2: 48                           pha                       ;Keep for later
CEA3: 18                           clc
CEA4: A9 02                        lda     #2
CEA6: 65 54                        adc     <a href="#Symbuffer">buffer</a>
CEA8: 85 54                        sta     <a href="#Symbuffer">buffer</a>
CEAA: 68                           pla                       ;Get back Lo order bytecount
CEAB: 90 13                        bcc     <a href="#Symsecondsend">secondsend</a>        ;Skip hi ord increment
CEAD: E6 55                        inc     <a href="#Symbuffer">buffer</a>+1
CEAF: 4C C0 CE                     jmp     <a href="#Symsecondsend">secondsend</a>        ;Skip to store bytecount

CEB2: E0 02        <span id="SymNOControl">NOControl</span>       cpx     #<a href="#SymWriteCmd">WriteCmd</a>         ;Check for a writeblock
CEB4: D0 06                        bne     <a href="#SymNOWBlock">NOWBlock</a>          ;Must be control or write
                   ; 
                   ;  In the case of WriteBlock, the length is 512 and the buffer
                   ;   address is at buffer in the command table
                   ; 
CEB6: A9 00                        lda     #0
CEB8: A2 02                        ldx     #2
CEBA: D0 04                        bne     <a href="#Symsecondsend">secondsend</a>

                   ; 
                   ; For FileWrite, the buffer address is at CMDbuffer
                   ;  and the length is at CMDblock.
                   ; 
CEBC: A6 47        <span id="SymNOWBlock">NOWBlock</span>        ldx     <a href="#SymCMDBlockh">CMDBlockh</a>
CEBE: A5 46                        lda     <a href="#SymCMDBlockl">CMDBlockl</a>
                   ; 
CEC0: 86 4E        <span id="Symsecondsend">secondsend</span>      stx     <a href="#Symbytecounth">bytecounth</a>
CEC2: 85 4D                        sta     <a href="#Symbytecountl">bytecountl</a>
                   ; 
CEC4: A9 82                        lda     #<a href="#Symdatamark">datamark</a>
CEC6: 85 5B                        sta     <a href="#SymWpacketType">WpacketType</a>       ;Identify this as a data packet
                   ; 
CEC8: 20 DA CA                     jsr     <a href="#SymSendData">SendData</a>
CECB: 90 04                        bcc     <a href="#Symnoxtrasend">noxtrasend</a>
                   ; 
CECD: A9 06        <span id="Symbehitch">behitch</span>         lda     #<a href="#SymBusErr">BusErr</a>           ;This is a bus error hitch
CECF: D0 46                        bne     <a href="#SymError">Error</a>

                   ; 
                   ; On ProDOS status call, we've got to a point the buffer pointer
                   ;  correctly to zero page... it's the only case special case
                   ;  (on Write, Format and Control no data comes back).
                   ; 
CED1: A4 58        <span id="Symnoxtrasend">noxtrasend</span>      ldy     <a href="#SymSlot">Slot</a>
CED3: B9 73 04                     lda     <a href="#SymProFLAG">ProFLAG</a>,Y
CED6: 10 0C                        bpl     <a href="#Symgetresults">getresults</a>
CED8: A5 42                        lda     <a href="#SymCMDCode">CMDCode</a>
CEDA: D0 08                        bne     <a href="#Symgetresults">getresults</a>
                   ; 
CEDC: A9 45                        lda     #<a href="#SymCMDBufferh">CMDBufferh</a>       ;Want status in these four
CEDE: A2 00                        ldx     #&gt;<a href="#SymCMDBufferh">CMDBufferh</a>
CEE0: 85 54                        sta     <a href="#Symbuffer">buffer</a>
CEE2: 86 55                        stx     <a href="#Symbuffer">buffer</a>+1
                   ; 
                   ; Please to be calling ReceivePack
                   ; 
CEE4: 20 30 CB     <span id="Symgetresults">getresults</span>      jsr     <a href="#SymRecPack">RecPack</a>           ;Get status byte (maybe read data too)
CEE7: B0 E4                        bcs     <a href="#Symbehitch">behitch</a>
                   ; 
                   ; Figure out how many bytes were sent and put that in X,Y temps
                   ; 
CEE9: 20 51 CC                     jsr     <a href="#SymRcvcount">Rcvcount</a>          ;Do the time 7...
CEEC: 20 F0 CF                     jsr     <a href="#Symsquirrel">squirrel</a>          ;Store away count in SHTEMPs
                   ; 
                   ; For the ProDOS status call, we've got to look at the status byte
                   ;  returned and return a DIP error if appropriate. Also overwrite
                   ;  the X,Y temps with # blocks if this is a ProDOS Stat Call.
                   ; 
CEEF: A5 42                        lda     <a href="#SymCMDCode">CMDCode</a>           ;Is this a ProDOS status call
CEF1: D0 22                        bne     <a href="#Symnoerror">noerror</a>
CEF3: A6 58                        ldx     <a href="#SymSlot">Slot</a>
CEF5: BD 73 04                     lda     <a href="#SymProFLAG">ProFLAG</a>,X
CEF8: 10 1B                        bpl     <a href="#Symnoerror">noerror</a>
                   ; 
CEFA: A5 46                        lda     <a href="#SymCMDBlockl">CMDBlockl</a>         ;This'll get loaded into the XY regs later
CEFC: 9D F3 05                     sta     <a href="#SymSHTempX">SHTempX</a>,X
CEFF: A5 47                        lda     <a href="#SymCMDBlockh">CMDBlockh</a>
CF01: 9D 73 06                     sta     <a href="#SymSHTempY">SHTempY</a>,X
CF04: A5 45                        lda     <a href="#SymCMDBufferh">CMDBufferh</a>        ;Check status byte
CF06: 4A                           lsr     A
CF07: 4A                           lsr     A
CF08: 4A                           lsr     A
CF09: 90 04                        bcc     <a href="#SymChkOffLn">ChkOffLn</a>          ;no error, go check off line
CF0B: A9 2B                        lda     #<a href="#SymWriteProt">WriteProt</a>        ;else set WPROT error
CF0D: 80 08                        bra     <a href="#SymError">Error</a>

CF0F: 4A           <span id="SymChkOffLn">ChkOffLn</span>        lsr     A
CF10: 4A                           lsr     A
CF11: A9 2F                        lda     #<a href="#SymOffline">Offline</a>          ;Assume error
CF13: 90 02                        bcc     <a href="#SymError">Error</a>
                   ; 
                   ; Now it's time to think about returning to the caller
                   ;  Remember that ProDOS doesn't want to know about soft errors, 
                   ;  only fatal ones.  If this is a ProDOS call, and the soft error
                   ;  bit in the statbyte is set, there IS NO error (statbyte is 
                   ;  cleared). Also, ProDOS wants only, I/O, Write Protect, No Device,
                   ;  Offline.  If any other hard error comes from the device
                   ;  on a ProDOS call, map it to an I/O Error. (Gross me out.)
                   ; 
CF15: A5 4D        <span id="Symnoerror">noerror</span>         lda     <a href="#Symstatbyte">statbyte</a>
                   ; 
CF17: A4 58        <span id="SymError">Error</span>           ldy     <a href="#SymSlot">Slot</a>              ;Need access to screenholes
CF19: 99 F3 04                     sta     <a href="#SymRetry">Retry</a>,Y           ;Keep unadulterated error in shole
CF1C: AA                           tax                       ;set the Z flag
CF1D: F0 1A                        beq     <a href="#Symsa2">sa2</a>               ;Special case the zero
CF1F: BE 73 04                     ldx     <a href="#SymProFLAG">ProFLAG</a>,Y         ;Set N to ProDOS call or not
CF22: 10 15                        bpl     <a href="#Symsa2">sa2</a>               ;If PC call, no mapping occurs
CF24: A2 00                        ldx     #0                ;Assume a soft error
CF26: C9 40                        cmp     #%01000000        ;Soft Error Check
                   NOTE: listing has 0xB0 as bge
CF28: B0 0E                        bcs     <a href="#Symstoreaway">storeaway</a>         ;If $40 or bigger, map to zero
                   ; 
CF2A: A2 27                        ldx     #<a href="#SymIOError">IOError</a>          ;Now anticipate ProDOS I/O error
CF2C: C9 2B                        cmp     #<a href="#SymWriteProt">WriteProt</a>
CF2E: F0 09                        beq     <a href="#Symsa2">sa2</a>               ;OK to return Write Protect
CF30: C9 28                        cmp     #<a href="#SymNoDrive">NoDrive</a>
CF32: F0 05                        beq     <a href="#Symsa2">sa2</a>               ;OK to return Drive disconnected
CF34: C9 2F                        cmp     #<a href="#SymOffline">Offline</a>
CF36: F0 01                        beq     <a href="#Symsa2">sa2</a>
                   ; 
CF38: 8A           <span id="Symstoreaway">storeaway</span>       txa                       ;Use the default value
                   ; 
CF39: A4 58        <span id="Symsa2">sa2</span>             ldy     <a href="#SymSlot">Slot</a>
CF3B: 99 73 05                     sta     <a href="#SymSHTemp1">SHTemp1</a>,Y         ;Keep in screenhole
                   ; If this is the //c version, we need to reset the IWN to its
                   ;  former disk // state.  This is done by setting the mode register
                   ;  to a little known (and less documented) mode which speeds up the 
                   ;  internal motor timeout.  When the motor enable has timed out, the
                   ;  mode can be set back to zero.  This method is necessary because
                   ;  if the timer is enabled within the timeout period, the motor on a 
                   ;  Rev A IWM pops on for the full timeout period (since mode changes
                   ;  are disabled when the motor is on.  It's bizzare. Blame Mac.
CF3E: AD E8 C0                     lda     <a href="#Symmonclr">monclr</a>+96         ;Motor Off
CF41: 2C ED C0                     bit     <a href="#Syml6set">l6set</a>+96          ;Into mode reg access mode
CF44: A9 2B                        lda     #$2B              ;This is the magic "speed up" value
CF46: 8D EF C0                     sta     <a href="#Syml7set">l7set</a>+96          ;Throw into mode register
CF49: EA                           nop                       ;You're supposed to wait a while
CF4A: EA                           nop
CF4B: EA                           nop
CF4C: EA                           nop
                   ; 
CF4D: AD EE C0     <span id="Symwaitoff">waitoff</span>         lda     <a href="#Syml7clr">l7clr</a>+96          ;Wait 'til motor off
CF50: 29 20                        and     #$20
CF52: D0 F9                        bne     <a href="#Symwaitoff">waitoff</a>
CF54: A0 00                        ldy     #0                ;Now set the reg back to $00
CF56: A2 60                        ldx     #$60              ;IWM's in slot 6
CF58: 20 20 CC                     jsr     <a href="#SymSetIWMode">SetIWMode</a>
CF5B: AD EC C0                     lda     <a href="#Syml6clr">l6clr</a>+96
CF5E: AD E2 C0                     lda     <a href="#Symca1clr">ca1clr</a>+96
CF61: AD E6 C0                     lda     <a href="#Symlstrbclr">lstrbclr</a>+96
CF64: A4 58                        ldy     <a href="#SymSlot">Slot</a>              ;Need Slot in Y
                   ; 
                   ;  Now, restore our zero page area.
                   ; 
CF66: A2 00                        ldx     #0
CF68: 68           <span id="Symrzp">rzp</span>             pla
CF69: 95 40                        sta     <a href="#Symzeropage">zeropage</a>,X
CF6B: E8                           inx
CF6C: E0 1C                        cpx     #<a href="#SymZPSize">ZPSize</a>
                   NOTE: blt in listing
CF6E: 90 F8                        bcc     <a href="#Symrzp">rzp</a>
                   ; 
                   ;  We're into the stretch!  Restore interrupt mask, load X, Y,
                   ;    and A and set the carry if the error byte is non-zero.
                   ; 
CF70: 28                           plp                       ;Restore interrupt flag
CF71: B9 F3 05                     lda     <a href="#SymSHTempX">SHTempX</a>,Y         ;Get X value
CF74: AA                           tax
CF75: B9 73 05                     lda     <a href="#SymSHTemp1">SHTemp1</a>,Y         ;Grab the error result code
CF78: 48                           pha
CF79: B9 73 06                     lda     <a href="#SymSHTempY">SHTempY</a>,Y         ;Pull out the Y value
CF7C: A8                           tay                       ;No more access to screenholes
CF7D: 18                           clc                       ;Anticipate zero result code
CF7E: 68                           pla                       ;Pull back result code
CF7F: F0 01                        beq     <a href="#Symfinalskip">finalskip</a>         ;Return with carry clear
CF81: 38                           sec                       ;Some type of error
                   ; 
CF82: 08           <span id="Symfinalskip">finalskip</span>       php                       ;Save carry and Z flag
CF83: 2C 78 04                     bit     <a href="#SymProFLAG">ProFLAG</a>+5         ;Ick - ProFlag is fixed in //c
CF86: 70 04                        bvs     <a href="#Symick1">ick1</a>              ;If bit 6=1, then return to alt ROM
CF88: 28                           plp                       ;Vclr so return across ROM bank bdy
CF89: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

CF8C: 28           <span id="Symick1">ick1</span>            plp
CF8D: 60                           rts                       ;Flags set correctly again

CF8E: 03           <span id="Symparmctab">parmctab</span>        DFB     %00000011         ;Status:  3 parms/no data send
CF8F: 03                           DFB     %00000011         ;Read:    3 parms/no data send
CF90: 83                           DFB     %10000011         ;Write:   3 parms/data send
CF91: 01                           DFB     %00000001         ;Format:  1 parm /no data send
CF92: 83                           DFB     %10000011         ;Control: 3 parms/data send
CF93: 01                           DFB     %00000001         ;Init:    1 parm /no data send
CF94: 01                           DFB     %00000001         ;Open:    1 parm /no data send
CF95: 01                           DFB     %00000001         ;Close:   1 parm /no data send
CF96: 03                           DFB     %00000011         ;CharRead: 3 parms/data send
CF97: 83                           DFB     %10000011         ;CharWrite: 3 parms/data send

CF98: 48           <span id="SymAssignID">AssignID</span>        pha                       ;Save the init code
CF99: 20 5D CA                     jsr     <a href="#Symresetchain">resetchain</a>        ;Reset all of those things
CF9C: 68                           pla
CF9D: AA                           tax                       ;Save InitCode
                   ; 
                   ;  Save the command code, unit, and init code
                   ;  'cause we'll trample 'em:
CF9E: A5 42                        lda     <a href="#SymCMDCode">CMDCode</a>
CFA0: 48                           pha
CFA1: A5 43                        lda     <a href="#SymCMDPcount">CMDPcount</a>
CFA3: 48                           pha
CFA4: A5 46                        lda     <a href="#SymCMDSCode">CMDSCode</a>
CFA6: 48                           pha
CFA7: 86 46                        stx     <a href="#SymCMDSCode">CMDSCode</a>          ;Store away the type of INIt
                   ; 
                   ;  Set up to send DefID command packets
                   ; 
CFA9: A9 05                        lda     #<a href="#SymInitCmd">InitCmd</a>
CFAB: 85 42                        sta     <a href="#SymCMDCode">CMDCode</a>
CFAD: A9 00                        lda     #0
CFAF: 85 5A                        sta     <a href="#SymUnit">Unit</a>
CFB1: A9 02                        lda     #2                ;# parms in Init Call
CFB3: 85 43                        sta     <a href="#SymCMDPcount">CMDPcount</a>
                   ; 
                   ;  Point the buffer pointer
                   ; 
CFB5: A9 42                        lda     #<a href="#SymCMDCode">CMDCode</a>
CFB7: 85 54                        sta     <a href="#Symbuffer">buffer</a>
CFB9: A9 00                        lda     #&gt;<a href="#SymCMDCode">CMDCode</a>
CFBB: 85 55                        sta     <a href="#Symbuffer">buffer</a>+1
CFBD: A9 80                        lda     #<a href="#Symcmdmark">cmdmark</a>
CFBF: 85 5B                        sta     <a href="#SymWpacketType">WpacketType</a>
                   NOTE: Odo agrees
CFC1: 20 87 CA                     jsr     <a href="#SymClrPhases">ClrPhases</a>         ;Make sure phases are off for Quark
                   ; 
                   ;  Send an ID for the next device in the chain
                   ; 
CFC4: E6 5A        <span id="Symmordevices">mordevices</span>      inc     <a href="#SymUnit">Unit</a>
CFC6: A9 09                        lda     #<a href="#Symcmdlength">cmdlength</a>
CFC8: 85 4D                        sta     <a href="#Symbytecountl">bytecountl</a>        ;ReceivePack scrambles count
CFCA: A9 00                        lda     #&gt;<a href="#Symcmdlength">cmdlength</a>
CFCC: 85 4E                        sta     <a href="#Symbytecounth">bytecounth</a>
                   ; 
CFCE: 20 83 C8                     jsr     <a href="#SymSendOnePack">SendOnePack</a>       ;Send the command
CFD1: 90 05                        bcc     <a href="#Symmdev2">mdev2</a>             ;If okay, skip to get response
                   ; 
CFD3: C6 5A                        dec     <a href="#SymUnit">Unit</a>
CFD5: 4C DF CF                     jmp     <a href="#Symmdev1">mdev1</a>

CFD8: 20 E3 C9     <span id="Symmdev2">mdev2</span>           jsr     <a href="#SymReceivePack">ReceivePack</a>       ;Get the response
CFDB: A5 4D                        lda     <a href="#Symbytecount">bytecount</a>
CFDD: F0 E5                        beq     <a href="#Symmordevices">mordevices</a>
                   ; 
                   ;  Okay, we done last device.  Squirrel away the number of devices.
                   ; 
CFDF: A5 5A        <span id="Symmdev1">mdev1</span>           lda     <a href="#SymUnit">Unit</a>
CFE1: A4 58                        ldy     <a href="#SymSlot">Slot</a>
CFE3: 99 F9 06                     sta     <a href="#SymNumDevices">NumDevices</a>,Y      ;Devices out there
                   ; 
                   ;  Recover the scrambled ProDOS parms
                   ; 
CFE6: 68                           pla
CFE7: 85 46                        sta     <a href="#SymCMDSCode">CMDSCode</a>
CFE9: 68                           pla
CFEA: 85 43                        sta     <a href="#SymCMDPcount">CMDPcount</a>
CFEC: 68                           pla
CFED: 85 42                        sta     <a href="#SymCMDCode">CMDCode</a>
                   ; 
CFEF: 60                           rts

CFF0: A6 58        <span id="Symsquirrel">squirrel</span>        ldx     <a href="#SymSlot">Slot</a>
CFF2: 9D F3 05                     sta     <a href="#SymSHTempX">SHTempX</a>,X
CFF5: 98                           tya
CFF6: 9D 73 06                     sta     <a href="#SymSHTempY">SHTempY</a>,X
CFF9: 60                           rts

CFFA: 00 00 00 00+                 DS      6,$00

                   NOTE: Command processor for serial &amp; comm
                   pdf pg 486
                   ********************************************************************************
                   * The command routine now supports 5 new 2-character commands.  These          *
                   * commands enable or disable af eature of the serial port and                  *
                   * are derived from their equivalent in the super serial card for the //.       *
                   *                                                                              *
                   * The new commands are as follows:                                             *
                   *   L - send LF out after CR                                                   *
                   *   X - detect XOFF, and wait for XON                                          *
                   *   F - accept keyboard input                                                  *
                   *   M - ignore LF in after CR                                                  *
                   *   C - auto CR when column count &gt; printer width                              *
                   *                                                                              *
                   * Usage of location $779 (port 1) and $77A (port 2) are as follows:            *
                   *   bit 7 - echo output to screen if on                                        *
                   *   bit 6 - generate LF after CR if on                                         *
                   *   bit 5 - accept XOFF if on                                                  *
                   *   bit 4 - ignore keyboard input if on                                        *
                   *   bit 3 - accept LF in after CR if on                                        *
                   *   bit 2 - a character was received through the ACIA and is in                *
                   *      location $5FE (port 1) or $67E (port 2) if on                           *
                   *   bit 1 - XOFF is accepted, awaiting XON if on                               *
                   *   bit 0 - signifies comm port if on, printer port if off                     *
                   ********************************************************************************
D000: 48           <span id="Symcommand">command</span>         pha                       ;shove character on stack
D001: 3C B8 03                     bit     <a href="#Symsermode">sermode</a>,X         ;Already in command?
D004: 30 1C                        bmi     <a href="#Symincmd">incmd</a>             ;If so, go do it
D006: BC 38 06                     ldy     <a href="#Symeschar">eschar</a>,X          ;If eschar = 0 ignore commands
D009: F0 14                        beq     <a href="#Symnocmd">nocmd</a>
D00B: 5D 38 06                     eor     <a href="#Symeschar">eschar</a>,X          ;Is it the command char?
D00E: 0A                           asl     A                 ;Ignore high bit
D00F: D0 0E                        bne     <a href="#Symnocmd">nocmd</a>             ;char not command char
D011: AC FB 07     <span id="Symcommand1">command1</span>        ldy     <a href="#Symcursor">cursor</a>            ;Save the cursor
D014: 8C 79 06                     sty     <a href="#Symoldcur">oldcur</a>
D017: A0 BF                        ldy     #<a href="#Symcmdcur">cmdcur</a>           ;Set command cursor
D019: 8C FB 07                     sty     <a href="#Symcursor">cursor</a>
D01C: 4C B5 D0                     jmp     <a href="#Symcominit1">cominit1</a>          ;initiate command mode

D01F: 38           <span id="Symnocmd">nocmd</span>           sec                       ;Mark char not handled
D020: 68           <span id="Symnocmd2">nocmd2</span>          pla                       ;Restore original char
D021: 60                           rts

D022: BC 42 C1     <span id="Symincmd">incmd</span>           ldy     <a href="#Symdevno2">devno2</a>,X          ;Get index for ACIA
D025: 29 5F                        and     #$5F              ;no hi-bit and upshift lower case
D027: 48                           pha                       ;save character
D028: BD B8 03                     lda     <a href="#Symsermode">sermode</a>,X         ;need to see if in 2-chr command
D02B: 89 08                        bit     #$08              ;bit 3 set if so
D02D: D0 03                        bne     <a href="#Symincmd2">incmd2</a>            ;branch if so
D02F: 68                           pla                       ;pull char back, not in 2-chr cmd
D030: 80 52                        bra     <a href="#Symincmd1">incmd1</a>            ;go on with regular command mode

                   ; handle 2nd chr of 2-char commands
D032: 68           <span id="Symincmd2">incmd2</span>          pla                       ;pull char off stack
D033: 48                           pha                       ; &amp; reshove it to keep stack neat
D034: C9 00                        cmp     #<a href="#Symucspace">ucspace</a>          ;is it a space? (uppercased)
D036: D0 04                        bne     <a href="#Symincmd3">incmd3</a>            ;no, go on with 2-chr cmd handling
D038: 18                           clc                       ;yes, ignore spaces between characters
                   ;                                        of 2-chr commands
D039: 68                           pla                       ;pull uppercased char off stack
D03A: 80 E4                        bra     <a href="#Symnocmd2">nocmd2</a>            ;ie mark them "handled" and don't do anything else

D03C: BD B8 03     <span id="Symincmd3">incmd3</span>          lda     <a href="#Symsermode">sermode</a>,X         ;get sermode back
D03F: 48                           pha                       ;save sermode for a minit
D040: 29 07                        and     #7                ;throw out all but bits 0-2
D042: 8D F8 06                     sta     <a href="#Symtemp">temp</a>              ;save - this is index of which cmd it is
D045: 68                           pla                       ;get sermode back
D046: 29 F0                        and     #$F0              ;now clear bits 0-3
D048: 9D B8 03                     sta     <a href="#Symsermode">sermode</a>,X         ;since we're done with them now
D04B: 68                           pla                       ;get character back
D04C: DA                           phx                       ;shove x (Cn) on stack
D04D: AE F8 06                     ldx     <a href="#Symtemp">temp</a>              ;get index to command's 1st chr
D050: C9 45                        cmp     #$45              ;is it an E?
D052: F0 71                        beq     <a href="#Symenable">enable</a>            ;yes
D054: C9 44                        cmp     #$44              ;no, is it a D?
D056: F0 6F                        beq     <a href="#Symdisable">disable</a>           ;yes
D058: FA                           plx                       ;retriefve X=Cn (old X still in temp)
D059: DA                           phx                       ;push it back to keep stack neat
D05A: DD 38 06                     cmp     <a href="#Symeschar">eschar</a>,X          ;compare to the command character
D05D: 08                           php                       ;save result of comparison for a bit
D05E: AE F8 06                     ldx     <a href="#Symtemp">temp</a>              ;reload X= index to cmd's first chr
D061: 28                           plp                       ;retrieve result of comparison of char
                   ;                                        to command char
D062: F0 13                        beq     <a href="#Symflagit">flagit</a>            ;yes tis 1-chr cmd followed by nother cmd
D064: C9 0D                        cmp     #<a href="#SymcharCR">charCR</a>           ;is it a (guess what) CR?
D066: F0 17                        beq     <a href="#Symoneletter">oneletter</a>         ;yes - a 1-chr command
                   ; 
                   ; come here for unimplemented byt legal 2-char commands
                   ; 
D068: FA           <span id="Symcmd2null">cmd2null</span>        plx                       ;pull x (Cn) off stack
D069: AD 79 06                     lda     <a href="#Symoldcur">oldcur</a>            ;restore non-cmd-mode cursor
D06C: 8D FB 07                     sta     <a href="#Symcursor">cursor</a>
D06F: 1E B8 03                     asl     <a href="#Symsermode">sermode</a>,X         ;clear cmd-mode bit (bit 7 of sermode)
D072: 5E B8 03                     lsr     <a href="#Symsermode">sermode</a>,X         ;by shifting out bit 7 &amp; shifting in a 0
D075: 80 A8                        bra     <a href="#Symnocmd">nocmd</a>             ;return marking character not handled

                   ;                                       ;come here if eschar after LXFM or T
D077: FA           <span id="Symflagit">flagit</span>          plx                       ;next X=Cn to set bit 0 of sermode
D078: DA                           phx                       ;but leave Cn on stack too
D079: FE B8 03                     inc     <a href="#Symsermode">sermode</a>,X         ;bit 0 was 0, but is now 1
                   ;                                        1 means new command mode
D07C: AE F8 06                     ldx     <a href="#Symtemp">temp</a>              ;X= index to cmd's first chr
                   ;                                       ;come here if 2-chr cmd turns out 1 chr
D07F: BD 25 D2     <span id="Symoneletter">oneletter</span>       lda     <a href="#Symcmd2list">cmd2list</a>,X        ;get command chr
D082: 80 0B                        bra     <a href="#Symbackto1">backto1</a>           ;treat it as if we jot got it

                   ;                                       ;in command mode, not 2-chrs tho
D084: DA           <span id="Symincmd1">incmd1</span>          phx                       ;Save slot
D085: A2 04                        ldx     #4                ;check 5 possible 5-chr cmds
D087: DD 25 D2     <span id="Symcmd2loop">cmd2loop</span>        cmp     <a href="#Symcmd2list">cmd2list</a>,X        ;is it there?
D08A: F0 71                        beq     <a href="#Symcmd2found">cmd2found</a>         ;yes, need to flag it for next time
D08C: CA                           dex                       ;nope
D08D: 10 F8                        bpl     <a href="#Symcmd2loop">cmd2loop</a>          ;try next if there is one
                   ;                                       ;come here to check for 1-chr cmds
D08F: A2 0C        <span id="Symbackto1">backto1</span>         ldx     #12               ;Check 13 commands
D091: DD 18 D2     <span id="Symcmdloop">cmdloop</span>         cmp     <a href="#Symcmdlist">cmdlist</a>,X
D094: F0 74                        beq     <a href="#Symcmfound">cmfound</a>           ;Right char?
D096: CA                           dex
D097: 10 F8                        bpl     <a href="#Symcmdloop">cmdloop</a>
D099: FA                           plx                       ;We didn't find it
D09A: 68                           pla
D09B: 48                           pha
D09C: 29 7F                        and     #$7F              ;if char is cntl char
D09E: C9 20                        cmp     #$20              ;it can be the new comd char
D0A0: B0 03                        bcs     <a href="#Symckdig">ckdig</a>             ;branch if not cntrl character
D0A2: 9D 38 06     <span id="Symcmdz2">cmdz2</span>           sta     <a href="#Symeschar">eschar</a>,X          ;save command char and
                   ;                                        drop thur ckdig to cdone
D0A5: 49 30        <span id="Symckdig">ckdig</span>           eor     #$30              ;zap it down to 0n if char was a digit
D0A7: C9 0A                        cmp     #$0A              ;is it a digit?
D0A9: B0 33                        bcs     <a href="#Symcdone">cdone</a>             ;skip if no, an unexpected intruder
D0AB: A0 0A                        ldy     #10               ;A = A + 10 * current number
D0AD: 6D 7E 07     <span id="Symdigloop">digloop</span>         adc     <a href="#Symnumber">number</a>            ;C=0 on first entry
D0B0: 88                           dey
D0B1: D0 FA                        bne     <a href="#Symdigloop">digloop</a>
D0B3: 80 0A                        bra     <a href="#Symcominit">cominit</a>           ;not starting new cmd mode, just save #

                   ;                                       ;start new cmd mode here
D0B5: BD B8 03     <span id="Symcominit1">cominit1</span>        lda     <a href="#Symsermode">sermode</a>,X         ;get sermode
D0B8: 29 C0                        and     #$C0              ;clear bits 0-5 (starting a new cmd seq--
D0BA: 9D B8 03                     sta     <a href="#Symsermode">sermode</a>,X         ;they are used for misc during cmd mode)
D0BD: A9 00                        lda     #0                ;load a 0 to stuff in NUMBER
D0BF: 8D 7E 07     <span id="Symcominit">cominit</span>         sta     <a href="#Symnumber">number</a>
D0C2: 38                           sec                       ;Mark in command mode
D0C3: 80 25                        bra     <a href="#Symcmset">cmset</a>

                   ;                                       ;got a 2-chr command aE
D0C5: 38           <span id="Symenable">enable</span>          sec                       ;set charry
D0C6: 90                           DFB     $90               ;bcc to skip next byte (the CLC)
                   ;                                       ;got a 2-chr command aD
D0C7: 18           <span id="Symdisable">disable</span>         clc                       ;clear carry
D0C8: 08                           php                       ;push P to save carry
D0C9: E0 00                        cpx     #0                ;if X=0 then command is LE or LD
D0CB: F0 27                        beq     <a href="#Symcmd21">cmd21</a>             ;so just make it act like L or K
D0CD: E0 04                        cpx     #4                ;if X=4 then command is CE or CD
D0CF: F0 41                        beq     <a href="#Symcmd_c">cmd_c</a>             ;skip if so
                   ********************************************************************************
                   * for other 2-chr cmds, their FLAGS masks' indexes are 2X+3                    *
                   * for an E or 2X+4 for a D                                                     *
                   ********************************************************************************
D0D1: 8A                           txa                       ;copy x to acc for arithmetic
D0D2: 18                           clc                       ;clear carry for arithmetic
D0D3: 0A                           asl     A                 ;multiply index by 2
D0D4: 69 03                        adc     #3                ;add 3 to get mask index
D0D6: AA                           tax                       ;put mask index in X
D0D7: 28                           plp                       ;get carry back
D0D8: B0 01                        bcs     <a href="#Symxready">xready</a>            ;carry set = Enable so X is ready
D0DA: E8                           inx                       ;cmd was Disable so inc X to next mask
D0DB: 4C 39 D1     <span id="Symxready">xready</span>          jmp     <a href="#Symcmdi">cmdi</a>              ;go do mask stuff to FLAGS

                   ; ;$D0DE: ;sermode bit 0 tells whether to set or clear command mode
D0DE: BD B8 03     <span id="Symcdone">cdone</span>           lda     <a href="#Symsermode">sermode</a>,X         ;so get it
D0E1: 4A                           lsr     A                 ;shift bit 0 to carry
D0E2: B0 D1                        bcs     <a href="#Symcominit1">cominit1</a>          ;if set, start new cmd mode
D0E4: AD 79 06                     lda     <a href="#Symoldcur">oldcur</a>            ;Restore the cursor
D0E7: 8D FB 07                     sta     <a href="#Symcursor">cursor</a>            ;&amp; fall through to cmset with carry clear
D0EA: 08           <span id="Symcmset">cmset</span>           php
D0EB: 1E B8 03                     asl     <a href="#Symsermode">sermode</a>,X         ;set command mode according to carry
D0EE: 28                           plp
D0EF: 7E B8 03                     ror     <a href="#Symsermode">sermode</a>,X         ;leaves carry clear
D0F2: 68                           pla                       ;character handled
D0F3: 60                           rts                       ;because carry clear...

                   ;                                       ;come here to handle LE &amp; LD
D0F4: A9 4C        <span id="Symcmd21">cmd21</span>           lda     #$4C              ;make LE look like L
D0F6: 28                           plp                       ;get P back with carry indicating E or D
D0F7: B0 96                        bcs     <a href="#Symbackto1">backto1</a>           ;carry set means it was an E
D0F9: A9 4B                        lda     #$4B              ;make LD look like X
D0FB: 80 92                        bra     <a href="#Symbackto1">backto1</a>

D0FD: 8A           <span id="Symcmd2found">cmd2found</span>       txa                       ;copy index of cmd to acc
D0FE: FA                           plx                       ;restore X to Cn
D0FF: 1D B8 03                     ora     <a href="#Symsermode">sermode</a>,X         ;copy top 2 bits of sermode
D102: 09 08                        ora     #$08              ;&amp; set bit 3 - 2-chr-command-mode flag
D104: 9D B8 03                     sta     <a href="#Symsermode">sermode</a>,X         ;sermode = index to 2-chr cmds issued
D107: 38                           sec                       ;set carry so we stay in command mode
D108: 80 E0                        bra     <a href="#Symcmset">cmset</a>             ;for next time

D10A: A9 D1        <span id="Symcmfound">cmfound</span>         lda     #&gt;<a href="#Symcmdcr">cmdcr</a>           ;get hi byte of where to go
D10C: 48                           pha                       ;save it on stack
D10D: BD F5 D1                     lda     <a href="#Symcmdtable">cmdtable</a>,X        ;get lo byte of where to go
D110: 48                           pha                       ;save it on stack
D111: 60                           rts                       ;go there by RTSing

D112: 28           <span id="Symcmd_c">cmd_c</span>           plp                       ;restore status to check carry bit
D113: FA                           plx                       ;restore slot number in x
D114: B0 05                        bcs     <a href="#Symcmd_cl">cmd_cl</a>            ;skip if enable
D116: 9E B8 04                     stz     <a href="#Sympwdth">pwdth</a>,X           ;CD is same as PWDTH=0, no CR
D119: 80 C3                        bra     <a href="#Symcdone">cdone</a>             ;we're done here

                   ; defidx2-$C1
D11B: BC 86 D1     <span id="Symcmd_cl">cmd_cl</span>          ldy     <a href="#SymLD186">LD186</a>,X           ;get y index into aux screenholes
D11E: 20 2A D2                     jsr     <a href="#Symr_getalt">r_getalt</a>          ;go get it from aux
D121: 9D B8 04                     sta     <a href="#Sympwdth">pwdth</a>,X           ;restore default PWDTH
D124: 80 B8                        bra     <a href="#Symcdone">cdone</a>             ;we're done here

D126: FA           <span id="Symcmdz">cmdz</span>            plx                       ;Zero escape character
D127: 9E B8 04                     stz     <a href="#Sympwdth">pwdth</a>,X           ;And the width
D12A: A9 00                        lda     #0
D12C: 4C A2 D0                     jmp     <a href="#Symcmdz2">cmdz2</a>

                   NOTE: pickup
                   pick up from here
                   pdf page 488 (123)
                   ; cmdcr equ D12F
                   ; cmdn  equ D12F
D12F: 7A                           DFB     $7A
D130: AD                           DFB     $AD
D131: 7E                           DFB     $7E
D132: 07                           DFB     $07
D133: F0                           DFB     $F0
D134: 05                           DFB     $05
D135: 99                           DFB     $99
D136: B8                           DFB     $B8
D137: 04                           DFB     $04
D138: F0                           DFB     $F0

                   ; cmdi equ D139
                   ; cmdk equ D139
                   ; cmkl equ D139
D139: 7A           <span id="Symcmdi">cmdi</span>            ply
D13A: B9 B8 06     <span id="Symcmdi2">cmdi2</span>           lda     <a href="#Symflags">flags</a>,Y
D13D: 3D 02 D2                     and     <a href="#SymLD202">LD202</a>,X
D140: 1D 0D D2                     ora     <a href="#SymLD20D">LD20D</a>,X
D143: 99 B8 06                     sta     <a href="#Symflags">flags</a>,Y
D146: 98                           tya
D147: AA                           tax
D148: 4C DE D0     <span id="Symcdone2">cdone2</span>          jmp     <a href="#Symcdone">cdone</a>

D14B: 88           <span id="Symcmdp">cmdp</span>            dey
D14C: A9 1F        <span id="Symcmdd">cmdd</span>            lda     #$1F
D14E: 38                           sec
D14F: 90                           DFB     $90
D150: A9 F0        <span id="Symcmdb">cmdb</span>            lda     #$F0
D152: 18                           clc
D153: 39 FB BF                     and     <a href="#Symscntl">scntl</a>,Y
D156: 8D F8 06                     sta     <a href="#Symtemp">temp</a>
D159: FA                           plx
D15A: AD 7E 07                     lda     <a href="#Symnumber">number</a>
D15D: 29 0F                        and     #$0F
D15F: 90 05                        bcc     <a href="#Symnoshift">noshift</a>

D161: 0A 0A 0A 0A+                 ASC     $0A,$0A,$0A,$0A,$0A

D166: 0D F8 06     <span id="Symnoshift">noshift</span>         ora     <a href="#Symtemp">temp</a>
D169: C8                           iny
D16A: 80 17                        bra     <a href="#Symcmdp2">cmdp2</a>

D16C: B9 FA BF     <span id="Symcmds">cmds</span>            lda     <a href="#Symscomd">scomd</a>,Y
D16F: 48                           pha
D170: 09 0C                        ora     #$0C
D172: 99 FA BF                     sta     <a href="#Symscomd">scomd</a>,Y
D175: A9 E9                        lda     #$E9
D177: A2 53        <span id="Symmswait">mswait</span>          ldx     #$53
D179: 48           <span id="Symmsloop">msloop</span>          pha
D17A: 68                           pla
D17B: CA                           dex
D17C: D0 FB                        bne     <a href="#Symmsloop">msloop</a>
D17E: 3A                           dec     A
D17F: D0 F6                        bne     <a href="#Symmswait">mswait</a>
D181: 68                           pla
D182: FA                           plx
D183: 99 FA BF     <span id="Symcmdp2">cmdp2</span>           sta     <a href="#Symscomd">scomd</a>,Y
D186: 80 C0        <span id="SymLD186">LD186</span>           bra     <a href="#Symcdone2">cdone2</a>

D188: 99 F9 BF     <span id="Symcmdr">cmdr</span>            sta     <a href="#Symsstat">sstat</a>,Y
D18B: AD 7B 06                     lda     <a href="#Symtrser">trser</a>-1
D18E: 0A                           asl     A
D18F: 20 97 C7                     jsr     <a href="#SymLC797">LC797</a>
D192: 90 03                        bcc     <a href="#Symcmdq">cmdq</a>
D194: 20 9D C7                     jsr     <a href="#SymLC79D">LC79D</a>
D197: 18           <span id="Symcmdq">cmdq</span>            clc
D198: B0                           DFB     $B0
D199: 38           <span id="Symcmdt">cmdt</span>            sec
D19A: FA                           plx
D19B: 20 A0 D1                     jsr     <a href="#Symsetterm">setterm</a>
D19E: 80 A8                        bra     <a href="#Symcdone2">cdone2</a>

D1A0: BD B8 03     <span id="Symsetterm">setterm</span>         lda     $03B8,X
D1A3: 89 40                        bit     #$40
D1A5: 90 12                        bcc     <a href="#Symstclr">stclr</a>
D1A7: D0 20                        bne     <a href="#Symstwasok">stwasok</a>
D1A9: E4 39                        cpx     $39
D1AB: D0 47                        bne     <a href="#Symstrts">strts</a>
D1AD: 09 40                        ora     #$40
D1AF: AC 79 06                     ldy     <a href="#Symoldcur">oldcur</a>
D1B2: 8C 7A 06                     sty     <a href="#Symoldcur2">oldcur2</a>
D1B5: A0 DF                        ldy     #$DF
D1B7: 80 07                        bra     <a href="#Symstset">stset</a>

D1B9: F0 0E        <span id="Symstclr">stclr</span>           beq     <a href="#Symstwasok">stwasok</a>
D1BB: 29 BF                        and     #$BF
D1BD: AC 7A 06                     ldy     <a href="#Symoldcur2">oldcur2</a>
D1C0: 9D B8 03     <span id="Symstset">stset</span>           sta     $03B8,X
D1C3: 8C 79 06                     sty     <a href="#Symoldcur">oldcur</a>
D1C6: 8C FB 07                     sty     <a href="#Symcursor">cursor</a>
D1C9: BC 42 C1     <span id="Symstwasok">stwasok</span>         ldy     <a href="#SymLC141">LC141</a>+1,X
D1CC: 58                           cli
D1CD: 08                           php
D1CE: 78                           sei
D1CF: B9 FA BF                     lda     <a href="#Symscomd">scomd</a>,Y
D1D2: 09 02                        ora     #$02
D1D4: 90 02                        bcc     <a href="#Symcmdt2">cmdt2</a>
D1D6: 29 FD                        and     #$FD
D1D8: 99 FA BF     <span id="Symcmdt2">cmdt2</span>           sta     <a href="#Symscomd">scomd</a>,Y
D1DB: A9 00                        lda     #$00
D1DD: 6A                           ror     A
D1DE: 8D FA 05                     sta     <a href="#Symtyphed">typhed</a>
D1E1: 10 07                        bpl     <a href="#Symcmdt3">cmdt3</a>
D1E3: 9C 7C 05                     stz     <a href="#Symtwser">twser</a>
D1E6: 9C 7C 06                     stz     <a href="#Symtrser">trser</a>
D1E9: 8A                           txa
D1EA: 8D FC 04     <span id="Symcmdt3">cmdt3</span>           sta     <a href="#Symaciabuf">aciabuf</a>
D1ED: 28                           plp
D1EE: 8E FC 05     <span id="Symflush">flush</span>           stx     <a href="#Symtwkey">twkey</a>
D1F1: 8E FF 06                     stx     <a href="#Symtrkey">trkey</a>
D1F4: 60           <span id="Symstrts">strts</span>           rts

D1F5: 38           <span id="Symcmdtable">cmdtable</span>        DFB     $38
D1F6: 38                           DFB     $38
D1F7: 38                           DFB     $38
D1F8: 2E                           DFB     $2E
D1F9: 2E                           DFB     $2E
D1FA: 4F                           DFB     $4F
D1FB: 4B                           DFB     $4B
D1FC: 4A                           DFB     $4A
D1FD: 96                           DFB     $96
D1FE: 87                           DFB     $87
D1FF: 6B                           DFB     $6B
D200: 98                           DFB     $98
D201: 25                           DFB     $25
D202: 7F BF BF 7F+ <span id="SymLD202">LD202</span>           HEX     $7F,$BF,$BF,$7F,$FF,$DF,$DF,$EF
                                    +      $EF,$F7,$F7
D20D: 80 00 40 00+ <span id="SymLD20D">LD20D</span>           HEX     $80,$00,$40,$00,$00,$20,$00,$00
                                    +      $10,$00,$08
D218: 49 4B 4C 4E  <span id="Symcmdlist">cmdlist</span>         ASC     ‘IKLN’
D21C: 0D                           DFB     $0D
D21D: 42 44 50 51+                 ASC     ‘BDPQRSTZ’
D225: 4C 58 46 4D+ <span id="Symcmd2list">cmd2list</span>        ASC     ‘LXFMC’

D22A: AD 13 C0     <span id="Symr_getalt">r_getalt</span>        lda     <a href="#SymLC000">LC000</a>+19
D22D: 0A                           asl     A
D22E: AD 18 C0                     lda     <a href="#Symvblint">vblint</a>-1
D231: 08                           php
D232: 8D 00 C0                     sta     <a href="#SymLC000">LC000</a>
D235: 8D 03 C0                     sta     <a href="#SymLC000">LC000</a>+3
D238: B9 78 04                     lda     <a href="#Symnumbanks">numbanks</a>,Y
D23B: 28                           plp
D23C: B0 03                        bcs     <a href="#SymLD241">LD241</a>
D23E: 8D 02 C0                     sta     <a href="#SymLC000">LC000</a>+2
D241: 10 03        <span id="SymLD241">LD241</span>           bpl     <a href="#SymLD246">LD246</a>
D243: 8D 01 C0                     sta     <a href="#SymLC000">LC000</a>+1
D246: 60           <span id="SymLD246">LD246</span>           rts

D247: 03                           DFB     $03
D248: 07                           DFB     $07
D249: 00 00 00 00+                 DS      439,$00

                   ********************************************************************************
                   * BASICIN - input from basic                                                   *
                   *                                                                              *
                   * creates +XXXXX,+YYYYY,+SS                                                    *
                   * XXXXX = x position, YYYYY = y position, SS = status                          *
                   *       - = key pressed                                                        *
                   *       1 = button pressed                                                     *
                   *       2 = button just pressed                                                *
                   *       3 = button just released                                               *
                   *       4 = button not pressed                                                 *
                   ********************************************************************************
D400: 91 28        <span id="Symbasicin">basicin</span>         sta     (<a href="#SymNoDrive">NoDrive</a>),Y
D402: A9 05                        lda     #$05
D404: 85 38                        sta     $38
D406: AD 00 C0                     lda     <a href="#SymLC000">LC000</a>
D409: 0A                           asl     A
D40A: 08                           php
D40B: 78                           sei
D40C: 20 79 D6                     jsr     <a href="#SymLD679">LD679</a>
D40F: A0 05                        ldy     #$05
D411: AE 7F 05                     ldx     $057F
D414: AD 7F 04                     lda     $047F
D417: 20 41 D4                     jsr     <a href="#Symhextodec">hextodec</a>
D41A: A0 0C                        ldy     #$0C
D41C: AE FF 05                     ldx     $05FF
D41F: AD FF 04                     lda     $04FF
D422: 20 41 D4                     jsr     <a href="#Symhextodec">hextodec</a>
D425: AD 7F 07                     lda     $077F
D428: 2A                           rol     A
D429: 2A                           rol     A
D42A: 2A                           rol     A
D42B: 29 03                        and     #$03
D42D: 49 03                        eor     #$03
D42F: 1A                           inc     A
D430: 28                           plp
D431: A0 10                        ldy     #$10
D433: 20 52 D4                     jsr     <a href="#Symhexdec2">hexdec2</a>
D436: 7A                           ply
D437: A2 11                        ldx     #$11
D439: A9 8D                        lda     #$8D
D43B: 9D 00 02     <span id="Symputinbuf">putinbuf</span>        sta     $0200,X
D43E: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

                   ********************************************************************************
                   * HEXTODEC - puts +0000, into the input buffer                                 *
                   * inputs: a = low byte of number                                               *
                   *         x = high byte of number                                              *
                   *         y = positions of one digit                                           *
                   ********************************************************************************
D441: E0 80        <span id="Symhextodec">hextodec</span>        cpx     #$80
D443: 90 0D                        bcc     <a href="#Symhexdec2">hexdec2</a>
D445: 49 FF                        eor     #$FF
D447: 69 00                        adc     #$00
D449: 48                           pha
D44A: 8A                           txa
D44B: 49 FF                        eor     #$FF
D44D: 69 00                        adc     #$00
D44F: AA                           tax
D450: 68                           pla
D451: 38                           sec
D452: 8D 14 02     <span id="Symhexdec2">hexdec2</span>         sta     $0214
D455: 8E 15 02                     stx     $0215
D458: A9 2B                        lda     #$2B
D45A: 90 02                        bcc     <a href="#Symhdpos2">hdpos2</a>
D45C: A9 2D                        lda     #$2D
D45E: 48           <span id="Symhdpos2">hdpos2</span>          pha
D45F: A9 2C                        lda     #$2C
D461: 99 01 02                     sta     $0201,Y
                   ; divide BINH,L by 10 and leave remainder in a
D464: A2 11        <span id="Symhdloop">hdloop</span>          ldx     #$11
D466: A9 00                        lda     #$00
D468: 18                           clc
D469: 2A           <span id="Symdv10loop">dv10loop</span>        rol     A
D46A: C9 0A                        cmp     #$0A
D46C: 90 02                        bcc     <a href="#Symdv10lt">dv10lt</a>
D46E: E9 0A                        sbc     #$0A
D470: 2E 14 02     <span id="Symdv10lt">dv10lt</span>          rol     $0214
D473: 2E 15 02                     rol     $0215
D476: CA                           dex
D477: D0 F0                        bne     <a href="#Symdv10loop">dv10loop</a>
D479: 09 30                        ora     #$30
D47B: 99 00 02                     sta     $0200,Y
D47E: 88                           dey
D47F: F0 08                        beq     <a href="#Symhddone">hddone</a>
D481: C0 07                        cpy     #$07
D483: F0 04                        beq     <a href="#Symhddone">hddone</a>
D485: C0 0E                        cpy     #$0E
D487: D0 DB                        bne     <a href="#Symhdloop">hdloop</a>
D489: 68           <span id="Symhddone">hddone</span>          pla
D48A: 99 00 02                     sta     $0200,Y
D48D: 60                           rts

                   ********************************************************************************
                   * These routines test all 128K ram.  All combinations of                       *
                   * switches applicable to the //c are tested and verified.                      *
                   *                                                                              *
                   * In the event of any failure, the diagnostic is halted. A message             *
                   * is written to screen memory indicating the source of the failure.            *
                   * When RAM fails the message is composed of "RAM ZP" (indicating               *
                   * failure detected in the first page of RAM) or "RAM" (meaning the             *
                   * other 63.75K), followed by a binary representation of the failing            *
                   * bits set to "1".  For example, "RAM   0 1 1 0 0 0 0 0" indicates             *
                   * that bits 5 and 6 were detected as failing. To represent                     *
                   * auxillary memory, a "*" symbol is printed preceeding the message.            *
                   *                                                                              *
                   * When the MMU or IOU fail, the message is simply "MMU" or "IOU".              *
                   * If the IOUDIS or DHIRES switch fails, the message is "GLU."                  *
                   *                                                                              *
                   * The test will run continiuously for as long as the Open and Closed           *
                   * Apple keys remain depressed (or no keyboard is connected) and no             *
                   * failures are encountered.  The message "System OK" will appear in            *
                   * the middle of the screen when a successful cycle has been run and            *
                   * either of the Apple keys are no longer depressed.  Another cycle             *
                   * may be initiated by pressing both Apple keys again while this                *
                   * message is on the screen.  To exit diagnostics, Control-Reset                *
                   * must be pressed without the Apple keys depressed.                            *
                   ********************************************************************************
D48E: 8D 50 C0     <span id="Symdiags">diags</span>           sta     <a href="#Symvblint">vblint</a>+55
D491: 8D 78 C0                     sta     <a href="#Symmoubut">moubut</a>+21
D494: 8D 5F C0                     sta     <a href="#Symiou_p_2">iou_p_2</a>+5
D497: A0 04        <span id="SymLD497">LD497</span>           ldy     #$04
D499: A2 00                        ldx     #$00
D49B: 18           <span id="SymLD49B">LD49B</span>           clc
D49C: 79 2A C8                     adc     <a href="#Symglcdone">glcdone</a>+1,Y
D49F: 95 00                        sta     <a href="#Symloc0">loc0</a>,X
D4A1: E8                           inx
D4A2: D0 F7                        bne     <a href="#SymLD49B">LD49B</a>
D4A4: 18           <span id="SymLD4A4">LD4A4</span>           clc
D4A5: 79 2A C8                     adc     <a href="#Symglcdone">glcdone</a>+1,Y
D4A8: D5 00                        cmp     <a href="#Symloc0">loc0</a>,X
D4AA: D0 10                        bne     <a href="#SymLD4BC">LD4BC</a>
D4AC: E8                           inx
D4AD: D0 F5                        bne     <a href="#SymLD4A4">LD4A4</a>
D4AF: 6A                           ror     A
D4B0: 2C 19 C0                     bit     <a href="#Symvblint">vblint</a>
D4B3: 10 02                        bpl     <a href="#SymLD4B7">LD4B7</a>
D4B5: 49 A5                        eor     #$A5
D4B7: 88           <span id="SymLD4B7">LD4B7</span>           dey
D4B8: 10 E1                        bpl     <a href="#SymLD49B">LD49B</a>
D4BA: 30 06                        bmi     <a href="#SymLD4C2">LD4C2</a>

D4BC: 55 00        <span id="SymLD4BC">LD4BC</span>           eor     <a href="#Symloc0">loc0</a>,X
D4BE: 18                           clc
D4BF: 4C 73 C4                     jmp     <a href="#SymLC473">LC473</a>

D4C2: 4C C6 C3     <span id="SymLD4C2">LD4C2</span>           jmp     <a href="#SymTSTMEM">TSTMEM</a>

D4C5: 20                           DFB     $20
D4C6: 9D                           DFB     $9D
D4C7: C7                           DFB     $C7
D4C8: 68                           DFB     $68
D4C9: 7A                           DFB     $7A
D4CA: 68                           DFB     $68
D4CB: A9                           DFB     $A9
D4CC: FF                           DFB     $FF
D4CD: AA                           DFB     $AA
D4CE: E8                           DFB     $E8
D4CF: 5D                           DFB     $5D
D4D0: DA                           DFB     $DA
D4D1: D4                           DFB     $D4
D4D2: 9D                           DFB     $9D
D4D3: 00                           DFB     $00
D4D4: 02                           DFB     $02
D4D5: 10                           DFB     $10
D4D6: F7                           DFB     $F7
D4D7: 4C                           DFB     $4C
D4D8: 84                           DFB     $84
D4D9: C7                           DFB     $C7
D4DA: AD                           DFB     $AD
D4DB: 3B                           DFB     $3B
D4DC: 0A                           DFB     $0A
D4DD: 0B                           DFB     $0B
D4DE: 48                           DFB     $48
D4DF: 77                           DFB     $77
D4E0: 3E                           DFB     $3E
D4E1: 05                           DFB     $05
D4E2: 00                           DFB     $00
D4E3: 05                           DFB     $05
D4E4: 08                           DFB     $08
D4E5: 0C                           DFB     $0C
D4E6: 1E                           DFB     $1E
D4E7: 53                           DFB     $53
D4E8: 65                           DFB     $65
D4E9: 37                           DFB     $37
D4EA: 1C                           DFB     $1C
D4EB: 07                           DFB     $07
D4EC: 0C                           DFB     $0C
D4ED: 45                           DFB     $45
D4EE: 62                           DFB     $62
D4EF: 27                           DFB     $27
D4F0: 00                           DFB     $00
D4F1: 17                           DFB     $17
D4F2: 1C                           DFB     $1C
D4F3: 07                           DFB     $07
D4F4: 07                           DFB     $07
D4F5: 05                           DFB     $05
D4F6: 4B                           DFB     $4B
D4F7: 6D                           DFB     $6D
D4F8: 24                           DFB     $24
D4F9: 02                           DFB     $02
D4FA: 0E                           DFB     $0E
D4FB: 45                           DFB     $45
D4FC: 61                           DFB     $61
D4FD: 32                           DFB     $32
D4FE: 18                           DFB     $18
D4FF: 02                           DFB     $02
D500: 07                           DFB     $07
D501: 1D                           DFB     $1D
D502: 53                           DFB     $53
D503: 6A                           DFB     $6A
D504: 2B                           DFB     $2B
D505: 0C                           DFB     $0C
D506: 08                           DFB     $08
D507: 16                           DFB     $16
D508: 53                           DFB     $53
D509: 68                           DFB     $68
D50A: 3D                           DFB     $3D
D50B: 06                           DFB     $06
D50C: 07                           DFB     $07
D50D: 1B                           DFB     $1B
D50E: 01                           DFB     $01
D50F: E3                           DFB     $E3
D510: 00 00 00 00+                 DS      240,$00

                   ********************************************************************************
                   * Initmouse - reset the  mouse                                                 *
                   *  Also clears all of the mouse holes                                          *
                   * note that ious access fires pdlstrb &amp; makes mouse happy                      *
                   ********************************************************************************
D600: 9C 7F 07     <span id="Symi_nitmouse">i_nitmouse</span>      stz     $077F
D603: A2 80                        ldx     #$80
D605: A0 01                        ldy     #$01
D607: 9E 7D 04     <span id="Symxrloop">xrloop</span>          stz     $047D,X
D60A: 9E 7D 05                     stz     $057D,X
D60D: A9 FF                        lda     #$FF
D60F: 9D 7D 06                     sta     $067D,X
D612: A9 03                        lda     #$03
D614: 9D 7D 07                     sta     <a href="#Symnumber">number</a>-1,X
D617: A2 00                        ldx     #$00
D619: 88                           dey
D61A: 10 EB                        bpl     <a href="#Symxrloop">xrloop</a>
D61C: 20 51 D6                     jsr     <a href="#SymLD651">LD651</a>
D61F: A9 00                        lda     #$00
                   ********************************************************************************
                   * XSETMOU - Sets the mouse code to A                                           *
                   ********************************************************************************
D621: AA           <span id="Symx_setmou">x_setmou</span>        tax
D622: 20 46 C7                     jsr     <a href="#SymLC746">LC746</a>
D625: 8A                           txa
D626: 8D 78 04                     sta     <a href="#Symnumbanks">numbanks</a>
D629: 4A                           lsr     A
D62A: 0D 78 04                     ora     <a href="#Symnumbanks">numbanks</a>
D62D: C9 10                        cmp     #$10
D62F: B0 1F                        bcs     <a href="#SymLD650">LD650</a>
D631: 29 05                        and     #$05
D633: F0 01                        beq     <a href="#Symxsoff">xsoff</a>
D635: 58                           cli
D636: 69 55        <span id="Symxsoff">xsoff</span>           adc     #$55
D638: 08           <span id="Symsetiou">setiou</span>          php
D639: 78                           sei
D63A: 8E FF 07                     stx     <a href="#Symthbuf">thbuf</a>-1
D63D: 8D 79 C0                     sta     <a href="#Symmoubut">moubut</a>+22
D640: A2 08                        ldx     #$08
D642: CA           <span id="SymLD642">LD642</span>           dex
D643: 0A                           asl     A
D644: 90 03                        bcc     <a href="#SymLD649">LD649</a>
D646: 9D 58 C0                     sta     <a href="#Symvblint">vblint</a>+63,X
D649: D0 F7        <span id="SymLD649">LD649</span>           bne     <a href="#SymLD642">LD642</a>
D64B: 8D 78 C0                     sta     <a href="#Symmoubut">moubut</a>+21
D64E: 28                           plp
D64F: 18                           clc
D650: 60           <span id="SymLD650">LD650</span>           rts

D651: A2 80        <span id="SymLD651">LD651</span>           ldx     #$80
D653: 80 02                        bra     <a href="#SymLD657">LD657</a>

D655: A2 00        <span id="SymLD655">LD655</span>           ldx     #$00
D657: BD 7D 04     <span id="SymLD657">LD657</span>           lda     $047D,X
D65A: 9D 7F 04                     sta     $047F,X
D65D: BD 7D 05                     lda     $057D,X
D660: 9D 7F 05                     sta     $057F,X
D663: CA                           dex
D664: 10 EF                        bpl     <a href="#SymLD655">LD655</a>
D666: 80 0C                        bra     <a href="#SymLD674">LD674</a>

D668: 9C                           DFB     $9C
D669: 7F                           DFB     $7F
D66A: 04                           DFB     $04
D66B: 9C                           DFB     $9C
D66C: 7F                           DFB     $7F
D66D: 05                           DFB     $05
D66E: 9C                           DFB     $9C
D66F: FF                           DFB     $FF
D670: 04                           DFB     $04
D671: 9C                           DFB     $9C
D672: FF                           DFB     $FF
D673: 05                           DFB     $05

D674: 9C 7F 06     <span id="SymLD674">LD674</span>           stz     $067F
D677: 18                           clc
D678: 60                           rts

D679: A9 20        <span id="SymLD679">LD679</span>           lda     #$20
D67B: 1C 7F 07                     trb     $077F
D67E: 2D 7F 06                     and     $067F
D681: 1C 7F 06                     trb     $067F
D684: 2C FF 07                     bit     <a href="#Symthbuf">thbuf</a>-1
D687: 30 13                        bmi     <a href="#SymLD69C">LD69C</a>
D689: 2C 63 C0                     bit     <a href="#Symmoubut">moubut</a>
D68C: 30 02                        bmi     <a href="#SymLD690">LD690</a>
D68E: 09 80                        ora     #$80
D690: 2C 7F 07     <span id="SymLD690">LD690</span>           bit     $077F
D693: 10 02                        bpl     <a href="#SymLD697">LD697</a>
D695: 09 40                        ora     #$40
D697: 8D 7F 07     <span id="SymLD697">LD697</span>           sta     $077F
D69A: 18                           clc
D69B: 60                           rts

D69C: 0D 7F 07     <span id="SymLD69C">LD69C</span>           ora     $077F
D69F: 29 E0                        and     #$E0
D6A1: 80 F4                        bra     <a href="#SymLD697">LD697</a>

D6A3: 6A                           DFB     $6A
D6A4: 6A                           DFB     $6A
D6A5: 29                           DFB     $29
D6A6: 80                           DFB     $80
D6A7: AA                           DFB     $AA
D6A8: AD                           DFB     $AD
D6A9: 78                           DFB     $78
D6AA: 04                           DFB     $04
D6AB: 9D                           DFB     $9D
D6AC: 7D                           DFB     $7D
D6AD: 04                           DFB     $04
D6AE: AD                           DFB     $AD
D6AF: 78                           DFB     $78
D6B0: 05                           DFB     $05
D6B1: 9D                           DFB     $9D
D6B2: 7D                           DFB     $7D
D6B3: 05                           DFB     $05
D6B4: AD                           DFB     $AD
D6B5: F8                           DFB     $F8
D6B6: 04                           DFB     $04
D6B7: 9D                           DFB     $9D
D6B8: 7D                           DFB     $7D
D6B9: 06                           DFB     $06
D6BA: AD                           DFB     $AD
D6BB: F8                           DFB     $F8
D6BC: 05                           DFB     $05
D6BD: 9D                           DFB     $9D
D6BE: 7D                           DFB     $7D
D6BF: 07                           DFB     $07
D6C0: 18                           DFB     $18
D6C1: 60                           DFB     $60
D6C2: 48                           DFB     $48
D6C3: 18                           DFB     $18
D6C4: A9                           DFB     $A9
D6C5: 0E                           DFB     $0E
D6C6: 2D                           DFB     $2D
D6C7: 7F                           DFB     $7F
D6C8: 07                           DFB     $07
D6C9: D0                           DFB     $D0
D6CA: 01                           DFB     $01
D6CB: 38                           DFB     $38
D6CC: 68                           DFB     $68
D6CD: 60                           DFB     $60
D6CE: 00 00 00 00+                 DS      306,$00

                   ; execution routines. these routines must begin in the same page
                   ; 
                   ; EXECUTE - does command in command
                   ;           inputs: a = command
D800: 85 42        <span id="Symexecute">execute</span>         sta     <a href="#SymCMDCode">CMDCode</a>
D802: A0 C4                        ldy     #$C4
D804: 8C F8 07                     sty     <a href="#SymMSlot">MSlot</a>
D807: A2 C8                        ldx     #$C8
D809: 8E 78 07                     stx     <a href="#SymSvBcH">SvBcH</a>
D80C: A9 00                        lda     #$00
D80E: 8D F8 04                     sta     <a href="#Symerror">error</a>
D811: 20 D3 D9                     jsr     <a href="#Symsl_format">sl_format</a>
D814: A4 42                        ldy     <a href="#SymCMDCode">CMDCode</a>
D816: B9 80 C6                     lda     <a href="#SymLC680">LC680</a>,Y
D819: 30 04                        bmi     <a href="#Symexec2">exec2</a>
D81B: C5 43                        cmp     <a href="#SymCMDPcount">CMDPcount</a>
D81D: D0 15                        bne     <a href="#SymLD834">LD834</a>
D81F: A9 D8        <span id="Symexec2">exec2</span>           lda     #$D8
D821: 80 01                        bra     <a href="#Symexec3">exec3</a>

D823: 00                           DFB     $00

D824: 48           <span id="Symexec3">exec3</span>           pha
D825: B9 9A C6                     lda     <a href="#SymLC69A">LC69A</a>,Y
D828: 48                           pha
D829: AC F8 07                     ldy     <a href="#SymMSlot">MSlot</a>
D82C: AE 78 07                     ldx     <a href="#SymSvBcH">SvBcH</a>
D82F: 60                           rts

D830: A9 01        <span id="Sympzcmd">pzcmd</span>           lda     #$01
D832: D0 02                        bne     <a href="#SymLD836">LD836</a>

D834: A9 04        <span id="SymLD834">LD834</span>           lda     #$04
D836: 8D F8 04     <span id="SymLD836">LD836</span>           sta     <a href="#Symerror">error</a>
D839: 60           <span id="SymLD839">LD839</span>           rts

D83A: 4C 80 C5                     jmp     <a href="#SymLC580">LC580</a>

D83D: 4C F7 C5                     jmp     <a href="#SymLC5F7">LC5F7</a>

D840: 4C 4F D9                     jmp     <a href="#Symdosconv">dosconv</a>

D843: 4C 30 DB                     jmp     <a href="#Symxdiagz">xdiagz</a>

                   ********************************************************************************
                   * XSTATUS - ProDOS status call                                                 *
                   ********************************************************************************
D846: B9 B8 03                     lda     $03B8,Y
D849: 4A                           lsr     A
D84A: 8D F8 05                     sta     <a href="#Symsl_scrn4">sl_scrn4</a>
D84D: A9 00                        lda     #$00
D84F: 8D 78 05                     sta     <a href="#Symsl_scrn3">sl_scrn3</a>
D852: 60                           rts

                   ********************************************************************************
                   * PSTAT0 - Status call for device 0                                            *
                   *          returns status block for call 0                                     *
                   *          1 0 0 0 0 0 0 0                                                     *
                   ********************************************************************************
D853: A5 47        <span id="Sympstat0">pstat0</span>          lda     <a href="#SymCMDBlockh">CMDBlockh</a>
D855: D0 17                        bne     <a href="#Symstbad">stbad</a>
D857: 8D F8 05                     sta     <a href="#Symsl_scrn4">sl_scrn4</a>
D85A: A0 08                        ldy     #$08
D85C: 8C 78 05                     sty     <a href="#Symsl_scrn3">sl_scrn3</a>
D85F: 88                           dey
D860: 91 45        <span id="Symst01p">st01p</span>           sta     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
D862: 88                           dey
D863: D0 FB                        bne     <a href="#Symst01p">st01p</a>
D865: A9 01                        lda     #$01
D867: 91 45                        sta     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
D869: 60                           rts

                   ********************************************************************************
                   * PCNTL - control call                                                         *
                   *         call 0 (reset) is implemented for both devices                       *
                   ********************************************************************************
D86A: A5           <span id="Sympcntl">pcntl</span>           DFB     $A5
D86B: 47                           DFB     $47
D86C: F0                           DFB     $F0
D86D: 05                           DFB     $05

D86E: A9 21        <span id="Symstbad">stbad</span>           lda     #$21
D870: 8D F8 04                     sta     <a href="#Symerror">error</a>
D873: 60                           rts

                   ********************************************************************************
                   * PSTATUS - status call for device 1                                           *
                   *           call 0,3 supported                                                 *
                   ********************************************************************************
D874: A9 04        <span id="Symsl_pstatus">sl_pstatus</span>      lda     #$04
D876: A6 47                        ldx     <a href="#SymCMDBlockh">CMDBlockh</a>
D878: F0 06                        beq     <a href="#Sympst0">pst0</a>
D87A: E0 03                        cpx     #$03
D87C: D0 F0                        bne     <a href="#Symstbad">stbad</a>
D87E: A9 19                        lda     #$19
D880: 8D 78 05     <span id="Sympst0">pst0</span>            sta     <a href="#Symsl_scrn3">sl_scrn3</a>
D883: A2 00                        ldx     #$00
D885: 8E F8 05                     stx     <a href="#Symsl_scrn4">sl_scrn4</a>
D888: A8                           tay
D889: 88                           dey
D88A: B9 67 C6     <span id="Sympstmov">pstmov</span>          lda     <a href="#SymLC667">LC667</a>,Y
D88D: 91 45                        sta     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
D88F: 88                           dey
D890: 10 F8                        bpl     <a href="#Sympstmov">pstmov</a>
D892: AC F8 07                     ldy     <a href="#SymMSlot">MSlot</a>
D895: B9 B8 03                     lda     $03B8,Y
D898: 4A                           lsr     A
D899: A0 02                        ldy     #$02
D89B: 91 45                        sta     (<a href="#SymCMDBufferh">CMDBufferh</a>),Y
D89D: 60                           rts

                   ********************************************************************************
                   * XREAD  - read a block                                                        *
                   * XWRITE - write a block                                                       *
                   *                                                                              *
                   * ProDOS read &amp; write are changed into Protocol converter read block           *
                   * and write block which are then changed into read &amp; write                     *
                   ********************************************************************************
D89E: 2C 39 D8     <span id="Symxread">xread</span>           bit     <a href="#SymLD839">LD839</a>
                   NOTE: D8A1: 50  is a dfb ...
D8A1: 50                           DFB     $50
D8A2: B8           <span id="Symxwrite">xwrite</span>          clv
D8A3: A5 47        <span id="Symxrwcmn">xrwcmn</span>          lda     <a href="#SymCMDBlockh">CMDBlockh</a>
D8A5: 85 48                        sta     <a href="#SymCMDBlocks">CMDBlocks</a>
D8A7: A5 46                        lda     <a href="#SymCMDBlock">CMDBlock</a>
D8A9: 85 47                        sta     <a href="#SymCMDBlockh">CMDBlockh</a>
D8AB: A5 45                        lda     <a href="#SymCMDBufferh">CMDBufferh</a>
D8AD: 85 46                        sta     <a href="#SymCMDBlock">CMDBlock</a>
D8AF: A5 44                        lda     <a href="#SymCMDBuffer">CMDBuffer</a>
D8B1: 85 45                        sta     <a href="#SymCMDBufferh">CMDBufferh</a>
D8B3: A9 00                        lda     #$00
D8B5: 85 49                        sta     <a href="#SymCMDSpare1">CMDSpare1</a>
D8B7: F0 05                        beq     <a href="#Symxread2">xread2</a>

                   ********************************************************************************
                   * PRDBLK - Protocol converter block read                                       *
                   * PWRBLK - Protocol converter block write                                      *
                   ********************************************************************************
D8B9: 2C 39 D8     <span id="Symprdblk">prdblk</span>          bit     <a href="#SymLD839">LD839</a>
D8BC: 50                           DFB     $50
D8BD: B8           <span id="Sympwrblk">pwrblk</span>          clv
D8BE: A5 47        <span id="Symxread2">xread2</span>          lda     <a href="#SymCMDBlockh">CMDBlockh</a>
D8C0: 0A                           asl     A
D8C1: 85 4A                        sta     <a href="#SymCMDSpare2">CMDSpare2</a>
D8C3: A5 48                        lda     <a href="#SymCMDBlocks">CMDBlocks</a>
D8C5: 2A                           rol     A
D8C6: 85 4B                        sta     <a href="#Symgrp7ctr">grp7ctr</a>
D8C8: B0 1F                        bcs     <a href="#Symprbad2">prbad2</a>
D8CA: A5 49                        lda     <a href="#SymCMDSpare1">CMDSpare1</a>
D8CC: D0 1B                        bne     <a href="#Symprbad2">prbad2</a>
D8CE: 85 49                        sta     <a href="#SymCMDSpare1">CMDSpare1</a>
D8D0: 85 47                        sta     <a href="#SymCMDBlockh">CMDBlockh</a>
D8D2: A9 02                        lda     #$02
D8D4: 85 48                        sta     <a href="#SymCMDBlocks">CMDBlocks</a>
D8D6: AD 14 C0                     lda     <a href="#SymLC000">LC000</a>+20
D8D9: 70 03                        bvs     <a href="#Symprdread">prdread</a>
D8DB: AD 13 C0                     lda     <a href="#SymLC000">LC000</a>+19
D8DE: 29 80        <span id="Symprdread">prdread</span>         and     #$80
D8E0: 05 4B                        ora     <a href="#Symgrp7ctr">grp7ctr</a>
D8E2: 85 4B                        sta     <a href="#Symgrp7ctr">grp7ctr</a>
D8E4: 70 06                        bvs     <a href="#Symprbad3">prbad3</a>
D8E6: 4C F7 C5                     jmp     <a href="#SymLC5F7">LC5F7</a>

D8E9: 4C EE C5     <span id="Symprbad2">prbad2</span>          jmp     <a href="#SymLC5EE">LC5EE</a>

D8EC: 4C           <span id="Symprbad3">prbad3</span>          DFB     $4C
D8ED: 80                           DFB     $80
D8EE: C5                           DFB     $C5

                   ********************************************************************************
                   * here is the rest of the boot code                                            *
                   * input: a = kswh, output: v = 1 if boot fails                                 *
                   * jumps to DOS patch if IN# from DOS                                           *
                   ********************************************************************************
D8EF: A0 C4        <span id="Symbool_sl">bool_sl</span>         ldy     #$C4
D8F1: 8C F8 07                     sty     <a href="#SymMSlot">MSlot</a>
D8F4: A2 C8                        ldx     #$C8
D8F6: 8E 78 07                     stx     <a href="#SymSvBcH">SvBcH</a>
D8F9: CD F8 07                     cmp     <a href="#SymMSlot">MSlot</a>
D8FC: D0 09                        bne     <a href="#Symbtnodos">btnodos</a>
D8FE: AD 00 BF                     lda     <a href="#Symproflag">proflag</a>
D901: F0 04                        beq     <a href="#Symbtnodos">btnodos</a>
D903: C9 4C                        cmp     #$4C
D905: D0 20                        bne     <a href="#Symdospatch">dospatch</a>
D907: 9C 01 08     <span id="Symbtnodos">btnodos</span>         stz     $0801
D90A: B9 B8 06                     lda     <a href="#Symflags">flags</a>,Y
D90D: C9 A5                        cmp     #$A5
D90F: D0 11                        bne     <a href="#Symbtfail">btfail</a>
D911: A0 03                        ldy     #$03
D913: B9 23 D9     <span id="Symbtmv">btmv</span>            lda     <a href="#Symbtcmd">btcmd</a>,Y
D916: 99 44 00                     sta     <a href="#SymCMDBuffer">CMDBuffer</a>,Y
D919: 88                           dey
D91A: 10 F7                        bpl     <a href="#Symbtmv">btmv</a>
D91C: AC F8 07                     ldy     <a href="#SymMSlot">MSlot</a>
D91F: 20 9E D8                     jsr     <a href="#Symxread">xread</a>
D922: 60           <span id="Symbtfail">btfail</span>          rts

D923: 00           <span id="Symbtcmd">btcmd</span>           DFB     $00
D924: 08                           DFB     $08
D925: 00                           DFB     $00
D926: 00                           DFB     $00

                   ********************************************************************************
                   * DOSPATCH - patches rwts to jump to us                                        *
                   ********************************************************************************
D927: A9 4C        <span id="Symdospatch">dospatch</span>        lda     #$4C
D929: 8D 00 BD                     sta     <a href="#Symrwts">rwts</a>
D92C: A9 D1                        lda     #$D1
D92E: 8D 01 BD                     sta     $BD01
D931: 8C 02 BD                     sty     $BD02
D934: A9 C3                        lda     #$C3
D936: 8D 1E 9D                     sta     <a href="#Symdosinit">dosinit</a>
D939: A9 A6                        lda     #$A6
D93B: 8D 1F 9D                     sta     $9D1F
D93E: 68                           pla
D93F: 68                           pla
D940: FA                           plx
D941: FE 00 C0                     inc     <a href="#SymLC000">LC000</a>,X
D944: FA                           plx
D945: 68                           pla
D946: 68                           pla
D947: A2 00                        ldx     #$00
D949: A9 98                        lda     #$98
D94B: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>            ;switch rom bank and return

D94E: 60           <span id="Symdcrts">dcrts</span>           rts

                   ********************************************************************************
                   * DOSCONV - changes DOS command into ours                                      *
                   * output: command table in zp Y = command                                      *
                   ********************************************************************************
D94F: A0 02        <span id="Symdosconv">dosconv</span>         ldy     #$02
D951: B1 48                        lda     (<a href="#SymCMDBlocks">CMDBlocks</a>),Y
D953: C9 01                        cmp     #$01
D955: F0 03                        beq     <a href="#Symdcl">dcl</a>
D957: 4C 30 D8     <span id="Symdcerr">dcerr</span>           jmp     <a href="#Sympzcmd">pzcmd</a>

D95A: A0 04        <span id="Symdcl">dcl</span>             ldy     #$04
D95C: B1 48                        lda     (<a href="#SymCMDBlocks">CMDBlocks</a>),Y
D95E: 4A                           lsr     A
D95F: 66 4A                        ror     <a href="#SymCMDSpare2">CMDSpare2</a>
D961: 4A                           lsr     A
D962: 66 4A                        ror     <a href="#SymCMDSpare2">CMDSpare2</a>
D964: 4A                           lsr     A
D965: 85 4B                        sta     <a href="#Symgrp7ctr">grp7ctr</a>
D967: A5 4A                        lda     <a href="#SymCMDSpare2">CMDSpare2</a>
D969: 6A                           ror     A
D96A: 29 E0                        and     #$E0
D96C: C8                           iny
D96D: 11 48                        ora     (<a href="#SymCMDBlocks">CMDBlocks</a>),Y
D96F: 85 4A                        sta     <a href="#SymCMDSpare2">CMDSpare2</a>
D971: A0 08                        ldy     #$08
D973: B1 48                        lda     (<a href="#SymCMDBlocks">CMDBlocks</a>),Y
D975: 85 45                        sta     <a href="#SymCMDBufferh">CMDBufferh</a>
D977: C8                           iny
D978: B1 48                        lda     (<a href="#SymCMDBlocks">CMDBlocks</a>),Y
D97A: 85 46                        sta     <a href="#SymCMDBlock">CMDBlock</a>
D97C: A0 0C                        ldy     #$0C
D97E: B1 48                        lda     (<a href="#SymCMDBlocks">CMDBlocks</a>),Y
D980: F0 CC                        beq     <a href="#Symdcrts">dcrts</a>
D982: 29 03                        and     #$03
D984: F0 D1                        beq     <a href="#Symdcerr">dcerr</a>
D986: 09 11                        ora     #$11
D988: A8                           tay
D989: A2 00                        ldx     #$00
D98B: 86 47                        stx     <a href="#SymCMDBlockh">CMDBlockh</a>
D98D: 86 49                        stx     <a href="#SymCMDSpare1">CMDSpare1</a>
D98F: E8                           inx
D990: 86 48                        stx     <a href="#SymCMDBlocks">CMDBlocks</a>
D992: 4C 1F D8                     jmp     <a href="#Symexec2">exec2</a>

                   ********************************************************************************
                   * TESTSIZE - determines ramdisk size nondestructively                          *
                   * Inputs: Y = mslot X = devno                                                  *
                   ********************************************************************************
D995: A9 00        <span id="Symtestsize">testsize</span>        lda     #$00
D997: 9D F8 BF                     sta     <a href="#Symsdata">sdata</a>,X
D99A: 9D F9 BF                     sta     <a href="#Symsstat">sstat</a>,X
D99D: A9 10                        lda     #$10
D99F: 38                           sec
D9A0: E9 01        <span id="Symtsloop">tsloop</span>          sbc     #$01
D9A2: 9D FA BF                     sta     <a href="#Symscomd">scomd</a>,X
D9A5: BD FB BF                     lda     <a href="#Symscntl">scntl</a>,X
D9A8: 48                           pha
D9A9: DE F8 BF                     dec     <a href="#Symsdata">sdata</a>,X
D9AC: A9 A5                        lda     #$A5
D9AE: 9D FB BF                     sta     <a href="#Symscntl">scntl</a>,X
D9B1: DE F8 BF                     dec     <a href="#Symsdata">sdata</a>,X
D9B4: 5D FB BF                     eor     <a href="#Symscntl">scntl</a>,X
D9B7: DE F8 BF                     dec     <a href="#Symsdata">sdata</a>,X
D9BA: C9 01                        cmp     #$01
D9BC: 68                           pla
D9BD: 9D FB BF                     sta     <a href="#Symscntl">scntl</a>,X
D9C0: BD FA BF                     lda     <a href="#Symscomd">scomd</a>,X
D9C3: 29 0F                        and     #$0F
D9C5: F0 04                        beq     <a href="#Symtsnoram">tsnoram</a>
D9C7: B0 D7                        bcs     <a href="#Symtsloop">tsloop</a>
D9C9: 69 01                        adc     #$01
D9CB: 99 B8 03     <span id="Symtsnoram">tsnoram</span>         sta     $03B8,Y
D9CE: 4A                           lsr     A
D9CF: 8D 78 04                     sta     <a href="#Symnumbanks">numbanks</a>
D9D2: 60                           rts

                   ********************************************************************************
                   * Routines for making a directory on the disk                                  *
                   * *******************************************                                  *
                   * Format - Tests for powerup and puts catalog on the disk if needed            *
                   * Inputs: Y = mslot X = devno                                                  *
                   ********************************************************************************
D9D3: AC F8 07     <span id="Symsl_format">sl_format</span>       ldy     <a href="#SymMSlot">MSlot</a>
                   ; Commented out code:
                   ; lda power2,y ; Is power2 eor powerup = A5
                   ; ero #$A5
                   ; cmp powerup, y
                   ; beq fmtdone
                   ; sta powerup, y
D9D6: A9 A5                        lda     #$A5
D9D8: D9 B8 06                     cmp     <a href="#Symflags">flags</a>,Y
D9DB: F0 2B                        beq     <a href="#Symfmtdone">fmtdone</a>
D9DD: 99 B8 06                     sta     <a href="#Symflags">flags</a>,Y
                   ; If all screen holes spaces, someone might have cleared
                   ; the screen wrong so we won't reformat
D9E0: C9 05        <span id="Symfmnosp">fmnosp</span>          cmp     #$05
D9E2: 08                           php
D9E3: 20 95 D9                     jsr     <a href="#Symtestsize">testsize</a>
D9E6: 28                           plp
D9E7: F0 1F                        beq     <a href="#Symfmtdone">fmtdone</a>
D9E9: AD 00 BF                     lda     <a href="#Symproflag">proflag</a>
D9EC: F0 1B                        beq     <a href="#Symfmpas">fmpas</a>
D9EE: C9 4C                        cmp     #$4C
D9F0: D0 1D                        bne     <a href="#Symfmdos">fmdos</a>
D9F2: A0 FF                        ldy     #$FF
D9F4: 20 39 DA                     jsr     <a href="#Symmakecat">makecat</a>
D9F7: A9 01                        lda     #$01
D9F9: A0 20        <span id="Symfmpmap1">fmpmap1</span>         ldy     #$20
D9FB: 9D FB BF     <span id="Symfmpmap2">fmpmap2</span>         sta     <a href="#Symscntl">scntl</a>,X
D9FE: 09 FF                        ora     #$FF
DA00: 88                           dey
DA01: D0 F8                        bne     <a href="#Symfmpmap2">fmpmap2</a>
DA03: CE 78 04                     dec     <a href="#Symnumbanks">numbanks</a>
DA06: D0 F1                        bne     <a href="#Symfmpmap1">fmpmap1</a>
DA08: 60           <span id="Symfmtdone">fmtdone</span>         rts

                   ; Do a pascal catalog
DA09: A0 78        <span id="Symfmpas">fmpas</span>           ldy     #$78
DA0B: 20 39 DA                     jsr     <a href="#Symmakecat">makecat</a>
DA0E: 60                           rts

                   ; Do a DOS catalog
DA0F: A0 2C        <span id="Symfmdos">fmdos</span>           ldy     #$2C
DA11: 20 39 DA                     jsr     <a href="#Symmakecat">makecat</a>
DA14: A9 44                        lda     #$44
DA16: 9D F8 BF                     sta     <a href="#Symsdata">sdata</a>,X
DA19: AD 78 04                     lda     <a href="#Symnumbanks">numbanks</a>
DA1C: A0 72                        ldy     #$72
DA1E: C9 04                        cmp     #$04
DA20: 90 02                        bcc     <a href="#Symfmddmap">fmddmap</a>
DA22: A0 BA                        ldy     #$BA
DA24: BD F8 BF     <span id="Symfmddmap">fmddmap</span>         lda     <a href="#Symsdata">sdata</a>,X
DA27: C9 7C                        cmp     #$7C
DA29: D0 05                        bne     <a href="#Symfmdok">fmdok</a>
DA2B: A9 7E                        lda     #$7E
DA2D: 9D F8 BF                     sta     <a href="#Symsdata">sdata</a>,X
DA30: A9 FF        <span id="Symfmdok">fmdok</span>           lda     #$FF
DA32: 9D FB BF                     sta     <a href="#Symscntl">scntl</a>,X
DA35: 88                           dey
DA36: D0 EC                        bne     <a href="#Symfmddmap">fmddmap</a>
DA38: 60                           rts

                   ********************************************************************************
                   * MAKECAT - Creates a catalog                                                  *
                   *  Inputs: X = index into catalog tables                                       *
                   *                                                                              *
                   ********************************************************************************
DA39: A9 00        <span id="Symmakecat">makecat</span>         lda     #$00
DA3B: 9D F8 BF                     sta     <a href="#Symsdata">sdata</a>,X
DA3E: 9D F9 BF                     sta     <a href="#Symsstat">sstat</a>,X
DA41: 9D FA BF                     sta     <a href="#Symscomd">scomd</a>,X
DA44: 9D FB BF     <span id="Symmcboot">mcboot</span>          sta     <a href="#Symscntl">scntl</a>,X
DA47: BD F9 BF                     lda     <a href="#Symsstat">sstat</a>,X
DA4A: 29 F0                        and     #$F0
DA4C: F0 F6                        beq     <a href="#Symmcboot">mcboot</a>
DA4E: A9 04                        lda     #$04
DA50: 9D F9 BF                     sta     <a href="#Symsstat">sstat</a>,X
DA53: C8           <span id="Symmcbyte">mcbyte</span>          iny
DA54: B9 A7 DA                     lda     <a href="#Symprocat">procat</a>,Y
DA57: C9 FD                        cmp     #$FD
DA59: F0 1C                        beq     <a href="#Symmc0">mc0</a>
DA5B: C9 FE                        cmp     #$FE
DA5D: F0 1E                        beq     <a href="#Symmcfe">mcfe</a>
DA5F: C9 FC                        cmp     #$FC
DA61: D0 05                        bne     <a href="#Symmcntsz">mcntsz</a>
DA63: AD 78 04                     lda     <a href="#Symnumbanks">numbanks</a>
DA66: D0 09                        bne     <a href="#Symmcntnm">mcntnm</a>
DA68: C9 AA        <span id="Symmcntsz">mcntsz</span>          cmp     #$AA
DA6A: D0 05                        bne     <a href="#Symmcntnm">mcntnm</a>
DA6C: AD F8 07                     lda     <a href="#SymMSlot">MSlot</a>
DA6F: 49 F0                        eor     #$F0
DA71: 9D FB BF     <span id="Symmcntnm">mcntnm</span>          sta     <a href="#Symscntl">scntl</a>,X
DA74: 4C 53 DA                     jmp     <a href="#Symmcbyte">mcbyte</a>

DA77: C8           <span id="Symmc0">mc0</span>             iny
DA78: B9 A7 DA                     lda     <a href="#Symprocat">procat</a>,Y
DA7B: F0 11                        beq     <a href="#Symmcadd">mcadd</a>
DA7D: 48           <span id="Symmcfe">mcfe</span>            pha
DA7E: A9 00                        lda     #$00
DA80: 9D FB BF                     sta     <a href="#Symscntl">scntl</a>,X
DA83: 68                           pla
DA84: 38                           sec
DA85: E9 01                        sbc     #$01
DA87: D0 F4                        bne     <a href="#Symmcfe">mcfe</a>
DA89: F0 C8                        beq     <a href="#Symmcbyte">mcbyte</a>

DA8B: 9D FB BF     <span id="Symmcadd2">mcadd2</span>          sta     <a href="#Symscntl">scntl</a>,X
DA8E: DD F8 BF     <span id="Symmcadd">mcadd</span>           cmp     <a href="#Symsdata">sdata</a>,X
DA91: D0 F8                        bne     <a href="#Symmcadd2">mcadd2</a>
DA93: C8                           iny
DA94: B9 A7 DA                     lda     <a href="#Symprocat">procat</a>,Y
DA97: F0 0D                        beq     <a href="#Symmcdone">mcdone</a>
DA99: 9D F9 BF                     sta     <a href="#Symsstat">sstat</a>,X
DA9C: C8                           iny
DA9D: B9 A7 DA                     lda     <a href="#Symprocat">procat</a>,Y
DAA0: 9D FA BF                     sta     <a href="#Symscomd">scomd</a>,X
DAA3: 4C 53 DA                     jmp     <a href="#Symmcbyte">mcbyte</a>

DAA6: 60           <span id="Symmcdone">mcdone</span>          rts

                   NOTE: this section as boat load of dfb, dw, and stuff
                   ********************************************************************************
                   * The catalog tables                                                           *
                   * These tables contain the catalog info compacted                              *
                   * in a scheme so clever it probably doesn't save                               *
                   * me anything                                                                  *
                   * For each bank:                                                               *
                   *  The first byte is the bank #. 0 = done                                      *
                   *  zers,n = skip n 0s                                                          *
                   *  zers,0 = fill rest of page with 0s and get new address                      *
                   *  zers,0,0 = All done                                                         *
                   *  skpfe = fill $FE 0s                                                         *
                   *  nameflg = replace with ascii slot #                                         *
                   *  sizeflg = replace with &lt; block size                                         *
                   ********************************************************************************
DAA7: 00 00        <span id="Symprocat">procat</span>          DW      $0000
DAA9: 03 00                        DW      $0003
DAAB: F4                           DFB     $F4
                   ; daac, daad, daaf, form asc 'RAM'
DAAC: 52                           DFB     $52
DAAD: 41                           DFB     $41
DAAE: 4D                           DFB     $4D
DAAF: AA                           DFB     $AA
DAB0: FD                           DFB     $FD
DAB1: 19                           DFB     $19
DAB2: C3                           DFB     $C3
DAB3: 27                           DFB     $27
DAB4: 0D                           DFB     $0D
DAB5: 00                           DFB     $00
DAB6: 00                           DFB     $00
DAB7: 06                           DFB     $06
DAB8: 00                           DFB     $00
DAB9: 00                           DFB     $00
DABA: FC FD D7 FE                  ASC     “|}W~”
DABE: 02                           DFB     $02
DABF: 00                           DFB     $00
DAC0: 04                           DFB     $04
DAC1: 00                           DFB     $00
DAC2: FE                           DFB     $FE
DAC3: FE                           DFB     $FE
DAC4: 03                           DFB     $03
DAC5: 00                           DFB     $00
DAC6: 05                           DFB     $05
DAC7: 00                           DFB     $00
DAC8: FE                           DFB     $FE
DAC9: FE                           DFB     $FE
DACA: 04                           DFB     $04
DACB: 00                           DFB     $00
DACC: 00                           DFB     $00
DACD: FE                           DFB     $FE
DACE: FD                           DFB     $FD
DACF: 00 00 00 00+                 DS      5,$00
DAD4: FD           <span id="Symdoscat">doscat</span>          DFB     $FD
DAD5: 00                           DFB     $00
DAD6: 20                           DFB     $20
DAD7: 02                           DFB     $02
DAD8: 02                           DFB     $02
DAD9: 11                           DFB     $11
DADA: 0F                           DFB     $0F
DADB: 04                           DFB     $04
DADC: 00                           DFB     $00
DADD: 00                           DFB     $00
DADE: FB                           DFB     $FB
DADF: FD                           DFB     $FD
DAE0: 20                           DFB     $20
DAE1: 7A                           DFB     $7A
DAE2: FD                           DFB     $FD
DAE3: 08                           DFB     $08
DAE4: FF                           DFB     $FF
DAE5: FF                           DFB     $FF
DAE6: FF                           DFB     $FF
DAE7: FF                           DFB     $FF
DAE8: 32                           DFB     $32
DAE9: 20                           DFB     $20
DAEA: 00                           DFB     $00
DAEB: 01                           DFB     $01
DAEC: FD                           DFB     $FD
DAED: CB                           DFB     $CB
DAEE: FE                           DFB     $FE
DAEF: 11                           DFB     $11
DAF0: 01                           DFB     $01
DAF1: FE                           DFB     $FE
DAF2: 11                           DFB     $11
DAF3: 02                           DFB     $02
DAF4: FE                           DFB     $FE
DAF5: 11                           DFB     $11
DAF6: 03                           DFB     $03
DAF7: FE                           DFB     $FE
DAF8: 11                           DFB     $11
DAF9: 04                           DFB     $04
DAFA: FE                           DFB     $FE
DAFB: 11                           DFB     $11
DAFC: 05                           DFB     $05
DAFD: FE                           DFB     $FE
DAFE: 11                           DFB     $11
DAFF: 06                           DFB     $06
DB00: FE                           DFB     $FE
DB01: 11                           DFB     $11
DB02: 07                           DFB     $07
DB03: FE                           DFB     $FE
DB04: 11                           DFB     $11
DB05: 08                           DFB     $08
DB06: FE                           DFB     $FE
DB07: 11                           DFB     $11
DB08: 09                           DFB     $09
DB09: FE                           DFB     $FE
DB0A: 11                           DFB     $11
DB0B: 0A                           DFB     $0A
DB0C: FE                           DFB     $FE
DB0D: 11                           DFB     $11
DB0E: 0B                           DFB     $0B
DB0F: FE                           DFB     $FE
DB10: 11                           DFB     $11
DB11: 0C                           DFB     $0C
DB12: FE                           DFB     $FE
DB13: 11                           DFB     $11
DB14: 0D                           DFB     $0D
DB15: FE                           DFB     $FE
DB16: 11                           DFB     $11
DB17: 0E                           DFB     $0E
DB18: FE                           DFB     $FE
DB19: FD                           DFB     $FD
DB1A: 00                           DFB     $00
DB1B: 20                           DFB     $20
DB1C: 02                           DFB     $02
DB1D: FD                           DFB     $FD
DB1E: 00                           DFB     $00
DB1F: 00                           DFB     $00
DB20: 00                           DFB     $00
DB21: 00                           DFB     $00
DB22: 06                           DFB     $06
DB23: FD                           DFB     $FD
DB24: 03                           DFB     $03
DB25: 04                           DFB     $04
DB26: 52                           DFB     $52
DB27: 41                           DFB     $41
DB28: 4D                           DFB     $4D
DB29: AA                           DFB     $AA
DB2A: FD                           DFB     $FD
DB2B: 04                           DFB     $04
DB2C: FC                           DFB     $FC
DB2D: FD                           DFB     $FD
DB2E: 00                           DFB     $00
DB2F: 00                           DFB     $00

                   ********************************************************************************
                   * XDIAGZ - Moves the slinky diagnostic code from $DC00 - $DFFF to              *
                   * main ram starting at $2000 and jumps to $2000                                *
                   ********************************************************************************
DB30: A2 00        <span id="Symxdiagz">xdiagz</span>          ldx     #$00
DB32: BD 00 DC     <span id="Symxdloop">xdloop</span>          lda     <a href="#SymLDC00">LDC00</a>,X           ;move the code
DB35: 9D 00 20                     sta     <a href="#Symdiagdest">diagdest</a>,X
DB38: BD 00 DD                     lda     <a href="#SymLDD00">LDD00</a>,X
DB3B: 9D 00 21                     sta     $2100,X
DB3E: BD 00 DE                     lda     <a href="#SymLDE00">LDE00</a>,X
DB41: 9D 00 22                     sta     $2200,X
DB44: BD 00 DF                     lda     <a href="#SymLDF00">LDF00</a>,X
DB47: 9D 00 23                     sta     $2300,X
DB4A: E8                           inx
DB4B: D0 E5                        bne     <a href="#Symxdloop">xdloop</a>
DB4D: AE 78 07                     ldx     <a href="#SymSvBcH">SvBcH</a>
DB50: A9 1F                        lda     #$1F
DB52: 48                           pha
DB53: A9 FF                        lda     #$FF
DB55: 48                           pha
                   ********************************************************************************
                   * switch the main rom back in and go to the diagnostics via return             *
                   ********************************************************************************
DB56: 4C 84 C7                     jmp     <a href="#Symswrts2">swrts2</a>

DB59: 00 00 00 00+                 DS      167,$00
                   ********************************************************************************
                   * VECTORS                                                                      *
                   ********************************************************************************
DC00: A9           <span id="SymLDC00">LDC00</span>           DFB     $A9
DC01: 00                           DFB     $00
DC02: 85                           DFB     $85
DC03: 49                           DFB     $49
DC04: 85                           DFB     $85
DC05: 4A                           DFB     $4A
DC06: 99                           DFB     $99
DC07: 38                           DFB     $38
DC08: 04                           DFB     $04
DC09: 99                           DFB     $99
DC0A: B8                           DFB     $B8
DC0B: 04                           DFB     $04
DC0C: B9                           DFB     $B9
DC0D: B8                           DFB     $B8
DC0E: 03                           DFB     $03
DC0F: 29                           DFB     $29
DC10: 0F                           DFB     $0F
DC11: 85                           DFB     $85
DC12: 46                           DFB     $46
DC13: 20                           DFB     $20
DC14: 58                           DFB     $58
DC15: FC                           DFB     $FC
DC16: A9                           DFB     $A9
DC17: 08                           DFB     $08
DC18: 20                           DFB     $20
DC19: 1D                           DFB     $1D
DC1A: 22                           DFB     $22
DC1B: A5                           DFB     $A5
DC1C: 46 4A 4A 48                  ASC     ‘FJJH’
DC20: 09                           DFB     $09
DC21: 04                           DFB     $04
DC22: 20                           DFB     $20
DC23: 1D                           DFB     $1D
DC24: 22                           DFB     $22
DC25: A9                           DFB     $A9
DC26: 09                           DFB     $09
DC27: 20                           DFB     $20
DC28: 1D                           DFB     $1D
DC29: 22                           DFB     $22
DC2A: 68                           DFB     $68
DC2B: 20                           DFB     $20
DC2C: 1D                           DFB     $1D
DC2D: 22                           DFB     $22
DC2E: 20                           DFB     $20
DC2F: 8E                           DFB     $8E
DC30: FD                           DFB     $FD
DC31: A9                           DFB     $A9
DC32: 05                           DFB     $05
DC33: 85                           DFB     $85
DC34: 25                           DFB     $25
DC35: 20                           DFB     $20
DC36: 8E                           DFB     $8E
DC37: FD                           DFB     $FD
DC38: A9                           DFB     $A9
DC39: 10                           DFB     $10
DC3A: 20                           DFB     $20
DC3B: 1D                           DFB     $1D
DC3C: 22                           DFB     $22
DC3D: A5                           DFB     $A5
DC3E: 4A                           DFB     $4A
DC3F: 20                           DFB     $20
DC40: DA                           DFB     $DA
DC41: FD                           DFB     $FD
DC42: A5                           DFB     $A5
DC43: 49                           DFB     $49
DC44: 20                           DFB     $20
DC45: DA                           DFB     $DA
DC46: FD                           DFB     $FD
DC47: 20                           DFB     $20
DC48: 0B                           DFB     $0B
DC49: 22                           DFB     $22
DC4A: A9                           DFB     $A9
DC4B: 01                           DFB     $01
DC4C: 85                           DFB     $85
DC4D: 00                           DFB     $00
DC4E: A0                           DFB     $A0
DC4F: 05                           DFB     $05
DC50: B9                           DFB     $B9
DC51: F4                           DFB     $F4
DC52: 22                           DFB     $22
DC53: 20                           DFB     $20
DC54: 13                           DFB     $13
DC55: 22                           DFB     $22
DC56: DD F8 BF D0                  ASC     “]x?P”
DC5A: 11                           DFB     $11
DC5B: DD F9 BF D0                  ASC     “]y?P”
DC5F: 0C                           DFB     $0C
DC60: 09                           DFB     $09
DC61: F0 DD FA BF+                 ASC     “p]z?P”
DC66: 05                           DFB     $05
DC67: 88                           DFB     $88
DC68: 10                           DFB     $10
DC69: E6                           DFB     $E6
DC6A: 30                           DFB     $30
DC6B: 03                           DFB     $03
DC6C: 4C                           DFB     $4C
DC6D: 97                           DFB     $97
DC6E: 21                           DFB     $21
DC6F: E6                           DFB     $E6
DC70: 00                           DFB     $00
DC71: DE F8 BF BD+                 ASC     “^x?={?”
DC77: 9D                           DFB     $9D
DC78: FB BF BD FA+                 ASC     “{?=z?”
DC7D: 29                           DFB     $29
DC7E: 0F                           DFB     $0F
DC7F: 1D                           DFB     $1D
DC80: F9                           DFB     $F9
DC81: BF                           DFB     $BF
DC82: 1D                           DFB     $1D
DC83: F8                           DFB     $F8
DC84: BF                           DFB     $BF
DC85: F0                           DFB     $F0
DC86: 03                           DFB     $03
DC87: 4C                           DFB     $4C
DC88: 97                           DFB     $97
DC89: 21                           DFB     $21
DC8A: E6                           DFB     $E6
DC8B: 00                           DFB     $00
DC8C: A9                           DFB     $A9
DC8D: 01                           DFB     $01
DC8E: 85                           DFB     $85
DC8F: 45                           DFB     $45
DC90: 8A                           DFB     $8A
DC91: 18                           DFB     $18
DC92: 69                           DFB     $69
DC93: F8                           DFB     $F8
DC94: 85                           DFB     $85
DC95: 42                           DFB     $42
DC96: A9                           DFB     $A9
DC97: C0                           DFB     $C0
DC98: 85                           DFB     $85
DC99: 43                           DFB     $43
DC9A: A5                           DFB     $A5
DC9B: 46                           DFB     $46
DC9C: F0                           DFB     $F0
DC9D: 04                           DFB     $04
DC9E: C9                           DFB     $C9
DC9F: 0C                           DFB     $0C
DCA0: D0                           DFB     $D0
DCA1: 02                           DFB     $02
DCA2: A9                           DFB     $A9
DCA3: 10                           DFB     $10
DCA4: 4A                           DFB     $4A
DCA5: 48                           DFB     $48
DCA6: A0                           DFB     $A0
DCA7: 02                           DFB     $02
DCA8: 48                           DFB     $48
DCA9: 20                           DFB     $20
DCAA: 11                           DFB     $11
DCAB: 22                           DFB     $22
DCAC: 68                           DFB     $68
DCAD: 91                           DFB     $91
DCAE: 42                           DFB     $42
DCAF: 48                           DFB     $48
DCB0: A5                           DFB     $A5
DCB1: 45                           DFB     $45
DCB2: 9D                           DFB     $9D
DCB3: FB                           DFB     $FB
DCB4: BF                           DFB     $BF
DCB5: E6                           DFB     $E6
DCB6: 45                           DFB     $45
DCB7: 68                           DFB     $68
DCB8: 4A                           DFB     $4A
DCB9: D0                           DFB     $D0
DCBA: ED                           DFB     $ED
DCBB: 91                           DFB     $91
DCBC: 42                           DFB     $42
DCBD: 6A                           DFB     $6A
DCBE: 88                           DFB     $88
DCBF: 10                           DFB     $10
DCC0: E7                           DFB     $E7
DCC1: A9                           DFB     $A9
DCC2: 01                           DFB     $01
DCC3: 85                           DFB     $85
DCC4: 45                           DFB     $45
DCC5: 68                           DFB     $68
DCC6: A0                           DFB     $A0
DCC7: 02                           DFB     $02
DCC8: 48                           DFB     $48
DCC9: 20                           DFB     $20
DCCA: 11                           DFB     $11
DCCB: 22                           DFB     $22
DCCC: 68                           DFB     $68
DCCD: 91                           DFB     $91
DCCE: 42                           DFB     $42
DCCF: 85                           DFB     $85
DCD0: 47                           DFB     $47
DCD1: BD FB BF C5                  ASC     “={?E”
DCD5: 45                           DFB     $45
DCD6: D0                           DFB     $D0
DCD7: 0F                           DFB     $0F
DCD8: E6                           DFB     $E6
DCD9: 45                           DFB     $45
DCDA: A5                           DFB     $A5
DCDB: 47                           DFB     $47
DCDC: 4A                           DFB     $4A
DCDD: D0                           DFB     $D0
DCDE: E9                           DFB     $E9
DCDF: 91                           DFB     $91
DCE0: 42                           DFB     $42
DCE1: 6A                           DFB     $6A
DCE2: 88                           DFB     $88
DCE3: 10                           DFB     $10
DCE4: E3                           DFB     $E3
DCE5: 30                           DFB     $30
DCE6: 03                           DFB     $03
DCE7: 4C                           DFB     $4C
DCE8: 97                           DFB     $97
DCE9: 21                           DFB     $21
DCEA: 20                           DFB     $20
DCEB: 11                           DFB     $11
DCEC: 22                           DFB     $22
DCED: E6                           DFB     $E6
DCEE: 00                           DFB     $00
DCEF: 85                           DFB     $85
DCF0: 45                           DFB     $45
DCF1: A5                           DFB     $A5
DCF2: 45                           DFB     $45
DCF3: 9D                           DFB     $9D
DCF4: FB                           DFB     $FB
DCF5: BF                           DFB     $BF
DCF6: 9D                           DFB     $9D
DCF7: FB                           DFB     $FB
DCF8: BF                           DFB     $BF
DCF9: 9D                           DFB     $9D
DCFA: FB                           DFB     $FB
DCFB: BF                           DFB     $BF
DCFC: 9D                           DFB     $9D
DCFD: FB                           DFB     $FB
DCFE: BF                           DFB     $BF
DCFF: BD                           DFB     $BD
DD00: F8 BF D0 ED  <span id="SymLDD00">LDD00</span>           ASC     “x?Pm”
DD04: 1D                           DFB     $1D
DD05: F9 BF D0 E8                  ASC     “y?Ph”
DD09: 20                           DFB     $20
DD0A: E4                           DFB     $E4
DD0B: 21                           DFB     $21
DD0C: D0                           DFB     $D0
DD0D: E3                           DFB     $E3
DD0E: 20                           DFB     $20
DD0F: 0B                           DFB     $0B
DD10: 22                           DFB     $22
DD11: BD FB BF C5                  ASC     “={?E”
DD15: 45                           DFB     $45
DD16: D0 CF BD FB+                 ASC     “PO={?E”
DD1C: 45                           DFB     $45
DD1D: D0 C8 BD F8+                 ASC     “PH=x?Pm”
DD24: 1D                           DFB     $1D
DD25: F9 BF D0 E8                  ASC     “y?Ph”
DD29: 20                           DFB     $20
DD2A: E4                           DFB     $E4
DD2B: 21                           DFB     $21
DD2C: D0                           DFB     $D0
DD2D: E3                           DFB     $E3
DD2E: 20                           DFB     $20
DD2F: 0B                           DFB     $0B
DD30: 22                           DFB     $22
DD31: A5                           DFB     $A5
DD32: 45                           DFB     $45
DD33: 49                           DFB     $49
DD34: FF                           DFB     $FF
DD35: D0                           DFB     $D0
DD36: B6                           DFB     $B6
DD37: E6                           DFB     $E6
DD38: 00                           DFB     $00
DD39: A9                           DFB     $A9
DD3A: 55                           DFB     $55
DD3B: 85                           DFB     $85
DD3C: 45                           DFB     $45
DD3D: 20                           DFB     $20
DD3E: FD                           DFB     $FD
DD3F: 21                           DFB     $21
DD40: 18                           DFB     $18
DD41: 65 47 65 45                  ASC     ‘eGeE’
DD45: 9D                           DFB     $9D
DD46: FB                           DFB     $FB
DD47: BF                           DFB     $BF
DD48: 85                           DFB     $85
DD49: 45                           DFB     $45
DD4A: BD F8 BF D0+                 ASC     “=x?Pq=y?Pi”
DD54: 20                           DFB     $20
DD55: E4                           DFB     $E4
DD56: 21                           DFB     $21
DD57: D0                           DFB     $D0
DD58: E4                           DFB     $E4
DD59: 20                           DFB     $20
DD5A: 0B                           DFB     $0B
DD5B: 22                           DFB     $22
DD5C: A9                           DFB     $A9
DD5D: 55                           DFB     $55
DD5E: 85                           DFB     $85
DD5F: 45                           DFB     $45
DD60: 20                           DFB     $20
DD61: FD                           DFB     $FD
DD62: 21                           DFB     $21
DD63: 18                           DFB     $18
DD64: 65 47 65 45                  ASC     ‘eGeE’
DD68: 85                           DFB     $85
DD69: 45                           DFB     $45
DD6A: BD FB BF C5                  ASC     “={?E”
DD6E: 45                           DFB     $45
DD6F: D0                           DFB     $D0
DD70: 26                           DFB     $26
DD71: BD F8 BF D0+                 ASC     “=x?Pm=y?Pe”
DD7B: 20                           DFB     $20
DD7C: E4                           DFB     $E4
DD7D: 21                           DFB     $21
DD7E: D0                           DFB     $D0
DD7F: E0                           DFB     $E0
DD80: A9                           DFB     $A9
DD81: 0B                           DFB     $0B
DD82: 20                           DFB     $20
DD83: 1D                           DFB     $1D
DD84: 22                           DFB     $22
DD85: F8                           DFB     $F8
DD86: A5                           DFB     $A5
DD87: 49                           DFB     $49
DD88: 18                           DFB     $18
DD89: 69                           DFB     $69
DD8A: 01                           DFB     $01
DD8B: 85                           DFB     $85
DD8C: 49                           DFB     $49
DD8D: A5                           DFB     $A5
DD8E: 4A                           DFB     $4A
DD8F: 69                           DFB     $69
DD90: 00                           DFB     $00
DD91: 85                           DFB     $85
DD92: 4A                           DFB     $4A
DD93: D8                           DFB     $D8
DD94: 4C 31 20 48+                 ASC     ‘L1 H B’
DD9A: FC                           DFB     $FC
DD9B: A9                           DFB     $A9
DD9C: 0A                           DFB     $0A
DD9D: 20                           DFB     $20
DD9E: 1D                           DFB     $1D
DD9F: 22                           DFB     $22
DDA0: A5                           DFB     $A5
DDA1: 00                           DFB     $00
DDA2: C9                           DFB     $C9
DDA3: 03                           DFB     $03
DDA4: B0                           DFB     $B0
DDA5: 09                           DFB     $09
DDA6: 68                           DFB     $68
DDA7: A9                           DFB     $A9
DDA8: 0C                           DFB     $0C
DDA9: 20                           DFB     $20
DDAA: 1D                           DFB     $1D
DDAB: 22                           DFB     $22
DDAC: 4C                           DFB     $4C
DDAD: DE                           DFB     $DE
DDAE: 21                           DFB     $21
DDAF: A9                           DFB     $A9
DDB0: 0D                           DFB     $0D
DDB1: 20                           DFB     $20
DDB2: 1D                           DFB     $1D
DDB3: 22                           DFB     $22
DDB4: 38                           DFB     $38
DDB5: BD F8 BF E9                  ASC     “=x?i”
DDB9: 01                           DFB     $01
DDBA: 48                           DFB     $48
DDBB: BD F9 BF E9                  ASC     “=y?i”
DDBF: 00                           DFB     $00
DDC0: 48                           DFB     $48
DDC1: BD                           DFB     $BD
DDC2: FA                           DFB     $FA
DDC3: BF                           DFB     $BF
DDC4: 29                           DFB     $29
DDC5: 0F                           DFB     $0F
DDC6: E9                           DFB     $E9
DDC7: 00                           DFB     $00
DDC8: 20                           DFB     $20
DDC9: DA                           DFB     $DA
DDCA: FD                           DFB     $FD
DDCB: 68                           DFB     $68
DDCC: 20                           DFB     $20
DDCD: DA                           DFB     $DA
DDCE: FD                           DFB     $FD
DDCF: 68                           DFB     $68
DDD0: 20                           DFB     $20
DDD1: DA                           DFB     $DA
DDD2: FD                           DFB     $FD
DDD3: A9                           DFB     $A9
DDD4: 0E                           DFB     $0E
DDD5: 20                           DFB     $20
DDD6: 1D                           DFB     $1D
DDD7: 22 68 45 45+                 ASC     ‘"hEE ’
DDDC: DA                           DFB     $DA
DDDD: FD                           DFB     $FD
DDDE: A9                           DFB     $A9
DDDF: 0F                           DFB     $0F
DDE0: 20                           DFB     $20
DDE1: 1D                           DFB     $1D
DDE2: 22                           DFB     $22
DDE3: 60                           DFB     $60
DDE4: A9                           DFB     $A9
DDE5: AE                           DFB     $AE
DDE6: 20                           DFB     $20
DDE7: ED                           DFB     $ED
DDE8: FD                           DFB     $FD
DDE9: AD                           DFB     $AD
DDEA: 00                           DFB     $00
DDEB: C0                           DFB     $C0
DDEC: C9                           DFB     $C9
DDED: 9B                           DFB     $9B
DDEE: D0                           DFB     $D0
DDEF: 05                           DFB     $05
DDF0: 68                           DFB     $68
DDF1: 68                           DFB     $68
DDF2: 8D                           DFB     $8D
DDF3: 10                           DFB     $10
DDF4: C0 BD FA BF                  ASC     “@=z?”
DDF8: 29                           DFB     $29
DDF9: 0F                           DFB     $0F
DDFA: C5                           DFB     $C5
DDFB: 46                           DFB     $46
DDFC: 60                           DFB     $60
DDFD: 18                           DFB     $18
DDFE: BD                           DFB     $BD
DDFF: F9                           DFB     $F9
DE00: BF           <span id="SymLDE00">LDE00</span>           DFB     $BF
DE01: 7D                           DFB     $7D
DE02: FA                           DFB     $FA
DE03: BF                           DFB     $BF
DE04: 69                           DFB     $69
DE05: 55                           DFB     $55
DE06: 85                           DFB     $85
DE07: 47                           DFB     $47
DE08: A9                           DFB     $A9
DE09: 00                           DFB     $00
DE0A: 60                           DFB     $60
DE0B: 20                           DFB     $20
DE0C: 8E                           DFB     $8E
DE0D: FD                           DFB     $FD
DE0E: 20                           DFB     $20
DE0F: 9C                           DFB     $9C
DE10: FC                           DFB     $FC
DE11: A9                           DFB     $A9
DE12: 00                           DFB     $00
DE13: 9D                           DFB     $9D
DE14: F8                           DFB     $F8
DE15: BF                           DFB     $BF
DE16: 9D                           DFB     $9D
DE17: F9                           DFB     $F9
DE18: BF                           DFB     $BF
DE19: 9D                           DFB     $9D
DE1A: FA                           DFB     $FA
DE1B: BF                           DFB     $BF
DE1C: 60                           DFB     $60
DE1D: A8                           DFB     $A8
DE1E: B9                           DFB     $B9
DE1F: 30                           DFB     $30
DE20: 22                           DFB     $22
DE21: A8                           DFB     $A8
DE22: B9                           DFB     $B9
DE23: 41                           DFB     $41
DE24: 22                           DFB     $22
DE25: 48                           DFB     $48
DE26: 09                           DFB     $09
DE27: 80                           DFB     $80
DE28: 20                           DFB     $20
DE29: ED                           DFB     $ED
DE2A: FD                           DFB     $FD
DE2B: C8                           DFB     $C8
DE2C: 68                           DFB     $68
DE2D: 10                           DFB     $10
DE2E: F3                           DFB     $F3
DE2F: 60                           DFB     $60
DE30: 00                           DFB     $00
DE31: 05                           DFB     $05
DE32: 09                           DFB     $09
DE33: 0D                           DFB     $0D
DE34: 11                           DFB     $11
DE35: 14                           DFB     $14
DE36: 16                           DFB     $16
DE37: 18                           DFB     $18
DE38: 1B                           DFB     $1B
DE39: 47 5C 6D 77                  ASC     ‘G\mw’
DE3D: 84                           DFB     $84
DE3E: 8F                           DFB     $8F
DE3F: 92                           DFB     $92
DE40: AA                           DFB     $AA
DE41: 31 20 4D 45                  ASC     ‘1 ME’
DE45: C7                           DFB     $C7
DE46: 32                           DFB     $32
DE47: 35                           DFB     $35
DE48: 36                           DFB     $36
DE49: CB                           DFB     $CB
DE4A: 35                           DFB     $35
DE4B: 31                           DFB     $31
DE4C: 32                           DFB     $32
DE4D: CB                           DFB     $CB
DE4E: 37                           DFB     $37
DE4F: 36                           DFB     $36
DE50: 38                           DFB     $38
DE51: CB                           DFB     $CB
DE52: 31                           DFB     $31
DE53: 38                           DFB     $38
DE54: B0                           DFB     $B0
DE55: 34                           DFB     $34
DE56: B5                           DFB     $B5
DE57: 39                           DFB     $39
DE58: B0                           DFB     $B0
DE59: 31                           DFB     $31
DE5A: 33                           DFB     $33
DE5B: B5                           DFB     $B5
DE5C: 4D 45 4D 4F+                 ASC     ‘MEMORY CARD TEST’,$0D,‘ESC TO ’
                                    +      ‘EXIT’,$0D,‘TEST WILL TAKE’
DE87: A0                           DFB     $A0
DE88: 20 53 45 43+                 ASC     ‘ SECONDS’,$0D,‘CARD SIZE =’
DE9C: A0                           DFB     $A0
DE9D: 0D 0D 43 41+                 ASC     $0D,$0D,‘CARD FAILED’,$0D,$07
                                    +      $07
DEAD: 87                           DFB     $87
DEAE: 0D 0D 43 41+                 ASC     $0D,$0D,‘CARD OK’
DEB7: 8D                           DFB     $8D
DEB8: 41 44 44 52+                 ASC     ‘ADDRESS ERRO’
DEC4: D2                           DFB     $D2
DEC5: 44 41 54 41+                 ASC     ‘DATA ERROR’
DECF: A0                           DFB     $A0
DED0: 20                           DFB     $20
DED1: 2D                           DFB     $2D
DED2: A0                           DFB     $A0
DED3: 0D 53 45 45+                 ASC     $0D,‘SEE DEALER FOR SERVICE’
DEEA: 8D                           DFB     $8D
DEEB: 50 41 53 53+                 ASC     ‘PASSES =’
DEF3: A0                           DFB     $A0
DEF4: FF                           DFB     $FF
DEF5: CC                           DFB     $CC
DEF6: AA                           DFB     $AA
DEF7: 55                           DFB     $55
DEF8: 33                           DFB     $33
DEF9: 00                           DFB     $00
DEFA: 52 69 63 68+                 ASC     ‘Rich W’
DF00: 69 6C 6C 69+ <span id="SymLDF00">LDF00</span>           ASC     ‘illiamscopyright 1986 Apple Co’
                                    +      ‘mputer Inc.all rights reserved’
DF3C: 00 00 00 00+                 DS      8382,$00
FFFA: 88                           DFB     $88
FFFB: C7                           DFB     $C7
FFFC: 88                           DFB     $88
FFFD: C7                           DFB     $C7
FFFE: 8E                           DFB     $8E
FFFF: C7                           DFB     $C7
                                   ADREND  ↑ $C000
</pre>


</div>

<!-- SymbolTable is optional; remove this entire section from the template if you don't want it -->
<div id="symbol-table">
    <h2>Symbol Table</h2>
<table>
  <tr><th>Label</th><th>Value</th></tr>  <tr><td><a href="#Symmouseint">mouseint</a></td><td><code>$C100</code></td></tr>
</table>

</div>

<div id="footer">
    <hr/>
    <p>HTML generated by <a href="https://6502bench.com/">6502bench SourceGen</a> v1.8.4
    on 2023/03/08 <!--14:22:51 -06:00--></p>
    <p>Expression style: Merlin</p>
    <!-- parameters: cols=16,8,18,100;extraCols=Address,Bytes;byteSpc=True;commaBulk=True;nonuPfx=':';varPfx=']';labelBrk=False;notes=True;gfx=True;opWrap=32 -->
</div>

</body>
</html>
